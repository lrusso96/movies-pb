<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"179af4646b417384a446224c81ba7c9cbb0d1a79dd224e2bedd8b3842f9b43cb2d503c2280c5b266662ce7b222b2ba97272d9411bd9248e69d759acfd139a3ffccd156118a5fdde254ea5877e61627362e1d4e1f4f48c27d34efa1c5b68df186ee89b8fd184d820572c37ff351d5dd15891c65e98c7fe686c6dcfad0c10ac12f2178c6249ca676d4dc4ccf138cc646ac80228c6badaabf2e5a8cab313c70e4cf38413c57d43e7ffc62118803e9499cefa137ac4a3c28af357a8785d6c384fff613f5925b5dcc0486ff83d707cee38d6561d601b91cb9168312235a7ba222df1a53ba0ef68b14a03bbb4dea3735b6eea9ca469778a29d1a6589cbd00a5001edc85eef44e5223b1af150afcb52ce6bacb9c279bc9c7fc094a5e2bb2da3901b366e5bf0fb1298d71aeb3410025f660854ca4740e71eebf12eb2686b31e020495ebc49458dc9b7dcd61e5793d34738f1dd9ab1574d2e8b044324328b2c76d980b9b9057d16c932d997475e3d5460862cbd910ff0169f8fd22a5e9fe482358dae6fc6f738cb81bc00df256caf26817d9aa2cdde669921f1d83ab4ef71924244f28902cf7708bdfca035e83ea80ecaff5c897de1337a48b04d78dfa158b235ea316ea9cd628b7b893d066f03c7078a47b6c854897bd9f204025a8eebe5538033b9ce09d084d5b27b6fe48f953fd1e278029ead13878aa08295eeaa99e2874c1d74ff0c67f7b4ff885312865bb4daaae9a6376107b411a78d281dfc1d84a59fcd80f636dc65418a3df29989369436bc23da6a607459789d02e9fa1938510892bb15c8be96e5be1c35320e86ad39152156aadf1bd2efaa60eb6b24e9d76990cc86b40d1a8146074b551d48e94ed6e4bde9542473671521b8e7eafdd94670cb739cd0dda41db43732de8b14e3061199e40d2eae9bd753475a653010a113371d842ac434f76cd7e7936b3d6cf17ef90c3dfdc59b6896ec82ff55407f30be44fdf0820813d685b3e8e87530d9d57d7f8b25d0bdf3816ae294dc0c5483135c907c3cfffa4665c440f1a1ee53a3f5d2791dce74bc340aaa180ff524bb8cc746beac75caa15151576af51e48d085ea7dd6d5e3802fc51c418a8a8a71340055e636378e576c57d2e2da0968cee1d66da72c6d4390caf81ac4e234278f1e5c54445319a45138ccf99dc1d38aad0221c857703b8a7dc1c60a311c2b9426011252d561596d346a58d5f661aaa5a121bbd49126557092999bdb985444dd811451239c906dc5d3d0689ad049b9169dbfdf33659f150dc61440c6202be663cb0518402c32fe2b1a05da102bd16c38c3617f96bb1960ca19864184de4c1ae5b63e88536e7eca9ae8831cd2ba347783e08d612a3edee03dce7a9a2de6dbea8c799119ce4b7303718a6b2353845ad184fd70be970ea7614d629841e1a3f27c77a2b3e721f0d55abc007f615876506007ff5775de45b551f6e53ef124b1e8917c73892f66ac04bfde951931d7ba704ba966c1fa9ac8454be6b0288dceec9162888c676d3867fa251ff8efec4bd57e03b28bf2084b6f6c8440e8dc4d7066b1fd989cdbb0023761883cc0421baa56998193edb5282ade17b5ce1058b99f6726d5d9aa159cef14ef280481b29c6dbd63e5b583bddaaec5475dd268340e2cd8c5d1dc5eb41d08debcae4e09746f8095074c18686ca9c78bcb97aacd0ce10afd6d35975abe09b407504d0f8d70aef2fd0aada218c290540657fc4fd7e63113eea9c1e7aae666e65d8f1b0f1727ac4b2939c55cbe5041c1b9434f03ba3232e1cb15999be7dfa7cb7faa2e8eacbe47a60a6717e7f466e9b186b59aad7ba6fc2df00595b82a34a7e4b7eab7728e7866647f1c64fca303c979fab8f2c7833c0770f74f4227511d2796feb9ad965aaaf57707422a6835586153f910388dd5104122ca5866433aad893fdee0ec6dc0478adf45fd01b3fbf1af329875e57277860c2f72411544c269a1a1d0b02cf266bdf708f677ae05bf62c237fbbcffcdf1258638948fc54a0f1e4733bec351da22e07d30c1d12c6c8e21273912a8995960b92a5caa98c2ec5eac224899e97f3cb15e7766d9c94e64d58c49643093a0b9022501570d591fddffefcbcf77e8cc807fe0b2a426f117afae959e44cfbe56832374181572de849054a49933378249caafdd576c2f02f776d9c2333a599fed957346789f8a46f074fe7c7285640b3a289767b873c8f886d986f2dd1d39421f0b407d2f2be21b32400b28eeb9a1d6fb516ba1b0e781b77370e6e0515b153bd66a77bafa62d2ed46d0e360fe4614584159289e384bdc6cf955772e37e3db7acce22915ecfb50c2c87189efb9dd8f187517f600af182868e12142f97314f0f7d550ced08ac97507378acbfda3d4a28b15739e5a8d29b81dbcba7a29d196ad3d16b9c9b3bf3bc4d56d7825ec4cec5dc23aa7b03c01e638f51bcc710952aff06813744464a11b89f05436ecafb0c4c48255784b1a1049b43d2f5a15762e5331cc138c6dc77038995127982f2667a75f550ce3b965600e815d5b85ee2ae44bab27fdc69e81e6f03ec80023caf4f48a2eb97c24f34b480318cc121dcd755598da5646055082d765a9ffc996c8fdae631c6f4f6a0244a1d65587b4ddadf96b6ce6e05089a5b2c83ee8f2cd1f8fa67a5ae92ffef38f91ad64780407e636f66fea25c2fdf2f7dfcf2e945ed2cb3f2fef2092b02511e9fd5aaf0ab0f7ca5905064773b87bc7659de9e738cbf12f9784ef355e6c1eedc3c6d555f3c3b6737acbca531a44d4bd3d96e4fa0fec751d6a25c7d0e479154f87e495720b0dfdb518d456e77766096843a755c6d53a4f854feefbf96a24bbb19cb0288b06f3e6d8cdb758b610e74a81b14ee0acca481f9de6bcece013a687bf4959b34ccddd2ab246a538cb619ec89ceb4f9298ac14d0be31fd311f9f1da60ec214a399afb177c0c8f5543c323120953fc5cdaa7c16d6c6c700701a128198e0e6203163733beb4b928e6061084a7449e3c7f65055126274715ea02aa9bd744cb2a559f4b41a28abc7b88ca18f00511ab4c75386da9a6945829d902cbb130221ccfaaacdbb2271a24e936c62aecae2c0c5ba90773fd650338f15febf501e8264559f5ccd0c8cf7993b9d1de0636c5949aee7fa295580bbef614b10d81234a188fb203db2ffcaf52f1aaaaf66989f253fb3966be6e76fb1c5f9bcb37c704d045ca0e08b37094e21b25dc1f1a05f4cf4d43db33b1641f1c7b7296ab3b28de5b50896a6472a6f3cf50af3fa4d94b98310ee345b0c9a538a16190b95db4cbada952e07ede788343ebfc58f04aaa0b5cb70e67d77e5c373eed26ba77b8f525b9157a7ce93c06090c4970f442e77318ec84346e3de2d9709ec736fa1523f1b4c0ecf86f8fa4c315a5d2b397efa9f2d912c279693b5049c880059491d4e7d2c87bdc5333131092d15aeccd6928e008d3bdf6310c781b50eaa4fb834499495c40422d6e2ea6b8fbeef2d2fc83e2f60839cd0f8e1e8313871410820758449413de9052556e61f8793119bf5bdf82d7749ffe0de3e2ece896dbe67e2e870085f70ee40110aeefaa7a0ec6eb8b970397cc35dac5f61a82872783cd13317ac0f8a328f416ef1719d016daeb14a4d818cd073a56d5b699bf7b4154f49529757952186ecdb09e0c3174e250db9a982f10778648d7584d43a0c185f4c05ec69aee87addf652c3d0bd6f2cebd7a6e38fc400ee33387bb64b07952b67ab6dd9a2129ad53d967792fe28a1d39a830e66564fd9a96efe05e2a593d83ab9ad3fc2b4806950e491e0b37bc95b8026a75b338c5b6ef68f4dcd2c81b42ba64665d8cbb73627049acc5561d0b92c62be2049510a01c7ee6a7e76f5b8f02d5992cd0bbbe8e91850ef39f1cec7b6a5fee501151ffd37dd26441837017f9320c2750fef55f253b0ff34dd7ebfbbeea1d3a807b3a7b1a2a928d0b6284795b8074055520aae92ba1f9d9d3fc614164b519ca6d5117970d239b3d4587bc06b4e3c13c87c21a390a0f5f9f47d5a916476f5f9fe38aab16933d20a6c314360b8a1d08d70d8e934ed92fe20482d7c6f424ca0a0ccc2cd0284bf695cfaa5ea06ff9c8fd5ac44cadee6fd02c5a90ba44ed9fc6eb5c39ac3b3a43843a2c09dc04c32bd11548889a556a9fcbb9a9c19982d392b64b4195eccb514a7d3cb1d177b991dd6b0beb52ff7fba1675425f44ff069f763730dbbff3d88bb3281a4f9c34fad92a78870fa820107bb557d52ac64f38a759729784bf20dde6846084bf1ba906860f4226c260eafd0c1435cbd503a688d645f75a66de5a89950bb6bd4a1bbc53f7546a8dbc80794eaa5a2302c6c7dbfecb0c79c1e7b1149ad1bdc650732d696a6698daebeef185a7c35ffb641815ab4be9ecd2e34f15038caaea1c6929b03e0c6bdf8a92ab21e8a99210a085333d82b1a112bdf1119662a114f2d5838c403f54fc3816ec0d220db1ddc7f4282289f06766f801a6c34a4895caa2e36590f55ce92302a73967ba44bb0dd6bf225330e4330f29a4035ba7d98e348f44141aa88028c87cdb1f0d165b5414e09879cdceb3d65c56b24d9baee1cd7ed22bee60e1c670b3a74f06fcbca6e9cf5e6f43ebd77ce1f98b0b82c16997f4f4c5ee4f2a6db939cd37d33661f42b159e1a3a14ab3151ad93095d008678760e26718f15811c2a62641406ae25e1327233e7c127f440d9621845d315c9b24faebbfa95a81595245bfca3546793526455a0d85affd81832fc9303bffe012d1b7b9ea60be59358364028a06ed2309dca28083075b1cc28dc5efb1d64924cfc08e953142cb48f34641d831b88aabd0444ea7fb6f26decb0e440803f8ae1a6326199113521b3550072c38fbaf64fd523e3c4965167a3b1d4aca0f8450dbc027b4a3fcdea39b3a545e8e56ddd94715856276285e5ac58e979ab14aec22142d8d399e4bfcc75fc26583a0f05f83d54117435144479469020168109a573801ad7271b45c24def5af8920b72a31a04985902e8ddfc2e8d11a4464c982192637225dbcd28d614c2c29f5ce77e80008361894d39be887e6743d5655a26ae11cc802feb38d681a11ace6733638873031c7dc2ca1fa3057fabe66c1a72b4294d666cf5b68d363c36650a1acb43f81bf7781d915c6c1895bcab15a51cfd4774947c26457bd931f8037d5e0cfb1d63e3268141aa1b76c8709c7dc22049bf3d5f88954ca12a56aa872d4dc774cfe6ac8d20ada6473e3efff5f00f2a36236ef83dde2b1375220afd8fae6b194a516a1cf3a2391a48bc7abb24f6a20bbc43ae1e1718ce560de8ba779099b4435dce55660c3ca2a6dac3abcb464e678d68a71183d9534066681d293fc1865c23a33ee1eea99e21842ed4f8dc381b8e183870795658a15d28763c4be2ffad10f0865207409014d87227c76f5f660230d2af7a889072d524f47812dfe8bef939dd71f8f1850ae229e907c573a3ecb2d458fb737805dd9aba2b566e26afe88174e572fe9f5fa50a792327c4ac85761cff15cd6c038c14e2c3757dc6f095cb4cc8f88c977a8a93c172239e66591e29de14a671eca399e0d0da149904559b59c5d7ba7b12cd12599075b3916c6f9f1a61a4645326eb10f979ee2b9082dae030f9cddf5f1df9e6099b7fb3b9356fd0420d932290c4ef5f1b548f7c183b3cc9bd3bc816a3d0ae7f40e8280524cb2476cb474a0b92b171be3a2b20ed432c90738b89b3dc0537361333281d4bd59dfcf1415499381dd9354f352c1fbf1b98f1f69b8031bae7f95edb28e759f6395b31d7e95f72c55e706f385717561a5a723fed5da0400b484ed6ce617466a93421f0186d7bf500fb37a8e156852b972ede8673441aaecb7948d4860bc017589f37b19ef4f3a6882d2bcdb66e5dc313ddd631d2c47dd5d5af0de4aa830d2f39b11a95e89dd1cab61b10c786e498fc05a27aec83ee52657863b29b3362f18913b1fec74dcad5490339884043a1a4f6532c2c46d34f4048190de1bb55ee8c6770d4783c8a3275a869f15863b1432f6b4cf1ed80d4dc9dd2f97146f05f5e4f30d6fa10e0f579b74e787e12bc4ef8d6774cd68e693e440b289c90ac4aa8d15c32c615ece76dd0a9097a3ceb02380fff9dd7205cc53b8d32c01304cf1bf0091d9b84ed8cebcd00aa55a629dfac950726863cd019d33be262260d0dfb5cad5012193ed2dbf6084f59308297c5d753dd3c10b0e8dd585e97ff222dbe675501ab9740d44ad3644a1167384910b6e1cbd9624b62d0e0ca44959679c521c0dfcb8dcba9d5817b116cfac0a8910c0dbd4a999f076f7d4fcbf848a23c20a289fb25e6642fa29333b9dbf590f512c1378f847ba9f0049b6cae01c1b6aa129c0752a9adf868c353d9382cfee504faa693ef6fa80eac219f3898b19f059b36738d8e538ab69b6f813120acdd1c2e57b2460497fef1c3286e7ce6b02b83359154483031a7daf85dde2b007ec95d49db39bd220369f9ac4c6cd4a4a93c5426db87aade850f0f1b82a5f9f941ba5689ebfb3769a41d4f16eda9a8a3bf92c783f3667d02a63605b137f48a1b177884e4c52a4f579303eff6173c3a7b926055d39dfd10bb3fe0d39869638ded82c7a90b5df9008a513394271e8923a23833abac5a3389a38cb5c98edcc8a824522e394a3b930ea2f5b6192087670a719e9c4d66138196bc0ac6497c801dfbfe0735fa9b8e5ab1e6adc1d0afcac3d2dc2e958a60b576b91909e3f96b0519ff3f3b41476c59410abb1ef53b0a4729a36af05e51b56fd0ffef94e1070b8d2559c1d7e8fcea25d332af2721bd4f208fb1293886912710e4afffdbcbfc5389c56b4bc52429a45bf67bac00e619f231f179d10b74cecc8a42803e18ce3699f877d6cf4b75f66bfc004c9c1621d82ad4e014fbb420766a81830b92ce898ef0385aaffd52ce40e2dcca1d1b45a8e04216e43b5b2b3cb67a7898de11853a94c26b95b9d74f5ec4de307d6b5b2ec9968c1ef3fc9fff4a0573f65a46a928d062858968f5ca34ab11de92f735b501295aed5346c535dfa3a531cc74c58b4f663af2fdd13530c5c8470073511d309b54f8260005b95418fa64bc785efadea14cf051a1bc409003b2d9df9cdbf2e7cce19c38090f3fda83645bfbe3ce70d9572150c2adbc6b40282e3490c461b6bb57fd870a3289c6cebbec0eb0da1f5400b6c06440df60837489c34b5bfd77553a9be8f4d2ffb872878f35efae4aefcd2c07573b0e361383566a984fbbbb93d98f9b71504be7eac17b1ebfb2af95ebae81dbcd74d808587882df84a3c5066a88ac985fe2069b34635509ddf17d9f9e1d22648c87fdfeb8f1d38cd2540a7fe84abe6d5dc375c4fa34d9e60af7218b47725fb1c8f967f514fe39f575a60aef92700bfa1dd115cea4b329cceb8d6571d301d852f5ffddc74435861b43af560c5fa2f3013b991671a9a5ae00fea079f4cdc3d2849f1aa875ebc32e466b103c27e78818ee1fd616cd765c6f97e48330327d9696d775f651e9ef1f79d8ea23f0998a9732fe87cc62c4df2594a2651bca89c40701cf5695ad8c84c01303c921b18a50f6f40e8beebf30c76520dd8ed81c8a0bb34e4802b8809ad37a6f1f53d61cc9e102b87791c75f9585edf88bd852210c53e294778316bb367e6765d4e8418b5ee278146f993b509808a7d42f670fc39482ce3d778258293fffabf757813b35038a87cd94dd14aaefde4019839a0fa071077fdf8ba6a0f67a3abe07972bacd38a0e7efc44febd30ed31b7d061f272cf15b9737e0712740019eb5d7713bf923d605243c8082beb3dadd9bff5ded161536a84381a3d866c459764c3136aba5aa2a4c3e7fe6bd45bc61271b765a449cb1fe5d57b81bcf02b14c6b9e19342a40b1f322f65f81f9d3628a50bd54a1566a23d3c57ecb092d4cdce6563826e799eaab919d472c2e73221dba3ac54bd4236ec97399fb0fb25d29f6d63193cdd7d3ac58f24d45b7c504cb17aecba6d4c815ff6a50c1cbd087875d1a51b126eca45636fb1dcb1f52dceca20e6a83d4f9c84c95db755f97c1c8f173de22e7fd110ac8ab649ffe0c9f9d62756486c666d7f6ab1de181b87359df98a40d1d912d82cf458da143429fb2dd325e8ae209cc1954f3e0f077e2b3e2d788375a38402ad730aa1b92a4f892745ed1b35d3863c8333c925404799fea30b7ba28696b9e529072a093990c7d95eb4bc3aa8c754e622ccd55809218f68776f19cd6a7535281fcc93763043a097725716dca907ca039b4ee15a9c844b61138c2139472d16e36ac78193eff5f5963e1f6ecb6317010494d0ec5847f51cf09287c8f41acf2af30664fa0296286d294cf6fd3e2fd6e519ba67048f3dc2eeb2335959e8672c1828ee72e5c69fa27c46d71424738f434fa4f6a5fd8c578dae6b960992c51ecff4787a0a9f328721d3c81ad6a8f27a2d2b13be76bd210470728e7bb9701ba55480833b4203410d4d39ebe7848226445eca24b8968c433b4d12e8adf2d24cae03e7176878d03a4daf257d42dbcae1be2d91026bd4dedf4b525713cc60f3b7953f424575d13a2b87839b4f79fa9def463adda7b3ac4c7416c9158d68bd941f2cb728fe5896625cdb2b5df52a7d7bfa3bdf9784c62355b7e9c1545b69386340ba0d6ccf33ce966cdcf3782bc0fc370b2bced27bc13c0c49dfc3955ab1ead3379e136580d670e9c41203223b650a12776af9f97c6c14bed6ff0ca88951bb5228a100e1b248d6c9255e5ed1de337aa3d370eb3c0df69e4aa91e8968827896f162dc7c6476dfaa99dc16335ed9b29c7d0478258ea97d4ac3d65299e79ebbeb598a77c3c2703c4d0938f6ac2ca97b3f701c6f5e6e4a43c21d37d97a7973717bdcc77aecfa2bd0576a61b99d361fb39dc589ed02b4c7b6a0b37187cef3b68ee76e9fac1127cb4912ab87404fcdb290ae7f431ed526761bc74061bbe477f3c3ccb0b09db53e9c9f6ca06d028416b7ef8bdbf9eebaa7ea5f9903ff6180beeacdd0ba688260eca88969cff8736e9afe848b5fd92716d38135442448aa37a87cf18f5c5f974cbf9d7e4ec8b727753bfe4adfe9b6ccf70a8bc6726e417a5929766c5dd91ac8cbf5802ab348ff3bd56106e41929a945d35fbbdc4812c2117c2047baf14a39047504bbebe3ffb9e3e107bc4bf0b9aabb9de565584867cc6e672d829e6135c37d99222795d289f143cb09d3602abe8dd1e7efcfa211ce5a70d5bc61961da189b2ced4bfdc1cacaf3ec6fe08333cd2566be9271977b07f939aca8386aef106ed0f58f2890634b80a3e1853eeffb1912f8580d95cf88a68a1bec9341aae19bb351926eb12c0ca8ff32cd84a06d34940e1982027caea5ec73198c1355b123917e49f355b306e0cc3401334845f81155a8fd8f39037a6eb34243e792534c0f3bd7766bbd523cb6e07f9cdd4c9e92d35cef1c2be38f7e6bf93aabb71d850134857aebfb7294a909282d2c4d96de53c1f049266b2fc84232f2f641222ec46167b244fd8c3ba25f4a7561ad1078d6eff4378640f201a073b3bf44f69914df8b2d8d5526ea5db377fa81085936569108eca765d058f75973a6626e3da6e9b061bbfe2d9116913df33f6220af139e51728f6d3441a126290ac2c510ac2215361e5d69bdfd1abfb9b7c05a78b8b251c04538afc3b0d214b057a093f7d7735361d18de58d79ab873a4971b2c2de6185abdbc69fc60a689e4267d9717a69cae48bf17365f2fe745a2312a749ca5b3ca3bde59bcb82305552b1308e09627dbae64587c859968ce957a4e5f7cfecd58eb091a4315be7fbcf1af72bfa30d3644391b2d74df35a9d4ffca95f53614678427f9c8c25e63823b4e873c1ebf15f5a3fa773ff23207e9b8040a502703b30acc5e316c1a4fc389a515252aee1a79c93d4e59fdbf9e71c28d6690e7247f0e1bfe7654a8159b2555df69e06df9731068598b26673897f2e7bfdf24e6609fb3195d6b6e0cb8e098d5116e8279d74c03f4b6c4f1af5d3aae4b70fc70ca53e75967e5ce8a9000537d9a598f7bff9d90db84dcc7a38b53de1ea25725baaebfdd4b77682bf03400dacf7a12f912a04d2f19458e5150779e31477459133dd0c10385cb429b6ae1ab065a8957859d8edd333b7e83f4df3d38edf9f0ca677f9824be353df65ff3ba7dcedf5e8671c0c3a8ffee446144b5eba129d8d6210d9ac424f322770a03ba2ba32a892ee37c3000aba7815a24696fe4438917103b5019d37339dfc13cb8858db6d997a69ae5c6685e3bd63b28b9909f3fa83a2d2011eaf75b355d32d907d54aec32236485513b7409b9ff23751d76812a661a3e2812260a1e5eb1eafb2234c27d62281e35dc68dd54673f4f7506754d92bf8dbf644b05d7cfae69a9646686a527c005d1bb952b5d0e118a193e77753ad8e0dc5628b79838eae0a06b1b7e7f25577d85a16b92a6096a6d8df4b21ab50ec6e3d6ed912a4c2148a90ff3422199e2a57f1fc7cf70aaa03a568a1d1e02668fadc3a10084390891591e20881c6375f0eb6499629fd1ff9b0b64feffcb2c9ba2157e4c7e884cb6d29d548d3809fe34b7e56ffff28bfb17611ae6a20bd3b7ed9982b6d522b383f1068a643ec5520fa95ac4fe61d1bb53220cf0bff4f013fb1a2787066c387858a85333c9a68d58d3e35f609645fe1177fda22edc67986df3640bb13984d95854f43752ae0c336dae780b5b41224596be32f2d219d24f3fd5d85aac0096594cfb232069ac253a58bf3f7a9d9cdeaadce27e655cac3c201f5518f6d0085ea9a3488969f306889b25acf4f90d7047bcddb5bcaa00a9ab3a0b19d17afa95062330ca3dcfe3c1cc20c155075e6ca92bafe20a34dfbb09a0c826f0f1dab61517a58e0926093e86c35b4cb3f235f15fd96b55d33e0ac21a94ada5b809db298300f0a158b1d751b0c006f82d70b9dcee3633607c19aafd398d961693de7ad3d1e0defdbb50fe99ae4c259a85831f00e3b3e1c6ab6fa64acbbe697c1653c2cd52ec71eed5111a744410807051982252bfb763d1a2e05df8f2340e46e1da033ec68edf0050fc470cbdc8fabd1bb6f2a29cc7cf9a49efce6064bb441055b40a4accc2290d2bd85a1f5ee6d1ded1ecb1579906c58120e637c51b9a9085886635d6ac8e2e1cd654654473325f9eff065044c6cef439c7ac4559a01d07dc53089360937d87769424b2bba46ffd2da525de406d30338cb7a114758e482c355c4e4f4e3452f2eb95e11c11d8c3ec3802e4bef699baa5cf8e6984afc677ce89a8f5f2902e8298bb3655c4fa036ce10029c93afd9d4ca101c229f76f2cc39e8648339b16d17970976714e6d4f50b86e140d1def1b7e4fc81c3d8c686bd663cff2c5e7710caef1a02ee965581049d10b44925bc7e46c4db36ff4676ed65fc8032aebac6db86375d0fa01df256cff033dbeae282f6bcae110bd91a49b69e357da3992fc8d87f6b2b5239bcf122205f5ecced41e6c4b288aefad2948d72e403630e088722e1bb0d1e137c01f56a2240f8d8bf46cff444f5ba18aab3e5acb1159772bec044b0f1811f5304d4fc140be5fcd8840383ff8233f29371c38ac49807a23d9bb506d95daddfff208ab32d07c6a8ad76a42c830f2c6798bbc7911d8c672c623718160e3f8350e2b1f7f8c2087e8cc414c6955775453634158866cd1ee0d7765611e9232b0b71222c67bcd2e39baa21f53648c15e1b36508c3b989845f32846180694704e287f2c341ee1e9d3a4fef8f65d3449512b58ec12ca8b7f76494866abd4b235a7e5b05781e6d98473a4d445d3182af82269f2f4a3aec0d531cfc2d16402f0a9855721d9ac252738bbafee392b43c9f4f3cf4ba531c744a774721d5b5a67de700c2f2a7a08b43dcaaaeae33da4dee15578ac41fc6596437bed37b61ca2f1278d340cb7cdf6dd83edac025b09148e489d2164702a9ae7f4140f089282b616913cdd5944e122ee8ce921e8ff16bbb3b236e27fed60df7610a9f6d7e7ad7e87cd45f26db7c842680547ba2025246d156283b4c37df60f08a6ba0580ba38ae08ba1ba1b00d93fc4cae22428c08405f757f304caa9389340f8f923b1a296c83e3d3f97904ad6f832e42c7a7fc2a445b2b605d369f153e67b1680518bbc6908566c415e93563881c2410cbc322762a5f6f7199fdce52bdc81be871431f2f76870ef439a914d3f6c5636ff118a2ec6175e43efa59e242041605660bf1d4cfd7c37483a02cf0e89e9946ff20c0b065b702288e2ec56c47781e7efddb65e214fad4da7c03569d136a5db86ef8c7df38a6821b82b27016a4515640130994f9cb92f7ae7468d1bc09109224d2a76b842b435730411f53442583dd7c12212c3455f4675e1d815e2a2f58b17258a63357d54de64436d6fa8f8db6e36d1e843d45bbc6ff14209e94dfd7bf0675e19886e7bc3d6574c805c377f9d6141d5baa55218163af2c3d2251ea40dac6e0eb2ca9d2ba3c2859a16fd9d5f22e775010cc8d89626ad8327439358b8f069672ee4763cc81ff02f89b203216987d69565857b9d06865e3cd28f13576612a1d512908d7c4007a334b4b870036fe586652eaa69d3b2a0a7340927ab58a64b82367bf31102f1a9fa98da862e07510a408e115e4aa01bf85b9b6132c878b81d6ec66ed330981e3364ed0a9e785243bb65a7fdcc2dccb94e534a50aac6e4c8c6f556a8f8129fc610eb015ad0e8d3a8b8ae2a2d04cc8f060b81c7c419dc63d4dc5a606dd8af5c0e8632c2fc62d732e72b9faec3ca2fac3b011faad3eff661cd7970738ac55ca1fe3dcc1f10d3e23094fa7eb52640e6e7336ed43af0501e0466c598265485c7ace09794175f5fe41dee56c1f9b9d2e0c447f21b61cb3a0c6f256e5ebf7c27749a38b31958c3ac4615fe42540589e94f773b32e4aab1f4d4f3cc7f51ff26a4c1315569c816234095d3e609845c782b12a8c42d5a7d3736a2ed76ac3fa8e99ea74128ef4964c8b1b2c1d16b84d3c96c6819497eb44965fb812ae91c5019efba88d469ffb974b70394a8772f191ad97a3cdcb153d249a372eae371531b63547d75607e55c171ac20549d5839f137c7b3d0bbdafdb63ed191626663ebdc70208f1c5e834a06e5f34c3b7fee191ef0fa300025dbba725a901209147c1a2ee3775024395d1b80777af22e436955ae2005daccfb4add84acb06106848b4bcb8d6663cf189e49c30e8791bf1d5de526a1fcee4549d7076768900e12ac88fb4f173aee6e4fb84dd294fff2edfc7b4f6eb1605675998ac32cfeea1a53eef7ac1d26ef613dbc613376fc450ac5c97c8a1a1f89c0f272f377f0839366bb520ec40211a91210ff5d835001499f4fab6d86068f0ad1ea167193eead0960a2489bccb234d06bcfb485fd43bd0878d509c8fac4c43587b3df360ef44cf68f6493c76887de249ab9b0c9444200d3b9f3411a3fce7975be4f8c086de27e27683d3da9b347887727b5dbc4f136ce38185f4f1817a90497ba13edf192ae65b322a021f7107ab18bde02df1c59c4771975f36d7c8626925cf516896e4abb832ae1d0eaf9df64f4b7b93621e8868b946f0fd3327d40b99d1e513c719badb5c9df3357224b3f844630e05e372c9a7bb274c148f1d7236af4c6020990d432e5b892b6ce9d4048a14698b16fdceef5993c8b4546232fd55b8a1192a53a9689d07a430facfcba7bae3442ac548a526a6d32fa93ac1347b5c7a803a0087e01085c29130e0a38982377cd4ed1f0102f305e3fd4d9f61b548e0a671dbd88562c3b0427a5c70120332b453d6f844645ebe42064e8e4d69d42ca8491a7309ff04ba103903a2aabf1c01ecf9ff872e6122711f265f79992e0d4223afb444ae148c38463be25518052dbce7d31d244e5a2974e757e666449cec7c0cde2a01be382f6f37c9ca53fd80b60051f387cb6cccf990275f2d49d2ba510373d6447a55db5685a401867bfd861112160a6f63c084c284e6fe46d55ec2434846a59d1c6590c5d4695145518d9dd6025add85dd852fe96ffa0cb1bb79a6cdeaca2f31f8276c252138c723470dc1c738cde7d160f954a7d18859e7b62ae870485d089cde876a812a7eecdc71e8d957a59c57eabe0822285c8600bd5bf595db6ddb613139c8ec5ad9153172c7d5fa6effd9ee0204ca39d8839faa197af70cd6543c4f44f3cd09479ad6239193065ed84e9b5289f9b36122031bbab757ae4e4593d0a5a4a18813e2388b19ceeb0620d82c4dc814aa2ad37ea3cb3f78d52fd3c5a74d54bd8bf5e4eda007bb042801ae71d80d51237f5c49a1402bc73d07621679cb74564c8b34962be323c72c932b8d1e6e5fad599cf4428715cf34b97b65cee36fc9d9ef1be1ddac386c4eadec6894998398af434eadd15700af478e2bbf2b3d6258e88856ecc95c618d94895fe3bcaf7e539809ad741f38f7e11f748be599cbccc3538041df1e0b2671076f6e4a2730f3b0acfb0cfdd72fe279689086a3ee2de0d17e71b3745f5525df2e36afda5d8a6d3fd4b04a3351154bd7c31a4f05c332c16796b692556e8b64def03cc6485c27a90618ad46de0d40675f18d706cb3d763c8b89ed630ba7c3af4345266fe5c168b0408351ed52061d2a25cc253ae2b07e0431cc7a655efa20e814d3381370df262c7311af97441f806fcb6e394fdbbb92912296a4ca5722fae7186e90a3f84206102f8c2d7f3e6d17752fa14918d2ac5248dd9036e3017a8c9c0c7e8cb01532618f2c7d6113c8c34aabc244859031af0ed629e8db0dae75f31bef8f8752f11bb3cffc6bc37cab8d59f609947f783ede44212438282f5bd8d3627f74b12f2658961164410563685c94a3b76323dc070d41cb6ba9f3d67f1532499f63d39e578c823353b1dea86fd8f328a883a82e40bb41386ca5790306e03293fcf9954cec2472b29560aef6ad4d2902c4116f61e5efb154682b0abd35b845da05b61373e662a784ff6515a70aae7e59cc58a0aa62e5a01987e7d0ec5393b8c489e59fd6afe88bfb8cc543f3e27b93795e7e28fb2e9b31f72d05343617b4bbc44d26082cf4b8203aff6a20f67b550da46e91a50fdd135bbaca0152fa2788b3841c38f2a6d67d308d66af1a0e2fc654549d34992f5af5ac505b243ca22369867b331e944335ee1e26c914ab14fb7bd352a9521ca450977bd1597fc615378bcb5ff18d43783c28e4aaa96facb7ff198e1d84d1e5e0b78b1f207dfd6acf4ee6db9fd0626daa579a117e3937ec3185373bf396655825f395c5db4357987fd26a624053e485272e88e51c40521147dca26f6eb39e7ab8dc94d8baac8de7c74de0af9b3575bde4d57cdbf5eb23fda6c292b7b179e3f6b1b720ecaf9b5b7b814f903f427b8de54d811a2d3c77737cdb050470cf31212e4141d171b5516ff6d42724808ba2fa281e59927dea9799a247a07e86a1959083759ea4825b2c735baf1085d98a88f2d1902ae868aa85d0dd3980f546fd755d21069d2448a98b6a2ce8b9eac4165448242e8bf189991e34039c76853427963e390a715de5838c502a5f9b347d7050b396ffe9986e22b036bb2ae3113eda0661eb6b9bb7ca83b6724b8fc8ea191aba78ec06c55692d71ecefab64a890f3f3a5a455ab2a75fbb9cf8098df2b5db3118e9238c1294d0829870c681a4ca0acdb007401c67595668f2a7af99f57e0d27d3ceaa89b6ab9b78552442885dc2c0d512f9fac7fcecc9d45107ef1771f4f655564b5111ba66e51091989d199b5f867641769adf61b46f1b1417356c8","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"ab2beec4f19cdcf7b5c909265e03bcab"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
