<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"86ca12d7cf1fa5dd2cfe1147bd876defcc4f3f6d9dc140cd3dc4adc15ed95a82c869803b48d36b6ca157e949c8e433338097682f826c114eae40a5017e12adbf929ef1d99669a8db294cb2f09e41fa3c001821a3963d023b7c9d57678b9ff7073b2c73376f77824da28f7829c1543345e423fc5d5cce113b680e69caf69b3374b77fad9df0ce090bb40a440fc164fd4a38db650327d9075768037fe2cf72e772a4b6e9ae760cb42178d7eb644cb131bf29acf311cce3c52308404cdb3e20548e3313ca22cf84ec7c32b6791d41b655a80c83a4097a8380681584da298c79a29b2c6facefc5dbeddd10fff1f76579ffb13c50b2dcda98af672fe81a0b755498c2e4228e60fcca6abd6ee157bdfac32e52c054c34478d42fb841f7c9e060913e408dd37ae1f5fc3628c61759f9ad3c5dc426b1b686779850fe902f4efc9430e5e8dc7afc66817a10a66a59cac39b45cbf14cb47a5f14e6aa55b2048955e73b08315f991a3f48818e68a666263a4eedd80be241b6764388544ad587381ea301524a562ee3d706f5a4498b1c87ed0f6bec7fa8e6bdfb11cfd42cdefb7daf75dc52a34a6fa14c0b01184b41abe2ed4956a136c5a752264f01353ceb2fedf81f93fa8bdd4de4ae661223085929e19caf91ac7f182ab56f78d1922fb422c856c5df82328103132d8570acc96c4263b1af97c196f2bf93a52e2cd3d0c84d0b8e3800be1fc7fbe7a54ee450c8189ed4696052f47e7ea5436a4eb24ccdc17dbe80800665f6f65d7525bf610030ee19806c7be1c831a49d8cb3c0b8e2e6b650af8d46df29ffe747ef83bc1cd42c773c1647273596c3b63be12608eeb3a855d4675d11509d884af0f04fc9d87ca238bbc630f02834465c8e87680ff92fbb037745036fc1f26719fc87be8528e36e75dbc809a6818bdc7c432ca06f470c48c3b93c0bf536e668f062dae554a84a81da26ed816f31f5cb4257500e84fcba1d681c76a8a9cd4f10a9dfbc1518a57e016ad1b9aabd7fae3e1a90099829bfafc7bf0848cf5cc2893c9bc716c6afd4180b0c572e9a9ed4268d7b564ce6033d4d0e128ef6dce38b01ea3e30a2e95e8503868c2dd0d7144bae0964e07b36e4a1d01e58f727eff9ac40be072ac1534eb3f76d367c309dd6d8e6bf0cf9f78c560d5491c58e563e0cfbf7f5db785dba54a773726be19aa4bf5749fabd73b5a32e1a32919c0d95b689f29027d37214808fc4af963a71639c6a87eb14c7ae83a314c1e5ec5c66bbdbb1636e7f61b06a17cd8a996410f643539cbd49d981131518d1973678b3ed528c4508c074400048010ab9486d6c6da7fe712f505a8732eb4903c5a8a26c6cfe26e22912e0957befd6d6acc3f76773e30a2bc5fadac6f24b12bdc0afe9833fd9f82901ba04ae4eb61d79722395b7bb735fbaf259439a98d0730532702e2f3cb7538a0f1467ea10a0eb1965cfac257ef01a8ae9d4944ad98cb1b0efcd77f913182c445e5006f2989db0e38e924a641c5e642146f6d6e8fd7c844334dcac4e426ef99db33457b9fe43e484d2ea565f5ee8950ad091b0abed6e8335b4b4b83cdb8b926fec76b0ac06fc78030569649fa94d7162655d6a0693d96a0c351d55033d0c72117d44a5fbcc37e92fb15b25361963a287de945628a7fb421fc58221a10d1bfc2acccbda2f8bbf3aab94ca4f33d9b4cc3d70c7ffbe5238f67773718b372564278ae64d09afc93b5fe9277e762f585d17396caa191e4421878292303d311de89473e54a1375c4dee731c1e069cb8d37a53ac2ffe3650b14404b870ad19b14b48a58953d37cc442e983ff869de8d3ed992c0df7100e32a86145c0a5d76439e0a35bdd9ed80bac358ac8d9edd236821be65a82523f2cde9b146f6087b0af962bbba596d1fa3041cb1d54f91896722190c1ecf401e85f0b51a2385e7baa6929b7e3bacd647effcce0aae5c4fbd1cacebed253c0ed3251125cc354544d4da979ea8d99f319334f2ccf70535a0c55c5a8b63398f5d5ae620c66b921c3354b4adca453113940d0c5cfb24bc8b6b745d9c723d40a6ee9a19fda540638e3248611eee9d845cd2a11e75758634ed8b66177bf05233f9f247eae304dbedf5adcee33f9fce3e325fb4959c79d1be51420a1e91e29a2a2aa32cbf74aebb0f3e2069b115dcb2542dc4523373c371a75e412dd8385aa8e7549db146207e512d2927d99d0866b7e4a3c8b170b5f451f9f770dedcdfb3f83ebb34f98530f82a0aa67133166e18cf7618e2f3a79817894e806e5635bb6953054a3bab70673b82157f4078123e1e86379ea7c8ddd1b59ca694059f469147828569ee84d814d7344b2332b72ef8fd21b71b0ba6db34adc641269dd72a09958ce8dcd812115d1f1ce423092a88b11158c32395f8a72c658fdeb217d1fe7037c88b7ee08a16b3907afc16a19508c1f734599cf612e99e65882ce71d6a76bf576610f4ff6a8a7e55df485863154cc24ba4118b6e1fe4fac85a8b8613ffdb009170cff49510747bcffd21bd775600762bc60de14eaa58a050cf4c4232b5af7e8082a733cbc87a25d94c20d6220d6f9473afe7cd23131c01c2308d0637139fb6046ab8a4e78930f59bbab39e31ea6482928f69c2ec54cb1bfeb49ccfbfcaab88c99807fbf352b656fc78f919a739436ae52c945af01b8bfa779edbb5256e9ca5ad824098b1c2e158c31ab7126988818f582ce094ab47d932c1e8f4c4f46d7c3b2435fbdb5a9e4b7126344a151c4b8c98782bdd45287222d3ca6401b294611ce377fc4d65c76e1ab39a9b9d9a6dadaf0b35f500f798ad1395c8fe69248449796d74a4d6514d22498f23b5b9f028f0535c4142f5984159843bf359d76c7e20aa7ebe14fbcf5bb2bd139176d2513b1af8f328bbb3e1d132e0deff173de9e1c698e833db7b96828caab339fe4dc1d8724b83573b1c2fcf05a10dbfa22a024f9e16e4dbc8453a01fcfb9438ef52ab0a9708965966357b0249c1736cccc0e8516538e1df4ec9f1306ede162a90aff38e3ef9f2ec3899afebec1d215dfa707b6a2b780fb34891404fd68ba6ea18581b3fe6aff400d049a03c75841c049ffbea30cee17b05bea9e846f5f90e2581d24ebc33599b6c0032eee9ee8803fcdd0ca43804781b349cbf4519c4bd70951f72b1031a825065257e1450e191ce1bedb1853f557374984373fbef82583efa74eef2a071441f8898b6a9afb8ecddcd9397dc2896d1cc99a4d1f8fa7bff9554e20d6b3774e1cd72cb109993a87186eb34702641b21e4e0a1e73059565eb4c32266382d95043e1d6e8b3e1e759c5154ce57989edf89ebe7703e50c885255ade2b937e1c6de7d7dfc7a6f6162e5020e3fb66960bd2adcd77a4a139c8ee331950ca2b705680e3731cc6e5589ff67b596a87b5d394d9345e0ce5be3f1b9c7741aca6a80f20564200ba12ecb6689f76299c5d866b4a8485e50551cec7313cbe634ee093fda8c5602edfe96f1c52ef3e3494d3fdaceafa6995c6f02fbc125b89777dc41e6b438449813f11bf0953ed9793ddf04d7ba9d6dbda63c9402716ce758d80b90e84cacd39cc57a0e909e1ad5742a5f1048176037886ac7651d63d188e1a1b035719c9ec38d23903e2de1d538b1ce4854cd6d03ccc88eb911894b912174032a665733373e35dd4d11f0d80e7546e41cd579f1cd0e9fb5e4d67e4fc23629c8523a2b5b578e224924f645c6dbd676f7835cc189afcbb6c1dc2a36485eed4105c27ecb10daafde3db8be4b26d19e3f056bae5a1d338d0c4531665cc349ddfb27db6454f0f609fb5df45d497635f31b2abbaf9ad77ef10e18859f5a7c5c226e24b44279a42260a343cf26c62e41eb6ef61789da3457fdb96f6a1bb33dbbcd721f0f11626312a6a284468610cd3ae144a29e282a7ddaa7ef7be991fce66722c1780efcf00e010666192b171855ff95c68ffa7491d23363f9b7d9f977ffdc4341c24bdcefc40c3c1ffb82d9cbe1d47dabc6f5c6a70e31a778f53c4379d73e39bda3dabe5d49cecd45ca75f89008198c242d027580db55c6e090b4e278b126a030d91b4a3e13afdd81dec1ddffa0130c612d5dce320332e7d956e2df2078a8e88d3328550aa19c6d0eeed4b1db43dfcff581bfe9dff057bef74c05a453ad0281f8a5325a8433916a0f4f40022e61e882a550fde146e38e50a988147f8fe16da9fb5797c4b8dc66a2249cad3938b973744cf937fdb56581bccd3cf84d50675baeefd5efeb8ae9f1309242b4497ee1aac4cabad1b9f886870d5683e7d8e879ed287f1ec5ba43d7d58a45fb1bf85ba5813c822987f15e8ec0ca4268c97c01bbe2960400241c826075cfcbfcf7681ca2e133615875c08a40520bd9e90bcf161655f3beddca3ad9f71f02daafcc8f0b84baca3f65f0eb5670c4b376ba319e089770c43924ebc91406c7905b774d48d6fcbe30c4692aa1e8d62362949a7739b57238295c5ff5d4742ee83e6db7972e0cbee8fa252872101c6bcf323c1d9244e1648bfce03dce9fe5232c4540a628bf205901682fcb075b08e8058ee8a75195b5c1f39ef8e48b875bf5e4ed2952d3b122a026132aafacb1aaa862c2865d1e30f496aacd4530f79832dbc38077597ec75d4af9ded743f27a88e99495f119f71eaa8873ac137aa159ff00400c3ee4fc4d57364ec5ab55865f752ee2d573d9ccc809e023f297721f385cd6567ff3bcc7cf11d846bf3b3ea759d2bac1356322c07c5edcbfc143a8bd5e4fe316b8c3ae39ec8692f0aadbafe84c684d5c09e1db8a8c65d283abf7df8a264178f01817853118dc91442a0d3ce06b9a6ae563ca99e2043925b2f7cd31741c06a697253616dc21ed3c687bdee002dce305007e60c1f7a9c3eb26f5b53e0e16db60bed9bb9417ec4c5abc33586159ee40e79d3589333149e68beff173af42b571f5ef0de58048c2db2335a5b1e80664f5680cb0c62c149e779ebe69a5a1cc706845151e591b055007e5c987dc1522555bf6cdd80de98e805a3357197c40fa8b9dc1318bf90272770b79fe4ebfaec8516410b67952e05e9242f17af7bf07b5dd65872b17f67eb14a297db20f022ef56afc408cd545defc776ce1e828435c33e24764bbf1abcfc1fd6b8c9348c3af50de40a02e3b818c469579879691f4d6059678b0c7d31101b8d6aa5ed685219d5f0ad29b3d283bb8db1f00e39acbe7a262577ccbde72ca54270130b0f84fc651bfc767e1d79f69d5a2292de0b69afd95bf3f513ce5fca6b7387dd42f6a3736c62938f8f7c5844e132baea4863c7a41962881bb5c8793b247e1f0dc1d2abd7133bbf112dbe81a9e15340bfd8ddb9df7e906f2f4e9634ce920b94fd21e79aad4f494e89c9d0ce7dc0d8fb1c95b11356f88a0ac7579dc4db10f7d18845aace64613c98b9fc50f6dd1bcefdd195b1a6e7ae42853276674396fd4f571893c74868290095f9238f78b7a7ba7587bbbce28673509854006952679da42722f69e7b0f65aa305cd92d999e5ac31925ae0586711fd8b34e0eb11bc1deb97d3980dbb89bdaf75e62cff6ebd12a9347d9f0951fe6b45d52c9e74d83319b38ba4da561eef1196f94279993f787a65e1879aff27bc86ec88a1927da3b66268c2de9656e8687755f100c98853cb26456ce80fc6081aebe32063109c94a662f70de84b0a3ad83b4bfd960e418409b1e1b52e8329c4043e31b3cc003590283ef9fc5dd9d660fafc6171c88236931c4c32ed26750002d53b82dd73580b84210074670ee6046c102738028239c97bfc39f169b63296c97b1a5985431501ce47251ea981e294647b6baa847a0c16adc9cc06ab6311ebcc931ce89236046d0cea7cf2631ac71a0fd90bb0dba979d24a3b034cf20b462761534fa42933df6727c20ea9fe45c5432b4b8d32c30513d6170fc40146aa121dc5f4360b16171a9650dbe1b12aaf6e4abdf7df4ab3e8d5c041ab19c36cff032733c47f7193905bd421a9a814189968c84aea1a370ad726244895a01a6d743bc8ed14a6c06afb2b5a829db0fc4939d1a0cf89dedb2317c30fe07325ead77a066bf632b2358430dd5dcf055f03f6510ee51a763fcee8bfa460e41466ed0bfc5498acf4921948abd38d61f88e2df12d311989b5f4e411dad5509f8a0228b3b789f940939507190d393885b68ad75263bb64c656c78750576aad7a88a98f24c703410eac7edc99c6082453ea857dc2839ad49e56f701f0ed850e7897fb70b4583d010c4e460f24cd20a1f95909ace664434ceb84496c2f4bb2d4feba5baa77e5e142268751c53e8e04e0cb4da00eeee7c2585bfaa576a8b2e48a5043b845fe3841f2aea3d3e64fb56d47bf7ef2cc5b8456ac4e073d2bf72eb454aca5a55b3f1cafbb244b8b9ab78be2a18bae8124fa280ef1d414db7a6c4df86021e1eb1db37a6b6ba1ad049438cc8ffbae3c88461b0b8d3998c7d5be9174216742f31927247c694902ddc395f3c42edb0bced9b2d354d5d4d12545a822ac8bed2fd3ae221688d7f96fc449458e3e87268b10788901d94de10d3fc26e37733b8c0911b4ae877cd89f384b99e6a86aa36c71b4fb122679a4c0be9f8a951b09afc80f349cd6478a537adbe843940221a5be8f705a1ebe8d551df18e71e2e98c0fea9be99d97138ca6f893e690f3de0f4fa1d44542a6329ef613966d18485a83175b09c2050638dd2b2ed066d5c34b16ce277dfdbbdcdd34269d0f4c0feea7c3b727e9103d04e7a33e135a16b54b9f1a8bec568522411ad370c9391c43e6c38b6a1aace6943d47c0ad5e1ddd38820373388bc32fbc2c0a6d0117399883c318bee2a427d405bd854d35c80eb5e60b97d999c66fad78b1398d453bdb726916c5cf9644e9458988e3c1dbe3ea9edd81f3ad6237f1236210207d33e47fdc69b7520b7c310a8f970c62d0b987c968de11245e0bbf45a1162a335a7f575114d196bdfab142ce41081211649c43eb06c45bfc1e87c7d12056c9efa037c9aa98a214cda2d2ae7fe48100ec0e6cb387d28e9a205dd66c9d8efe8b4bd436703d5bd39643734cc04ba38f2796c4c7cded32d98abad7e6fbb62624858e9df241346b6efa8b12f06602f19587fbe1e7f96be35f891f91f1cc465665ae8fab1b82e8e59eb9b4a3d83efabae360bacfb8f6665a6cf946aba9a4c77f99e89d44dd6a57a7907ff3fc34b12e446df958046b0468f2bdee31951e83927629eb0a77ee710be8eac6c058bb3f234510625da8b1442995717aa794834f758434603cf86c79fbfc6eb1f718ca49c70d9217498ffae7e721ca6588bd9fe0c23fda6333c189c0c89c41ed79904be7c8136c054dedb8440c47aa924bd2425b3db33d7e739fe91996ce45353f42c06dfcd5031890eb7add04eb676f37f7c3e0d7d0b7dfaef99af540693c97010f6e99239d3e6c45db0eb6d097a9d8cf99cbe08fba656d769283fa762c6620e68e32bc2eea7299bffc8d6eb969fcfcee5d42d1c2c7ef4a2a3296bdd840819449a86dc1f06508483a7f33f0ea9c330752d0051066b0d5a77b6ccd69817ac341c1f58e9e58e3c093a122d68ae0114d7e1a2aafcd7f77e808d24e8d94878edfb484a7b40ebaebc50f383c47b8bd0681f6f8001959a00955b403aa67e13be26f8d1cd9b04719b9225e3f31d2a9d7953d2202266c128f703faed8226ad424a40d45d09562a05318b92c8e4dd92129c28a950ad5b3bb53febfe08e441b4cb8855ebb95e329b10dba145d99aa64736046fbca03217c0526e772c05c8208085cbe781f59ab7ae0685f9cfef352deb0b1a5d6e5fc9b964ab2765acc6dfe29959ea9acf793fdd6024150dcda6744d9cf16ac1dfde1a4a2540d32e48db08236d6792c303d9098b9ef97365027a4e5ac45ab04fea85fbcd2ca7fb27587b2f1e483fef7ff516ee0466cf43c92de00eb305f635ee612cb0f0f5356a47cc0e6127863ced87e0abe1c4f0d3e21787893f6a0372c081c627c5916e1dca0975f20f74b16e581fa370a0327759650444ed243e3b9c430b9b9372f78582776dbb11f82b0a4b75d472bcd9a0093ba6e76e952be8e11e6eab5294a73186413b49fed9405340fff5e28fedf32d05a6a929b93ac513b1948d533defd898a142eab76731cfd5964f1a61553aecf99c641fa7dd97eb831ae18d73f2f03d243fe2c4e8472c803d3ba73704e7131ed8f02d2e0488868b42a9c1d66f30b8f36b91152ff1279d06db5f1316853912e0de1dca85781652dcb0ab96769f881a81ae7e2c32ba04da6c7c8192711368a5b02a6d1acf18eb996d44eaf66bd8cda67950233570802baaf838885d1359b457bbd7a868a576ca48c80409b853bca4cd27ea047477a6f7802f774f31f089a2eb313392afccf383d513325843b2584929981f81cea0054be0bdd63fcfe3d762e6780e12790d49ac21da5cbfa5db31befa24fe8d48bff835ee3891305c1509972a4e5b3d92df14a1d59df499879d625410716668fbc22746425c071f49bceee614ec9f5383bdfe2adaa5a603b8c09268d8c01a71dec4d605f5d8b87287d493504ab411c364cc3f06c8f53eacaf313163f2baae024be0b55f76d1f4f80cf9501bc27ab2155d987255eb7fd1b7950d3f8832ef0cb4ce55837d10986342996a0dfe61aa215d52f374ce69b5c25790a554c190c3ff45966985707bf7fa9934dce6b7f32ae7934785f342fa99c5cac0cce2a3dde67fbf7a1413a16a4aa2ec81f12ee4da7d6551c39cb5a9c531559547dd9511a74e2c5011c599a9554308233c32ce645f67162ecd2982b8b7bb3846f4af7a09524ed5f9a021d37ebe7eb8402d8434970343896a418e702bd0c5af53db3c6bdf69ca760cf1c343eb2c7dd0049e3685b26b503c2e2f67b0ac592e03ce808003200fabd5542b485bd6d66a01970de72432652ae2960c52db18f406c37a0f9d4555ac921fa40e85c7fef0f405887275b42db3ece7ecc537805068131754b34ce8f3b4b278eb54cd7943030255a6f37d7cd084cec1655ff22255595a8e8ebf5bd4f8b0071d741cf9d6d80ede5420a82e64ef90d8f6c799a697210dddac7866929f98fddf2fe9e40fd28e27b9e7f72c7126cbed0d4fc801edcb62121c2a0097daef363b869d028e88b80af8124fa11ae9ef5d8ad921374ece1b3ac0c221f2cc2490ba5ff1b97a2464e26ffb42457761deb09385374f8a99c76fcea9a339a41ad4deff1c97956c782ded351161546d32801197945b5720a626b07af382de857cb317cd5939dd192756d6caf4e62dfb527fdd6df38a3e1deb22c712148ce4f71f7178d3468fcf89e24d15956787b1744096dcd07f075a5c53619ac05c97b522130b0a7cc4798e275cd841c0b02aac92285ea381e0e7efbff87f8d5f3c256fc2a15e22ac5476ba34fbb4ba0ea383f045962584b6d396596b86a6a67ca5135b2f881c21a67a4e73311acaee8a593e85a038ce6bce4fb2a3f14975a903600b212477b1afd5e9a9bde0dfa59e3ecb8d9072a7dd1cd9cbc762c81af379315745fddad5d64a9f3b3d2b85838d063911975d9ae35e4eb6a966523338b113d3421cf2781143df790098d0e320aefd2fe91e92fcd308aae04e5517c8dcb73789cbc3827ac2f58e7c08f6d6d1b80a12506946a2f7fefe4756f3e1c3c2a9d538807c427d6fd6c949699c65d842799fbca8c5c3111bac3ca6f9f48f29449ac225312feb958f35e4c74e086708c7a47c4b3c8331f5f58bd82caee304d8e143d054c95a5e90c807fbc0fdc277dfc5d23f6de639d1b8994b5dce22775b7ed59237808baff41ea23cfd7920ed6e78ad15de19060e20704f5f5dc0d64053ebf849fad031b82357bac3ddbc4a589b260f7ba14187a40c1c6a554ff0c55936be5a21a159ded551db067177db0d40c9096a55afad2b94d62edbda85057ef7cfaa9aeed4484eb0e6cfa88aff20346fe10d79f38964ad48c1a41c78281e39759a54907a38d6e565b179615dc82fe625ea01e40042b6ca84b4f237667c1af6a77966ecdba918c1ec5b3ea04781997e8cdd98b5161c9e563c04308281afb70b8af953e7f580ae658b640f7e1b5d61b6d0b4c3b56c37730888f67b2892fb5934e4dc76b4cf6206637cee4bbe9fb891ba87da95b04b552e1b98a8b88c4611687c10885ee9a35d8bdfd880e66aa497d717f9935a41ea37c0e41c3dcf5562073ca217922eb8e067457380228b7bcc6c6544d96d06dbad52d740e59e5d6e057f866c68df9639d5d48e667866a23e6e1f2978eaa996aae3184455f7b168afd9e62335fd93b6f263c72c18ded721ac4e7ff29f9d2042375682f58b3869b59be53335dda09ce48707c510a4133fbde0b723445d66d431424dc64a51a9911e20212f519dd9c9eed76d53d40e02826c048b100400e5e37fc737feb17eccebff27142623f33803c2d0c381e72da28c5cb8f8e63e9df6487cd8ea972d42e9d09b85bda83d7da7ded5b5ad1b318b904383943045424f432738b4df7f42ba122dabb7eb20ce5aecbf8ed2aadf71413d89dc059e8850e087ec194184980a4cfce86116e798ae296dea4be52b90e82eadb7d38e39f38a53dc4ad786edeccc6405b340f1be26c94d230c3546570fdd70c62c5ce56cea0a4d7514e9b3a6cdbe20477fdcfd0be5b019ba2cf82673e2b3f2edb0add2f53b1692492e2927185c07f41f68e269067f584331cca6305bf137184bd88fa879f3d742b7359cc7ac4c21612dba97299714ed1e18a6809e4b362defebd52082dd764f760db514700f20f66c4bd606af2749b36bf6dba6533165632b7f776619b1d11ea3f48cb12943960fdb4ddff7b00b16f1acce4e783644989d2ff0a336f293e6857ae6b0bc57cacd2f070888f7c512568ccc6bccecbd7a1777eb3e02a78371f91018b3f7a6ed835d2d076383a5d03950368f4b26e7d23ad2fc8ae135570844aeeed0047a6794aacf10572022e702c0a766997f4e31455bc4f7c3f346446f9315da01151972a4875e29fed7708f51e59c625360f5aec4a694833243e72c1e746a3982257d7512d233d0bc1421215434557a5b5fad70351451159eae8e7c31274669d806a277ee6ef4fa68b1e0afde124f19aef1a55c15b9bb9b61e1c511facdab9c49b74f234d64f4e9d7c8a73485c23dc3682c1248263871db3c222f27b68d0c0bcacdae5424d5dd54033b6561f4559cb344d66e29f49c3cd3592bf4b35c8b6bd01bb828523b230d978dc28b9d4134cfa27f17d2b7567f7e2e435369c11e7363d6761032360eddd96d1049efbb20c4a2f0c363d777071adbc64f12fd97e50d535863ae28b0b222fda9e0526e4f891005af15c7982b703624f70f8b989be5ca179cd343c5f2667dc7059c008d450cf269f59af7521d0c2ee2a18aacb7580ed9ddf7c957d9c4f55a9b5e246db7d689b03062574d0cb8c3a26e9fdc7c0baeb2d76cdc94836784e3bdd2cee6f68a2a9ea9dd60c8c3272b6a0a88f1843ae6be91377f4976a8a0279c26b83a7b006e21e6d5aec351a803a3650f16ab0198c4f902ce1847f1c3205cffe84d4fc76ec8de1f1bb7491445a3bbd200c9e85887010d76ffdf2bfcffd3f7db2d350b2ba48696017e6c73d444b782aac4566cc9f460738207b81c4f04cab2d56590214b9d13e8558b9abe0974c31175f08a59fb0a37dbc67dcd06d304be1884cfca123505870fcacdc1cf1f32423447adc9d24516c7c8b0901ef6e0da58ef6007a63c15a383ea0a2473078a9ef2411c8fb279fcb3eaf02dd0eb1b8aa451856c7a5d78a1a866c00b517fe76e821b3344e13db3701cfc7eaf3754f6f7f8da0ef034acd92e7476b2f44e2ec8935efd3aff2c66db8533b9c2a388cbaeb3cf19813b7e7778e14c3a23ec031692a94083a1e840ee26b6a7f181ed16c201ddda1203aa46c3166f332a16e1fa0cdbd450d155729a741621d853f9474fa60f4586a4f12aab6ebabc98501c424173f1c476492907d7eae9af29826340abe12e854d3653775dbee68c01e573b4cce8d11d0c90fa6274cbe9bf554d4b538371bed00391b5a2140827a9f901f96b44b8c8ecb157c1aa37eeacffb2d7acee3c70de425c6e162813e9964ebac7a7daf671d3b179225c1c8284a671fdfa844632bf364f607ac3b0e7ea656f29a62fa232c47eb67a8966b57f7f06e55509128324c5ffb1e1bdc8a09229c6374ceb70db76f9b771fb1357427cd496c3b47713150182bd95139dd23160d4ad1fd07b3f7bea291908a6516ca8760177a5b7cc976f59840d6950768c1df1f9a82b279ecbfe2c108e1bd865a7a3550d98f3b34a7411c60df2c36fb6782c18f8f1d5e327a3d4777cbfac7d9ed220a27bffc7b24a11cae1ad3b81c709b3da288ab7b8083174a06a70e88d0b21cb88ade01c7aea9caa789d815ee5d0a226cecd176b0536361a17a8760fa0cb5e38f5b6aa072bc87c01a3b03bf9a79ceb2dbab20df58cbaddf177ab17455be66607c4a659a77f51497562a064935f5e9d8f02b9a87c99a41abad55e6ff55cd4f805812b0263c41e1590e24a3ebce59eda641ea14fdb34595a353ba90ddcd4c37e0df78aaf131cc3959264e4d73d8190538bc6694ea76f5ddf78236cbd2a8e0dccd795427594c1ab47f8f8682b38e66574fe2de283b52c685ee86cc5f867d4f288d16cfbd27a07bbb3c60c636924e3fb5fe0e25843a9df35567948bd6d9a7f14a802ba4d4f042ba886b335f6feed0339893923a986d6604bbf954826b228133a0c1216a6713d39cf754e2cf3a4d72dd6d90dff38580346672dc72fd6025b66b52a769b9676bc37fd0707d5fb27a77763d711c502a05ef28f2351cb1586b0f013418ecbf42eb56ea11494a64958dd94feae3bc0d19fbe8c2ac5893adfd799632468a085961ad0b29ac00acd409a494e8fe4e48c414b7847b6a721b8778e988b60be56c626e31f074f6a34cd3256a430231e73b340f7330b975494262370fb819c9b5215a0808f350e7359799ef6695a0cdad6746b30fafa3a7d4c644a843257aa63519afe5fb1ffb4a3b0340468e7b2780a5bd47fefd50a219a839a28296238cb0b771d8c2385f2b5470f0f57f79c7807c4a27e3c707b2ed3d21b620602f57405ef385d49c02dcbd8028853dd5896497ae32c80de7f591437affcbec9cf83397fb68526be3c398860b0f14d1f4a8892f50e8f2c1228d40cc41ebeded819d16b840516c4b7c5656034c358aa975331643db27aefe17e1386e2a684796360376b0228ca525584ef5894d38d892f535aac6938ce2ef30e04193e0e39edff7fa7fd1eb9c0701e6530e7fb09482c05f81a25f9f3afbec0b5943ca39efd503f0a2c1811dcb8ef889da3cb8e542ad7a0bc55b57452c97c2b2405636917bbd57b3f04d6b35056c3497f561dba2c510d75693c983767e028ae6b8e59331c84055c091b1fb75680d1f614f2344164c4c10297eb05ee3430037b4e5a97ce0602b55850485130387d33576a6d5a9af6f3623d31a322da56b0ef936400d0ae295c29d54f965d75d0b9dc2387e2cfdb2f4171be59258427892680b52339fcdc4403b2732856bc030de219cbca1ccda24ec080ca02b1aa1e16017fccc8f297311bb474a502de2b79da5333f445606dcd9f759c0a2967757ce28dd908f7fc7399af076a14205a9abdb7387900791d35641f0a1ee4c45b5ab77b3cd75f41df0ecf9d947ab4d8c070d32ad3547e6f86fcf5b97be2c175fc64b1f41ace7586078ca49507b330579035c2be157ac9df66ca5d090e4e0a7c840698f2ee8f7cdf7a215f8c8b3ecf3114197087c83e72a79c84ce581cfd478d31f5f41454ffb628d2c8d3663ad5b6d155a46fa9b77339e5738f45973f335cace8d1b1975ede18eb5d6438aee7e00e839ed7d9d9c232eb58e99284afb02829f4b5638a6ada74c54314a429606f9e97285c8acb3f2a5f8b7bf8f44b0b639b0960deb3e54ba4757fba663fadf94cce47222ab6243b28cf803061afb5323c757ab3ef245a8db9b50efc236f1fe776fa5803035d4febe1373c473b8afeed0c70aefe0f57721f9da76f591d60d16741b54a14c018cfbe384a7986937df598b652b3a20fccfade6cbafed4c9e6cc690db2f535d4b6c7b05c9cc6b8b68170d8755b9faae1ae022fba5bf11a1b99fc207b5ef6a80f433b5cf078f1cba31228d467ce3f154c7c9d6743f982d6d3b19cd9b7d7f72f750cbe6504f7e398628b51eb9454f26fefb0a79cad6c45d57969ad1113d4ef3eb0d8e416b54fa1216ae209cae56166539c0cf79fd5d94e3f7606219805bf27e45188a9a8bce129cea47c0a3686881753689d5663b9345aece2d7cd423494964472d1f6ac6989d01c1ec6dad7819001fbb32690dfb28d2ea728110e02d8c9361f5eeff2c57a8b9fa4e141f98372a522c4e9b36728a3cd5ce4ae28ce1619de27dc1495ca28df57de6652d2e699110cb37207ae4be98ab267d52dd9542c5022897aba0dce742fab3637cc8c6c10173b216c1c0486ff956686bc54079133d51136c3136990d39c22a2bf32be64edbcff962f9274edcbb01c7c7d1de3681b0c881a9321c8f4b30a6c60d67af1e1ab649e2663a55d5857ecd24d22575fe91e905be59863df7847f32fa4e282d847f2205f9f55ecf79444b0525d5059a5a88d8a5b56ac1cb66d1f11bc4dee272f97b97d6b949233f6f2e97ef498a93dbeae38383e2d9ad9f404776897b4300a4d818cf054f50629895db5c2efee87b9613c2bc20165b182b1932452c86dd88debd72652ba82b3ac1507f937ad60ba61ab99904d86f45229b1dde46d12fb55b038bcb511556923d52c7b74a7d5c743a0b4fc6d7168f3831b606a3fb5e785e240b7231d183194bee8bb994a7ac69021141b70387b1d0bfce2d8ad160b61222c1da1ba993b37e98ec8a930c1b464d56e23d81867b927306e7aad566f2b3954c4644104f6f8a4c626996cd31b618f688e0ca95e8348dea52943bbc33e3841f0c99c9ce1fe6bcc28e55d5f695c09e92dfa7749763840b589e1f5407e7536e17f75970ff8275b90d8d5dc24f29d84412625a1169e6b6cd1ae8b4d558b806902847e4002a54de48eca713527b90b5422ec622852f083e2e24cc7056aee17c16cda83feef045f401a0ab6db6709964e763fa7d44ff0e831e85adfb267fb6ed4411c33f97d42850007dc9139bbae703239dc18adb855ea0a1574999a4a8f8d1282a4f1155dbd06806190ac3d5e139004c88cdc5f0b752b4f50985907d8d8ce75dbe56bca9b04ad5e4eb4a9d2edb305693c038106716e8ea56c0e644a2b453abd38f0d6202c67fe83ef36132f655c9c78537b974d97f098d2b05ca5e7b43830d3203df6c8ea1ce217668b839a86b35840cebcf1bc4b32ad93516041a9b141a43a2cc65d9c32bcab4e3eadf730000fb64f9006e2054efff2b0426c4f9ef7faf56d15965758cbd41caacddced7816a4015ea949b787147f3fe9ea11ecc14d47b283517e21cbb764f9fca9acd9556ea28c9cf2fd236f86a5fdf4aa0d619a7f81e9540570521c860a9716621a733efb426f668b70edbeb66a72c53ca1b7022af651d7aa96acc1f20f7e21dcacf9aa42efc1a09d2095b2d2d09f81a7fa9a815a7ee4427d5a873031ff409ac5f1b72a26a82f68615dfc16c60fabbfd67c63c84698b077d530ac5d0b04884f3e59df6d00c0f22da42d9d02c04c032dc11581217e2901d04e45a8d3aa80f7893403f2acc9f27fa5b8535c8d789412fc76d706ae27ab083adb7240d4d0afdd3e2c1ea55b25a18d0429f955a4843470f575ce234570c494254b05e90d2281d0cbf7f0436c1ea4a60f4e111d8283d16527529d377b36ed8938b0ccf6658a6a7ec34b7e9845c82b078d34b4c4782d57c64a4f4203b2d6dd7a9713c80cdbb980545ed2956a894e610edbdc5c14e4241c0656a88157b56c5af97fdcf89e034f5fec3eb217a7fcb3f0b9e9d294e4dbd62c35d51b926361a670547d7181dc2f9658da6b3ee611985b60e390370bb79489a334ca6dd68be8190d994d26d6affb2f29cbce55b07a535d50e211a36214407052343077b7d3aca4a96a141e9f19855c1abadb4789b2426a4d0c4a055d135ef0dafabcd200acc0cd294e11f013ec7f026e866a70f6bda73c346709ecb605303584a5fd3f7ad881a182ba9353e9607d6663cc56c17221c5f9642ba682e8ae356000598d98b0891f8780d4342b81a158ad9d7d5335d9ce1aaa36631c3ae45862c13051bacc3e5395deaf6951fe3d9a06f764d09c4919be963b857e4933b061f1c0c92c6ae90cb35daf457e92480dd5433fd67a9886f9b86233492cc5a96524a560966ee22ddc7c588fa6d19d88b0d7aa15710481df2c65aa07247b84d53f4372940810d09b680c03debc8c5fbb2bc0e0b5a84f54711606b7257c2fd4dbc47de3c98786136cf0d033867886b5aa6c48abe4e04b239c0949fa722b876a65df81212b71d2a0195742990a4a59f6dfca721b5b9f87832367b2b9208bdafd06afd4035ca295044783bffcd53106436fe25776719182091344233608c4f3eee8daa850c1852541214432f6448315ff7719151c86e6198e4d9981a853b5abf0a30f9103f80c03a767baa5f0012d9e766fde17759f4a25b813a09eef8882d799b7098a9c23e16bc7ac5a49fca77f29ce8f3d8bb04be96af0643c78e73c3f3f2f5eac4d482c522c8c8abc02a93a7f29bf5698f509f6a0c6650dc02af983f19ce1f3b4c9e797ed70022e778725f299c073ce97a6858002322a7ea53a47e2e67f2309e381d2b12244ee7bfb3bb7be506c2f8e10567a2fdb4ef1bd82255cde092efab37b9e627fa6058d90d59baf16451903248a13b83c43760f6f8cdf6ce64b277deda0698be27b103e57ec37c16e69bb1ef354a5f0ff69df431bf40fe2e144c8d9dcee8362b0444f1ba62449dc369a13f4cac8bf1566f4c585e24b4ac61b4230122d9ba134f80e0f98692234cf61c00eedb9b951dcea89011577899f6500688f73d95c15b62e0628706dd0edd395b155a42c9e6ae7dba6149dd5513001f99ea36bccd607cf2cea31220b9dcc2a5e3a9a353f4663b12df53867086426a291a6e702ae52f5ddc6257dd7ff0a89c66ac994d5ed22436ed14a9afd46f5bbf152d3c1485a2214325c8ed9ed7ffdf2058375110d807833d60ef5ac579ea808bf4c995066e760522e283cda98f4cda438c624b25a95c59833f44e779a25e4a87945e7cabef6578b7b6f3fab0028d61ac32f2577e03cef942b510d6ea9ead69c33e8156e71af13df543abd0f6c2a1346023386aadc1a49a5114edaefc9b0bf7bb63d9b14c3098949ee935c3c0ec4219b60d2e9186c9a70bf8aa2a9ae48cc10a4eec44f0abd872c4a7dd591e959a7f322a096d2d52475c8ac4eaf106d72c4683607615f9d5f3b0997e862f555efa1c5967f1ed8f92de42c6cdccb5fc1451543296fd8563302f637428b8133ec04d06f38f7a165510e39fbb0108d963e879b2f805a1e5808797efaab0c56b197e837e98d6c303d6e6a49ec3f7b0b9d07f12e316bef8de97b1d5e54222ef6a021dff02c33ee6d2a07b03418f7d3a3a1926979f3f89d92a4ada57321309488a6efd21cc9f0866be18a6126ad8299351fde116705e67f95598b484e083a2531484792a671ac2f8e1ae8c19682fdb7ffcda96678a3f481985cc521c89303e3a9233ae928b01fbbd49b544bd137f137857cfe28475128130ba2a8ad8431f2e3b961ba0525324aed8979d6f950ae248e7e4bf25ee66b9b548941a851a8f08f3c2d9e477c5d8519e3bccc75cf2cb6fc6e199215b9a66d0654a547b4415b7613a32eb62afa1c3d1a01e391c933e1241ac148fe077aed40afe5877e03bc7f08a6717023e11f87fb5ad9d72da4990d1bf6428b79480139969fb46f6dbd9bce7c61954f99ecff5cb1a50d4332e3caf59e52e6fa99441d216f62f8587df5bcd87295e54eb746adfac2d3448bb73ac1dacbd41c10284f6d24219521640bceb23bc323864a7eaf3e00a24126e1586ea680999036c839a1e288441ff7e561bf974530d755b45cdfa0a6b36d235d06b1af19dafcf62720143e6f8fc1cc445e014036ae78479ce9017ac917670405a3d72a0493543caf609e70fcc2770cd6fb9d57d279b2ef946959fbfcf4dc4867e0258f9e729ebc641f9773bb8e59509e013607bb4189f08e5ced73f621698597bf8c02f4ea80671ed2afa302ee1219d2d2bb977faeea148c98febe3c968eba48dc347ab3fddc28872c1c449c7322f88c4eb5c8efa11fd86b886ab9be50b74cac2ed83f8c2112baa060fc9dd2714cc0e6224e565f32f31e8ac007fa28ce4862aabf6dd79dc377709c104b28569ab4170156a76688ffa74dc2ffb62c3329e2f7f1940a3f25cca72a7ef15e59a47cd5ec978b9fe70abd1ee6ae1b6c4f623ac7ffbfe5e8f9a6db0ca7d00dbcab4bf2a3565d8bb09f7defa9ccbab32ac6a8961001615accce9087fbc4677b784f48c6ac49ba333470b4a6d25518c1e2a0d6eeffc0b18301b0cdc0d5ebce466a0394d8b0c9b3d06a3d8049a0a10aac83c64e8dbe741d9eb8204abc7562b07e0f097694474f240250d57b983627b762deb2a8334a7a188a9fa93842f7ba754cb0c5a0a666441f79eb52ee1993877e2e065ac913c46b1e4be928687fefed561c0c0ef9bc01ccd0e7f5912fc2f01dbdced15bb4905b1041ee1908978cb1370eda17041b5c3e32d9584ce956007ea8a4e41dd66e484613de9b450c6a2f90643f13759a6670abd0ad59a6616ad5fa371c1c138d10c9c69c7a7d346acc989a27271337e82077b206737172cacbddfeef5d5a9c96fc76d8f0d9905f51119008c47639d5153638d6dbd24f4a7f7330f44cec0dc88854e76b9bdd106ece922ce6e6374a92ee35b772b3063593c9aaff41231937893c21b6ebb4b3966c6622c0ec70883feee958180d9f538fe5ba3f814b80ca53947321bcad074b52841f7d96d5f0f8a770ed26f82f61a391c503f4ed9961aeeaec8e5ce3e5980d6e94b7e8ec6fc23c7764f6dba6c8b4977e742571f97b8ccee9156f3402b55382b269100987ab5a3a76d4a4848b0ff2213ea5d492e0609c069bf3681e0be0b80843a503e78b7cb0b9adb379a3547eb1c11eb2bf0d30bad3c712afb4c352838d3eb6808122da76a41019ef4cd8b07ac06c240ab999cdb64918d6cfd9d37e6e433fcadb1767f4a44684604c297e2699a77a0a1cef6b89992326c70ea0237adac4d95ad0cedcf160b4172b19e3ba504ae1009e9307458b1b8710bcacb0dd2518cf4864b9cf36649d7a4998a7add0cd8eb550c20ddcf219fc492d09125e7232f837bf60eb95f8a6926031232a640b47996300e73660e5b9e66280bc237bba86722ad67aac7c9110071d1806d82222f9b49e99431c5dfe366ea923140d64d0d627860de44f8b792d458bf5bd31817cc8b1599749344df0c3cae27ed64c19278b6cad03a32a66117bf515f213ea177c42264e1332e0736afcb9bef79d5ce3acdfbd170e584fcfaa67211f5c7f547a31a0d09cbf5289bb10d65966e89e7b1f25794ea70dcac4644066b166394ad65df4949fd061ec7c4fd95810067767688bea5a380fac3490d20dd920a5cbb9cdaf6bf8f90c145279a95efe770351e4ede784cca3f261a262a6c071d5d80318bc084e0ace5edf9678c476a68f0e23f22d53ee8ce9e63aae88d3b4340c1790015d6bbcccc9f456f1e0e01620d269d094fc91e71aa25fcc435c79ebde68da070e1b70e81e596b939175a74db3f6e0a1a9a7f3082dd197cbd8f8889214ae215e93b0ab2c8a23e22df7550722c7d3f6a24a15be37d93f6e17f87ceb0289fe319de9cd662e9ae1c14ddacae228879056a9d043775b178e08a05bdf409de24e2ec04a17ade1290b577752f6e9c7b8ea67a64e59c04e366abdb8e402cf4549539378c877eb4fee68c561915e242e2877b747b58348e5c9815db9c56fa9640967ef7f4c5196469ecb1de23fea433c328fccc2dc26f6469529cd1e185d43b090e1232403ad65135c2aef9fb1b7b7854f3138b1c439a5b6a724b8bb7a4839d99d5e94dcf4b530adcdf03d94b92e3ecd811405c9cfa149e84e3520772dd9ac2bc5ab1fc1c6dfdd0e88bc71f0b55845defa91c65e942f33db6751b443bc4895f240c8e94420b9928739e76d5aae23a90f58cc5f22edb432004fcb486dc8a1276c32a0744caefb8448303b0c47f8283d6f019350bf8ed62fd39eab48f42d3af36b26cee271b214c96d5bdd44b3f7c1a82e16c3d90d0ba473fe1f8c6139f903f7e479d7501c5fcc5074e51b67cac2e3b6d714c8734f423bbfdfd0fcbfd76ad57a0126220ff1b1583b9473963dcd61b60b876328ca1b39fc9eb754ca6c605af3f7010b2ef9083674b11ec273a18e46497b0ef60194e581df3e6c53cfe7a405f67e8d5cf46fae0e92b275d8c3d522174a4ea85e119d05f4bf99091e42ef5bdbdf67d4a8b3c6e65b55c6f2b76afb6323e0a11d4795f14e9ef267da84066d6c73d96f9518a124f132318517f2d702164848102775eda68be9b63a20700df2ea6903b367959d53f7b9a5f3426b41ec299e21de4952b9b38446e0b840805e70923e362e2898c2cb227f0fb642fd249ab75c55ce5dfb57270c7c6274617e8317cf8e1373a64b1f32e9acbb35cccf416225629d4d167111fa6f970e01a2944b086679065296c1c57e98bb88dad4c83fb0b24a9dbd1e0a7a926ed596563bf215c36f6f4103c493e9b71f9fa2490abdaecd0e117b216b6769190c21d1605b0acc400d23f32566937fdd0302c964aaae0ba5931a0ffe544afb01656258272760b848305c92cd6b1f63184a4bfeb8c40ae2da6355f50c18cdbbb825d5fa0f4b3a1fa8355f58493b711cd973d5a2e9297d072c880da4fc7085ffd0181e39a19ef749c21e421ffda7d85a5b5cdd27bda270e75ed35dd193eab1413bb9549d61bd9306fdaba130b7075a626837a6e56c544c0120ae93dae52d338e4c53d9eddc6e3421d72","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"ab2beec4f19cdcf7b5c909265e03bcab"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
