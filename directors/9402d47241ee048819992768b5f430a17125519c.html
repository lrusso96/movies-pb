<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"3f0ba0bc32cca93f877f95a6f1df4cfba8fffb2d9e30ffef4e2b2fa83590ce7b72280c6b569c2eb03ad3d2a4e385393eadf1e77182ad9efe2f32c49780d0c39e2e7b28adeb45028000f692339cdfe101d13cb7fca8f8c3a25e5da4d8c19709b1bcc12244d74df804ca0f2997bc783e73172430f0fb5393eb4dabe6f3f8271840dc92b6f726993f0d4ad6f87fbb7d43567fbd307a1fb266dc68b9ef85ecddf8f0af575cd1f87d29bd64b0f596386441c31255985d25c82b81248ddb4a80a57157abeb0b5803c621fbf8f8168b4544b84ef3de41310d7aada0f2faffd47c13bfce40c8982d54d9b2dc1e3e2f2bc2c39c700f67bdd5fafc2b86b50c1be3837cfd1d5087ba2dfc4a2a200785de9d3c08612e5a0dc1bc55e0ced3af7b7ce8658dd40ae30245576b7e0f0fb2257a052c322681cfde6e6df0b711a249696f8a283f540d4a678840e4b2c5ec3bdb1f87bb7a0e6170dbe8ffd88593fbf1e7c80bfb2b37082acac18807f6afc3cf22d842143cc12e09334ce30f22238013f56009cb75af0c6208b66c6f6cac172d6f4a7c6c57bfc117f787d2492064d68ab7988a38db16616b6a2120bfeb9ed0bc2ac914bccb0001335aa22d1ec8ca00c3b100dfa2d34c771b52a08e9976c48741b304e068735a6d605b95d9a7e87e632cf66d450429a01f1c6769cbd2066c3da6fa23a78c6c8f6b17eff44e200908d96d8fbe53987e2dd60479b873fbcef5d5b42bbf93d5277db1f1e8e7a77e36f57edea78fbb8dfe370041df96b94f64d2cf69325ab0a673725ebb222172b18b111e18cb76bf848f3bd39a46d1c29c62781d799037aab9208c1da952a6c7d06ccfe06257519ddd0f6b599dd399eed68727e9067fdc9cfd0f16bc574657a8a2b53ea1cbb5db5b29dc86eb927d686996e8fb1a2cdf8c7b44c4faaaf0bdbaed2fb25c30cf36f8c7b7750d3afc67865731df7671bf00f3c330e9f8783a179b44f2399fd52d0fa54a836d8d0f16ab7375db94e031450cac670923a121bc5479a89a00c3959237b12486bafc8a6578180c301b6ac701110004d44deb82526c4c8c1f2b4b1958b487b1f4c9fd4b21785a56eed215d82ceac723fb90c3c28a5e571590c93db110dc52e1d410695989fdc804baa649da271578889bb40ac63d8f470f7d8bd73080ac66ad9ce2c93348ac73114e6b528f3a7e67c414344e0851edb6ec504812e99bf275935d610d61dd1b067575b605d83c1b0cc97d0cd08b4ae0e9c63377ee3236ceff731f6d01c9b2c0fcdb6177265d2255b1e340380f29d35667b991583481f2c91da5c75b8eb272402edcb79b7a7d1156567b7f4cdf5a145c46b7c4238a60e7a6b91089bbe9b01d0dc25b5ace2a6965fd825eb560042041ac0ef3cd7c5e3284e1ef2bd8fff632f61bbedafe4dc082c0f7f468f8eb42ee1497a943831f1ca57c6ea9285ad94f59714ccd91a907b9a842037f906d2b85617e184d13b7191774be27e9170bb13e1f5e9e22f7dc01b2cd206ea38c491038227bae69dc61c5063c7cbddb6a9b6fe401fe0feb3eaa9b334ca56f5598a0882b847a49bc19b071c4198e0dee0e441257d8685db30fe4540937b1c138d41eef918c44f83a983b5ebfb0b3f7dfa2680fa23cf80b1d529996e884917e545555ac09fc1d6189f60613c483b1066b4d74de996fdd8f97411c96b8efaa3941e72d0fbf335dc702e44710bdb13ebc93f96fd9b6820a8dd6fa37646156860becdb50116ebe105969ed72701779fe726d742c0045ca664ff101a791e4fd7aa8acc0b32fb50c4451f9d5d25596a9064c51f2175e3da5e13d6b5301a6ab880eb6780d806780dfeea931cb4b4d2fe06c9ad2abb7ef140f513524eabae118dac7753e01da207ce2698dba2ef198d4ffae13170c68955ddf57472940b1ee292d1614ff0972f499e2c2c8f19e923e8944cd2e1a0c33c6f6282bed90fac25375b13363c2623339a903f8cd9a7c8fa7d6378c8e83e517d1ada3bbcac779c1c0127b983d88f76db7b5081c9a3a41e8f3c4765d7e0f60f897d9b26a934a0fc3640578b7ebe1ad11a9f324d59e9dd90fb2ca3252c4f1b23d6c3cc4b48f2d5fdcbc709eb80c594d27da0d9170357ba3e236d59fb1e7dd43468a51557eb7bdde5e73db973a45cdca830eac56bc973d0315a1a882be0322cbd402f2c97861ac96a7d7f9b57112ed1f5e3c5daa6f713499782baa99997bf65abe2d2daf2407226937a47fb2b38c891f2c3fffb1d3fb0ee3eeeba1dbebbaf8ef8f9d8a5b2870e202485dd15bd45f4383e387851cda89a03c3a9cce6ba8b5eddcfa308d508206ef9237d0ec26f457d2c127c83adfa9b02c21bafb4b7de2dfcabbd1dfe2bd81c3e8cec49bb844ed168997fef7a040885d293a2a575bf09d5fc80adac46d71402b849eb7ee83475a4d8abfa2045a155499b8988bac0e88f5b39c0a3bc86eb5f64e9d7509755fd47b242ddcf9f4867fa40e5a1e90299f96b09853d6a5cd3ef77a30fe28a67192329ca7a3d7c28ed1e2cfe52d2956e9b14700b65a6163e09c8fec34de2dba86ec57173182e87b8385fc4c96102b122270b3431c67b6a3093f781702176aa209fcb0611906f623dd04a1bb37a1362992cfea98ab88b12acd7f19381f2fc7cb87b1d4c523ad6877b36fbe9cea07a1ce04a29675b90a2820929063832b666913f2b19297da3f1e8b6ba5e1ba0b0ddbd93fcd752697cb60e687317e78fdef92cb0bb7e06a4d48cc24493cafd6c28bf68edd00c43107951c9e3df9babe573c48074131d4587116bdceea6e6acd7eb52496b67d771226437a4fb1c2cd396691bdd02e9a367b1736e69ad9d68e00a2853f4e10f9a0cf7609c270f4bfb3a31a9addf3540b00716d7d41f352820285536a1e3b58ff70e1ceba7615492ad3ae2e44b69dc28b4fda3383551b6b2b029fba0cf6678f3ae97ce1872e220e7b6fe14c25113578a61e33cf6abe20bd88ad90d1cc14241d3ac51cb9fc4bacc754d0cea1aacbf8911c0bb09ade58d726c4d8c584a32c972b51b72d3cf642a9aa1f4ba4ec3585a418928e657d771f3670d75ba31cd332367796a33699561ff8f0026cc7146bf9cce300f547032f935d1be81b08ac7e50927a8fb63a2442f973c7c071129b313774430d4f113b19e0ee61be65229dcdff1304f20e48598d2621973b9687f80ecfec49662a54a821fce99f31c2700e4f319f1ffd328592f2897b0f278976353e67d719bb3bb06ed9f618153f2f736ed11b396cfbfc81f7b06e57eb2d73a3df9401cc15f576d71fef2b0b097ce891c1f293d6a270e3777462e7935687c2b37ddabd15b4517cb88a1e951427426e5f63f07db75a5d849e0f0f2f5497454ed98500061cc1b9bf628dc7618ab328f8ebab33cca8aca0e4f386d08d4f855e965739e64792e59ef6fcea49eb21bc3e356994afc76613eecd9c6b05160f35058fbf8e907627061190c379d51f5bb39b552bb262b85ef54ac79f709c782f01646d244ee9bb806d07cd0537104ae7a9af2277bb81fe6b2b8fa26d26af4cd4c63e64fdf56455c2012791ac8dad1dc13fd3da51d31400857e4257e1237200abf77175ac29bd13ca4fa0adb87ab4ae71e482fddb0bd1dc4093755b8899aec85a3933f2b85eb7deeea9a703b904ac0d20d983bfb188c607e931af5a4fd78c542b137669f08289bd0f308284101a401d5fe425a271a01b0ffc83169b79452eea3a2150ffe531f66c6ba7078000019365c2fce9baf787dbb41904e1a61cf41f4f4f74cc5b5d4e450adac06f7c4a90ee046d89db0572d2b04fb1c15498f65d8847fc850c391c42ee5d37288878fb6172cb8a9acc64b00a611123cedd333d14497a6bea9f6b37954eb92c896d222457c66ba8ec27de743c548c3416165c82306dfaa9de847b9a0a5766fb828b5f9e69f53d15d63564ab5f019843fc6b59c2c7be05ce6fa16fc6c2b910ce22437649a32c5a93afed17f72eea83294b7400a2be8bc876ff1d0b1f769a623636a2eafd6d4955d19c782c3ce77a8e23044bdc12090df8126b95896e4daa82d290ca7fb67a9a80299e7a93b30a69ab8a34fa806ede479a71e2f9e3ef5424315e88b1927fee52e402a407eab1254d125cbbe694d9b412c646d7fa0173e6f90388aacf1921f7775cab42172e89cd2535879cc12d1e80b741ddb2d33c6a5e448341a6a720a56d537b336a3141b34758eab3980bbd7f5c2653b1e263d33da8c2f32c0e97527c3a550f3261e169b0ee35cafb770b68d3202e040912105611e4445fb985d77626e8545c2e663d8bf43d02acbb9f61479cec12077865236068d624e6bdeee118699a2dbb1d76ecb56c462118c77d2ede8305af13379049da047402863ac753b9b492161fa92b4280241ced7f0367fa38aa1ba5453d01dabd621d628ed2adf901d307d465d4806d5e2036d1cd2029c37aaab98807980a96f44be9633d6ee3c3ea14dd84eabc64e2312b0cd7ba55d3b3f13fce3d1bcd0ebcea8a5744567adde289d104c8f89e13e95098fe496cdea56cc023f3b5c6cff48deb983e8b2fdafbfc90d645377bc217f3e733848bc76a79afb16a6128a2f07bf776cd3980cc144a5953624527e1a9495049ef8ea8972a3d408ad53817804d5e168a8bf548e4a87f330a24fb80836107068e6246e2dbe3e25338d5789a3075885fe80c7e0bd42bea472c41c99acf32cab9dbd2e7e01296438d7cc98c4db6406259c434f921ab0f1ec224e2e794592f1acb62c1649263e783dd9bf24d7c96a51393bd5d0547a7ab10f7950100fb1004d20e44760f55a2867e6743c2ed11ccfec2cabeb98060e9c5bf1ef274b05e2dda24f00607cf1341c76f669c73ed148d6370ffcf6f0b49ecdeb84e77b16d84eeb4629188125c6764198a45d070f59e034a0735d680a1358a91aab18a1b0b5b3cf9859d2900e5ef1e7ebbccb3ba739cb56345e0261ba27a03ae07566e4333ac9a6c61c8b0de74f28c192d3f1db429868139500250421c4fbd39eccac7a17cc9ef677625fa467bada0a2e6be3117a30404746d2c3039e4f0a0815e439a06b7c21eb7303bb76c03e9d5bcbc25341150ac4052b4f24ca516000c11ce89d48d60daa220bc009ede0857f99acecb0f255c8c1381e5981923d6b2e15f035ae4da34ab101214d60c8577feabe5b658315ffca35f2dd93852bb7c77c8cbd7402d53af977af219ab0a216098d6280efe8b3377d0b245dc904e696adf423ade808ce47b25be6e6b5ca2c60e99f50929c3efdbd3d350fd93895c2dab666a2d21fd5f09bd1ba05150fefd474b1b10b65c9e19e20c2b518f3f6fb1a3961578d284ab4cceb1a9bb040cb45f6fefbdafbb74e6d23310ae7a4fea92cbb3d944dc49631f311b41f177d90ed2ff39ba089a88261c588410460eb2f792d4faec158453fab25a2b03af6d20e50eebb0e1d2f42fd3467d6b58bd0f6bd3c99b277a718fceb89a5c6510eba925e5dc9d1d016f0c970f68d34b11248e82256aed95b1a6f20f647a781558dbeff4407c418251ee1cd1434450273af9af2885d6fb0d7020c38c508b202b81ba6f1559e737008e1b36f2633edd6f82c78f5b90b665c5453f56a91ffe19f7ca1360b42631b3b677444adeccd14b6a1c1825c4ab066d8539d9446c5e102ea590c1c909863ca172585aac932495f87499da80bf7ad604d29cea4a69f3b5fce2c24cac1c53366503f273842358aebd100e69c5b90cda87941947f743c62692fb903552334a29bd1505245cf9c2a3e63e38b3f13639db42b77c00f4ca44fadeeb1b10cb385e62b5e70ea0f320ac181775ae1d935403bbca21705e946b3b34b125d2cd4c501e6ba9c70d268807d459dff975ed9bbc245327b58dd407d4f291cf9c1785eeb9da489f6e3edaab7401a362933552c78f66c1eae1644f12544af0e6af9121393e0c8db15a9078f12e70addb50945608e5edbf327b51584db3750799435ff1b959af5bef43221d4f27399838142257b398ce4e6dcd174e760caa6fa80f02ce9fc2338a07cf8e227535ca15a64b90db404ede9717dbb478142b438ee4fa5bf0478a663b4b03198b032ec44a12392bbef21138a3ffb5f1e78e1e2e97f5d051847941a92e9f779f429d315c7654374de80452ec1235b8136e3605c4550901a53444675251a3b48d9d470f6b987bdfaa60ebdbeb4b7b79ce04ec89eef6c5678c6e3e46019e27e991932470a4f050cec4649e761027828992ce850c029e4b990cefec9f9762ede4240f6243afcee692854db29a6cddca544512d8a9731978c2ba0398aa2b67ae97539304f5f7147e2986adc508ee4dc906c72fe5ffa2a5b0db3469778614b4674bc177786d131288c1e2e1ef12108764d1081aba1a5ce6349ec3852870a6dbde1a2856202542f0b3c8c7759740bf45d2bcc3d65fac8b1d405b41538b458cd41ca73acff1ee4fbce561bc00bae82ca800ad7a8c2dbd8a26409bcd1c194033c533d7d18f02dd03c990a3c65ee2042a71951792639bc42773a4d9185351a24098ee25d5ad5cdc6d7e193d70ad8cd95254e0d8786ce69185a349f6ed686dd26eac9fc9fbaf86107f0a3d9ec7e506a5639dcfbe6f8bafb67c038cc5b1adf78ca45f2d7f29dbd1d86331def7cdc329c554934e24519d4d8202e70f97aaf5ebaacfb2f97e0f11342cb95e3697ad7135b54e3f86577c6cc4b4d7ddb7849c165f903c2a2d58a9bb4676403042a32bbff8bfe7d8ef688469cc130457812ade021ebff508e5bd42eed0219bf1c2ed05cba36bcb6efb3191758207717a8fd6bfa9be907f313deca3e9fc59167ffd2677f33f1c02376d1baa0c332971729822805dad0573ca86c16e5f5417442f4ec3484b4ee1a72c289a2f68fbb22441758c5ff5af35b387c72bbda0e4af2898b931f7e4e378979da4de85fc894ba2bf9dae40d2daff866bd6125622edc02c6b491895f04fb13460574292f0e44968aa4fd58087895390c0691ce6eb817ed92ccd76b870e2bb7678177191cfb9f2149d90983a5fe61128a7a6babb880ed4adb23196d9cc605f33085d0848ad191f8fffd700e9c609edf25ad46e3813515a44cf1d9945b9dc6959cfa7931c22805db1b0efae60fa603f86b9a2543992dfc3846c1d0a1124e560919e041df3af16a2786b4715f32b59829e8b7e0e2a6a9e8f71a6d7626e35dd25a99d7ed35e9fc088e4a3454b38e26e53aa8ce90f74586ab8e449a56be67d57fd100ca41e705c69640f1d086e4627c29ea1197a4285f2bb7d14eabe914867ff4a183831c29a585312503b1c4613e5d67935882ca6b568ba172e12535c59aca22bf569bce1be7935a23bc467e1c8befd07dd1394150cf86c5ead08721282eb4c46b4353c1cd025342168734c43c51cc691d5a13fe181e5bed95e2f7c6870e5d57902f567435b563bc68f14db90a5fcb99a705ac62f8b884e97c38f8bc60c65ff56b751f157cf16ef183785ae206505dd544c2812e54797d722ade77fb74be43d95d60ff7cd0b3c4708b7584ff516fc0863c786ab785690740e654c98802b103d62441a7e5194e8ac502f979d4147fd65ee026ab9a4fc8ef0cf1f1ed950aa60557cfd307f71af1768cb0a296311c51968e8d7f99300c7dcd77fbf676e465871df5f8d19e11337e4ce4d48428cb4c831e81972bbee6e84db9d8077c6b176774bed3c8cf436578479b6c0e2820ed01266ea21d6b3b1d90ad6054c0fa7a675fc1da17251099cdc57a3bfa5d1a5818f4056bd4c999f865194b136338694fe8175043de1b48d9501a64d73a336afda4571929467a3dbcfd6bba697cd51192d365268804751398fca0308ce0c236bba16d522a2c68f4c12d7bac1d9e1af905d96b84b376a0077a46d1ececd4c34f94fe9bbcdd61aa89bb43137f73660c180323b85f6a8b3b1d8bf47484afb593404a30de4e451d61ab75c52c7d8cc7753870c5af61b5dfaa4f45eb57d0981fbea3865817579af91b0127550b0ec7531b1e4d6ae001dcf83949ef691c9a3e18de88943550e231102755e8e6fe6c5b342edd2ffe431debe023c38d249ebffc5ee6e93990a87cc4d0936ff85662f7c27eb60e8ea6619a3b6ef8cf697c56cb321a4a586be137a487955e8a154618375e64a7f0b24cb6001c130b54d94f7bcc2bd441b2c446f44b9c79cbd0778f3d57c6571f5b6a5e43bd7d03ae1894c3bad7cc5efa08f5666943312438574e3285a0733647ed2d0e08fce789c1e1200efa8d27610c679519f0f2633220dba4b7764f419a497c61408f42db9bbda28f4cf9a18aa0fcf2484721b13007ce07d0e1923f982b5f3d4a6aaf412319646e151f8351855d640a3ebcb3afd2fdb6fcec47b4c3367523ad9f675daffefa6a6f64c0471e10962c5d421d9db8a9b7b2fbb12c3b096369f3d0e5172801769c0cb107c170473a7fa5d7ec53c38d57f3856d380a53554dca6ab72d92aa228d5d0d7e3678f7ed0fe5c5fb04c72cf443097db05fa88322baccc60da6ec0a96623000c522a1198301f8aece4faf7a5ad6267562bbbe68ae4bacf83e38119f76d0f03c882cf2af3b22b8b5dd8013c9f6dc5aa27773e7dfa7bbc27a1069dee0c88765ed531c614fb8c3450c735441636ad3fb79f2e51cca8c2746e7d002b10557107a20be73ef43d03a2f483c36952000f7c466b633861e85d5d309ddcdbffc539b2c39880d745ba53d142cbb3b7af2869758f629c08cb3813600b17d179391c1f1518920e101e9b647aceae1ebe463ac66cd6da7f7cf1ff93414eb48692f9be5b37cc37e5b71f0c22fbb80871900103034925b4e5dce943ca4fe1e474a75f1b3cebb1641b4532afb6647ffd815ce47704787ac113e09173024bd891dbdcc3a49a741643177de1dd49ae7cd12e24509110c67dab0898f372ac627d2a6f701827a0124b7193308d7ed1237a8ad48e7d77a795c1247b07e2ecc55c843f60eefce7f629c8dbeaca9258b0a2f7b37058b6749dee332deba8fe243b9e8db7cebf8e9451b350badcbabc88e8ff63bcafc41afa76e9964681e77a0bdc7a79affb97e86acc65047870028cfd3f21c7eff9f8b14f7ae431da5528e72b58350a4589e01b231ec052b44f912b8f99563f3f55701cdc660bc9aaa3875240718ebfa9017550098decc9fef77b0ef3b43743e11217aa1020cc1194b7e19f5840887f5609c462e14f55a47e2b97998017715e25c2d9e850e6bff1a4f5de9d6d8c1e541c477f3bcd73ae5181bf8de9c56731d9786a02706463ecb1faa18cf780df0ee390feba8e8ba0f4be0ea8be2461a0e1f73e48eef6bc8449cbbff74a5bb1260b080e390653cf83ba8caa1e80542e4e253d888b7a3d8f066dd9875a30bb791791b96a03318afbcace20b7d7325295cbd10720015eb2393b7a4e59c63b290ef2715896775abc0f8d6850c5f685acb27783831c9c3f6fd98e354ceb01e1f03bf470660aaf8e8b9e9588d952169366b077a1508014e55ebaaf5f0e8b6ba5b57f032c54eaf5caea0870776f5ae34b68e94c32e11f311fc04f2d71188d384c40cde70c2f26b4311111e9735dbba82fce8cdee55895e2a0da35e8f88ce889dc5a7ae1050710ec480498031de229205e5ebcd3043c62fb9d2d367ad70d5c4b48f9185f9288c56a6db97bc174c679eb2a2caf6e5e9914cb0801787a3d80b144a5c59f4746f3ca5ce713b3bed177a870fea30fdfb4e14e110b3e14e65d3a6cc7dc794f76a5bc7b645ef2e57a4b7df5687eef8dae99a92d6d19f582bb771527031a270e7bd4b3c04790ddc3cf1f4d9009cce2f6c7f3c988d7d1413776f7c710d40f1d2dc5acc772e836533d5ffe03e244373fe746558ab90e4c926f6302381bfe2c5efd2a6d3c59ddb57161bff66f79641352ad0c8afcba2f8057fb1d9c699844ec7998410016e08a44533b03349352fc8fbbfffab2fa24860a8955b1a1d06753728a6e64e92dc4846f53724e4b039f29ef826a27e87f3f1e68e15c38d058febfd57f3be0a158a738e1d91fb698876097e21e02523424ef0dd265511efbaddc95adef76d4b74dc98c85736abe931d649621f1dab9d7a761a6888279341fd2e57e02ff29a5b1f6f58333b60ba9db35f648a086ddfcf78537ee83bccd026e42666b0d8776c8c33c6dc3ded6e70960037cddc3854edf38089b0c466acd75afd2325f01f480236e50bb198b3b7f31c962b341aea9eb2f3448bebdfa308078bcc5ed0facbcf76a0113aba6a363739c20d2ee1ad3575a21827ca4cbebca7456416622e13acc4c6e2fda6b4a80e096d55a6e52e940811e477098b1aa2d9f1586106ab124e632cf112d36b0c3c468fc6ee8cc5a63a0fd44771b33766672db8f1cd021fbe8e7b9ef5edd7409280532550463b936b47065ec77bb320ea2e69c6e43212aeb46ccece23852333dcea5af0d332b077579a85d9d1e3630018b50da46a1104ae982a7f79415fdd3d19f588aeaf8bf709ed0d05d63126122f87ed6c37559d58925ea72108314a7f90ed862c35a84cc0a1080034dbfd2c04f1f9d0d482b374407c00ce3a9e2fd31cc1edbb4d3e09334bf09eac8c314b1e7e01a1df9d434cda3028fa6719ccff2989093521099538e8cf0a7f48de3fe036cae1f54b8bdf4dd5f2c7b8a48558224e3394af61dec83636c5f94dad747119310ff92f215d98096013256a3a1411db8a92452f79723c35d62c29fe91d70db4a6051a49ea014f9d9579874ad5825120a5edf4fc5b88ed2a795e88f058e01e21e1bfc5c41d9758e2bdedefef0079843f759190c1abebccbf3777dbfb746b9e785fb84f9d6eb9d729fa3defd0623a93a3ae347728badbb096ef8b51fa46de20a08b35f54fdd6d8358dbbbd51ac80c018ced558bfa9a5cf4a6c5aa1e1bbc0b965b8041bbeb795a927f82cdd9f5ebde1ff782b4a125047835015d8bf8bfd480ebb5f8f348cf0c75213a88369880669b656be4ed11a6e23fdb26bce0d5923532ffd17be1329ea57e4850c48668adf537f197899d1eac7718af3b30b9cd75944d34aac727556931eb9a0bc08b43eef49916b19d3e9bde5c23bf134fb030ae659975f3ddb2fa417ccedea47d855a4ec08d9f8e8838e3078095c6737600eeac58ee8f70aaf3576b3ba986bd010d2fa195eb3dd9af50d53978f335e142e1d8ac5a21862841afca0d5fabe797b806147748b337cf4d924c6c04f6c5e6b8f409241c22be4c75d33f3648792f8a635493113711015f96186deda3c9244dbf9d7144a33d38d9612d23e564b1b88727e3f53d39a39d6568d59959ef2ca401cbc3f3e09eddf03accbbb917225556bd93c13fe960132462c06f9df9a28ce57aed5bcd648754e79deb089721454415ed265866976c714b4d3ed29784338d2c486efc60cb979671a1c78d594efd9d32aff17bec21af61c7d730f34299d11d4f1c61bb27ca8485440913ca47227b816de84f9067625e83b0f34a53a8f29e882ec44fa89cbea47944022ded5075d49a1f08cc51fe66d30386a4c1ca9a56439e6eca0e090c36133fbfff7b96b5791a13b9ca8316894d2115c0553faf3ab843ff46a58eb1485aa89c89bc69e99af5d10af1ad9b1589552020c088501f7a5a0a587c42d1efab2b7af24495379cc01cde9aa1a712fd47589aa64c9b6fe96bf01f62320c8956af834730208bd9454b379c642231e39c327c1a5adc04d66169e60ef9fdf7e429245dc87182d61daab70d5a6bdcc58bbc78da69817109b1672da34703e9613a2fd4ca9480158d27e6f2aaf6c3279d79515206c98c6ecdc9649da6675a4008d20f0a956ae13e16c1bc28edacb830612144b8f403f2ba3e2e14e74713d2ee5e812934600a3bb9d1c3c3ae6c1ee3e266cceb2aa189d253c938a36cf0bd05f6157a06a04f3154bee454ac038efdc631bfd8a911079a346cfa73fe061fb958a55cf84681db287e590761a04af4fd229e232ba3251634ea19a525d4bbbffec46bca8fc1f49b7e025a160c9f7ee7922c1d8e0e979963a8efea9e9357b5e1fafcd9d4894bd66e936569cd0627365d9ad43a3a1c38a81a21f7a3cf555f3a61fb81c4f6bf1b424d12c2d81c9d55bd5d91e24d37412606a4b1ef4c19a83bda45d118b73147ce9db3f8213d1e5642393ede88e1d43da99f6262174b296a3e70492bd95be0af55edaee17dfe0148579815c28e275b2e730347b1e4c99e77bee052d62d929b2578e7da3e7f378e1bfea00f6847d44afc6aeeabe261114d5e77599c1bcde07d6e2c9c311d50ed935875bc0cc72c7f72e2577599e1d90d9de29da348487228b497dddc3386eca23810ac41ec464d729d8f27006620024639b4f2c88c2aee9a6ae9078cea018e9fc02e128cd404a92df81d60d9bf9d355d62d8a7fde91d65ccbac25bbe7db11e4372bc9559f1db7b68848b6670bcfa12f6e5518dd20d78252dfb354893a8dde1c6edb519aeecaf5c1ad5128cce5ea08a69952ab21ee6230143a9422c42daa861dda78e3544ce09a42bed2326662d2c38ffb5f283439a4484536f04305fa611ecd5843cba702b82262960f14e1669dc365f74eaceade08370a987873ea6876a139ce03428469ed8aed541749c228baa5a8738bba204238e8bec4ab1ed9a5d4559b3417f9802dbf232361185b3a0bb2efe257c506e3329f54f2d5b574341cdfbc4319a6229b613af4184cf494c50746cc55f584ca0e3257ecd311d604f58f85b32ed98099fbbb8266fde156e3e038a34c9c475b748e86e161d979839c43398a8d62c295283ed7ea0a7bbde1ae53b4449074efd902f41746eddf04172451b7f18827b07f89f178ad5ba6d753e94310b03b828458e74171fe7da1150cb41b06ce518df3af952ec4fa06b96d21799f05312afd7d97d79dd8737e40ac082331cf0a587fcaf8df5a1f269071d003baa5efafc7718aab0bc2cb2b2d89473c5cc172f8a1ef9b16fd0436b994fa0937c9d9288116b59aa45e63ad4b52ddff5020002e7d82e9d226b7d0fb6b26d6a3a583af39aad94b6d4910daecd2c231faa81b396dc4080f220784c7aeda906c6519cdf6dfb4328b94441d0a328956aa978ed51ace659a72c58c7e819b166cd0dded3ce162cffb86b2da03a1ce11ea6f83cfafb878b4eb2dab9318f4915a81384fcbb1318ff73e65dd5a4447e54c59b19036c797b92dbaab981052905b15842b3ab89cf5b0ce4a51e4c8a2a6f55de654625eeda99437cb26873ea236f63733c3bd26088347321c5600b26e0c721689e16697e44fa425b2dc7c20f40825d3554934f2c57ccdddd9d8f0c819cc8c75432fc38986b7846227c0f0595406e1c0fdfe062a854adafaeb557ab636a0933e9036af0853e90adc54d40f975af51d317dc5e44f0016dde8c29641aecc95bb867ecd89dde484b2f065ee1b07771161dd0f3527506748522f538d25984d954a8ebf4fe6ee94e6e72f47346804d9ddcf87a869fc4e55db34c8f074337503ce79c01fb96ca8148007a481f01937bf68e4b8e85dcd31e7cc5bb9855b9dfc475eec14a8e50e55e3085d1880d281b5600fe7cd08682d834db6edb3d7a0762523c36d16f7a6c1eda3b7b8dfc842d7a08d813d13f75c07e461d139c830277fbf3516535a94c9ce6cd601a15fe62850ae6dc855a37a691eb96574e355922524d336f8aeca5b3921dac35d37f33a5040f4fc7f0f64d11769db17fb42fa0f336660a4954d49fc9ef5de976da0c477a6a04c653a6a73a1b2dcbf43e8064bb2a703262ad8373c2d1695c93a540e86602ca17df011392b863154d5fd5490a9d58892b0a190d607b03c00b753fd9792e2efa51da2b39a39c1f50efc4059f52cb08239e7e19890da1666da89d43057b6874ea1535b36ae56592a6de4ed554e1f5e40f69fb05454b2d1d0313cfa637f61d9c33c011d59ca2d5957533799dc8c76ad42f4efaccab752c3fd72541f31fe3b4c2c1aee19554bd543036a080c279515778ec9791e45e65e6b2c85280ad1fee20d9bc54bf0231aad3c73ac35ebceae8bc48452b5af325c4001d35b251ec02ba7a4c79c9ac02c19053ff828a36653056276300a6eeb20301352f907d768558937a1e5d3ca6df52cff8de36dd0762071b3ce5aec6fb19697481f5f70cc496379e84ebdaa565d25c87278e0b695ca41634fae107d8ea06645ee0c7cce142e4ae81c0ac80e63e4d1b6a69c4ac78c193c8afc8beda79bf4dc05a11d2f768b8f034fbc45c465c464d1ae749c0815e7cdd253386111ca47bca3beb221e3721d7f0ce0e114eaa1221ef8ff05f0ea2e53bbf1c8fc06fadbd0b4c11068c9503811d4f9d066005cd993d7b1dfe75bac1781776bc26506a3d0fb8130d4bf7a6c51eec348403e053e0d0fc114b55d5b5b4669b97d328f09978d0a1a0da5e60137d5e46973c86b9d39d38e10454b5fcff37cca2ba13d17d7a5e5a0465d283f89435dcfb11d2a62ea22a9a1119b7e2c29bc04aaeb006f2004485b279846e154350fae14fa3c171f3c663c3b6b1fd148516d79ca5b8606c8d49a3f3f8a6216098113c1871aa1163f2201ccf9a59d5755855340607ef08b8afdabdd99564ac4ac25bbf9e28810c4c87f696af1f47975f4b4464096be722b50d7a65de5352acc5e82fbc5d6beaa306b2096e9c2b331a1b76874cda22699f7f28d728289742c1158d2a03847581f3ed23a619e0006f9813435e1d70d1633de20c56ba0027414550d37fc7deac508e3bc0ad502faca37a5f80cb66bc0d6fcbcc26c90bb02fa979b1e112b84712e0a07a2c0151df09d184eb846a8f1b82a80a30de311c336d75e2c032cfaf41b4cb9c9f8db44342b0dbf47384762a608b176c06ec8f9f3bef61fa6c1dde5d6c87f2cf63cbe979881e3932d7fb773f03d84505017b99788ba524f68141199a7e456dbc6e91d33b7854ed2044c3ea3405345e111436e521714d2b2f2eff17c0b84823132412b1a2bfce4469f8b6ce649826090058b57db8a0ae5fb8184e5348c0507caa1d9bd55600315b7615d4e4ef589fa35a5544ea335c61ad073cab7a5799b57c7d5796bf9b3e4e40e4877bcf63e98881d7730491e4fe3f1d0118f5c561dfe52d63200349a1b0ff6a27d436ef18ff69c79a600e0940d095a50723b0ca21b420c17117e6893ef20cc95d84b26405f55ed325c1fe0898f9e60abbc5ca9bb5f5b6beb192cd5327e0c5d5be732b8415ceb94b1d50a27a8ba7f767a47e4f828d0f1caab50e42c7e3dc95d9592e7d974bae6673ae1d16d4b602a530f2d509b222e1c69aa910cdd46de5cc3d50afd179a98b8977bdf2efc37959d6095bf4ae1419f70f7512a59efce7df63314fc2934c6d1ae28d742a28c5c6fffc4780a697f94c43fae86ddaad246b428191dc2ad635c33e2cc30da353083846529c1c14c4c288ab844fc1dc96a16861506f1bbbc10b8d7a400a25567dc2e01a2a92617d83da9a8d0b633e4a7c4a24d92204145ee54397cef9b0aab3d2a758af23c852348d3d7687ca4f83749fbe1084befb514806627f93617ae39d1158e98e6302f88d6b5024cfd37b77498a62dd22c12ca24c9c4208a1c9c4fec851249c018eefde0c3ea06c8797ccc3884ac0f715be212584da83df9dd07567b2a6cc76c4f61ffb270fbd818d3598e4af099b143439edf3ec7dabac499ecfc09dd150dcbe257a140f58815fdae164ad3c702a560e19b311e75bb83f284ee58c7a205018f16607b5a71399d43fd5902baa93c533f7276e8cfb85e37d739af1e4069d1e7560fbd84b6e07abae03f998712d3a53f2df3005b4f8c814c5d309ae01d338586b70d872150f6edfc94f0729df76217f6689cce11a8bf119f93353432f363b42399557c7fee500860d629711681648611646b307f8bac9a8c4c9a80956949826ac3ac096211f60b9c7a2d8f2a5a6536931faa9c303f572248d99d1828fcb10729888430e69c00ad432a7d30aa47849408d89213ecdba7b70df975dce41d21284c2a899538ac2607dc212600218b0e8c00ba09588a380347662f90ecf7c9aab7265992dc5a5b488ef19c7926b2957de7ee88d163974022de6ed1c40d98f59ba8998e8478d7a189255a92bd4da0ba3442f484ecd54c81a7592d7af2fa27177583dc07d2bad8ba666ba8d30e3f5b4413ffb12a65243051ba7867d5583f194e9118e82e9a9871e8be78f70c1e508f78a5fe161b12ce8fc5a91191ebef81f57c8a3e4d078df6f336d0aa2e55d1a33ea50a825d722485c233153a18a50238a1fbe0a4af9119a08f55089cca9f2bddbb0f2ebcbf4eed9814c0fe263a20a7f9a653e7988096d19ca0cdcf2b59fb5644440def7eefca994631ebbd0beac773cbffc0eb74a03829689a9a5aae9791fd844b0b42e2ca83f28889f4827ba4b8c6e1996b36dc8c5acfa17e6b1edc05973c9885d244aedc151881f19046cb23141d2423dfe7f59a8c2f068c005fa2a31a9ff4d1fe581c184d2f258e1f14f977cf637f767341c8c33d7afe3dea5239eb9724344386b5136f47cd43b4f0373ab3237028993d505b","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"ab2beec4f19cdcf7b5c909265e03bcab"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
