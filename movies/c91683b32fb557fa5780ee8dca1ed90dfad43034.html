<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"fbf0308df84ee76efefb825d1a05b0b7ee1773e9f4a0d61d37cf658de68293f25f02ec5dcba915db291cb8a6145fd683c323195ce58c9578111712fc9b78c7d8a8b19feff3376e4bf7ed8ea8d7261f14bf80311f711bf24895ddd88097f55c508f5f76b9472182ae42e4cad70b62fff38419d532a0cd8c8750cabfa1f6262ed1e9905103a377e6152e8af3622296eb06c7b71d56fe26942be6eee2537a50b04ddb53e3149437f0ec07580310b028fcb98850db48bcf950b21b59d1266ec0a4f2c56482ce04518a197adc59203ca0096faa56e4535c10bdd7b1e7879842288e36444bff2e15579fb21b537440987bb22c5e9f1a8fece3382fc5704dc2d171ef1dcc114036b0a19c69a02e6348c878e9c67d8b4584949f1ed3aeb62b6a583f575f862ac7c2fc6f839e0654952539806e16c1c104e2b9599239acf9f1734b655597fd8e5ab33325526fe99ad56007f7f227484adb1d705413c3ec9761ec5471f1343b46d81b17bdc638d040fced1e525e9cb2e6290fd1b2c45685c2640672e192b7fe67dcc16a7347778264259c43de12428449d294f7150079688600246d23f5553ee13afb6493a1f2e8ce0b09d3df0acfc91ddea977a53d46fd1c6ee2681b4f3d9b7cdfdb73ed5b2b13d16327aa0b49a601137a01a48b8c49e89c278665635d1a857ecb0f7245435390efd0152c6d1aa75c4d31dc556485a1a03581fc132d111eebd910fc44970134199282cfd004ca08f351a3ca077abcb228cd916d07e9b34213af37b557296dbe5d18c87201849ee7bd5fdbe4add392210b3db720c5e7c21bf7d07986b8315c8dea5405ba130642710ad966594f71359bb0e7cddd205a4fc0859992a195a063432d2308d65b91778d56d019bf499e59f2eb63b23dd0645b758f61b40c0500fd32f9a37c163d832e66aadd4de43a3963156b8300114739f86451d2e71277ec29146cf8b2420a6ea254ffbe30e9709eeccbeb02a732341151221c133a08c3d367c9b589e53ffe91550c7292f5216171ff11f27b51993eb49ebd97cb2552b2ba9eebc1689e35c486e78bd1ee6b48fbe5008b3c2f4f7b7c35f256b7cf0500338c12a45222e014aee1b6fc2440a2e92c30c5741c763e5840b17651c17621f3dd1644017229f2eed4fcdd44c98f2537b8b3cb5758063aa051ad67808b82f521cdc00336085bef1069f085cf52a580cac7538da5593762fbe36adff8293e85a77bf82c4fd9971a68f27e44db50a2d057b80df2c73c7be255a11603cb49a756bb5bbab5954193bf92693cb0637b2198e336f195f9df08c16b88eb2f5d429199dba5e984e5ad5cb85da6cbc3fcef3edde64d028fddc13f72db4513fcf4b65c6a0e5bb196cc03a52b365958577a6d0f505e2b5ac4edd4510bd395065cf146c9eadd6314c417fe3283357f11466ad4870f5ac26a774f1c45424263c89107ab066f0cf631bfd94400c275cdf63751ca57f4a54dd57579a8f16d4a84f1c5aa84cd095e13a8b26acfcb1a9748ce31c8a03e769d703730b27048e5bc4b89023d027ee04666a95e3c3340c2408c2c9faabaf8f7745e7dcfce762e4713609fc2a968a91d76832695fbf855c7fde01cc5e113239ffe8a4909172f0e05efc35e36ec5148bdbd2acbf67a8acb00e3a63e3aac9e0d15909fad6b3dad8d2e20aa4339a8528d8134906db6f018fcdea04b4cb99116f200da49e0a5c82eb10c29db809a02804851343c0db1441f8615046ae308ce2a938347f041a6815d14a7c605337f6b2da3d3e6354a74435c60a139afba34795331e3887ace2ed3fbcd533c149b921f69ab43324dea94f684883e1edbd963f175b35c986cf4450aac077d85aa251f44ec4aac0e4507ee443090b3704589cd3c82434832eb8b44990486e8b016e54cad2cccc94aca2d50ebdbd338e8e14ed06f6e41a2baf0f7a84bbe18c25479be69e9b3c1cc2b1b23da0ec01d44f52bc4897cc9222495c96657ddf7e776995647513e138377fbd50d7f8173da5e161502a3a7af5c59a672908da90d70e9e80e07b625aea34c964ef17fc2e75bec407d7e5a93ab50f325ee817991a63da9ef044e7c41ef4b0c0d5d8549d1773b1dd895a0c028347fd63779d8d6e145d1c63b1bd54efc0bf67857f35a0e63b4f44b9f4e9f6471542e47d767c1e765813a67798033b422421279dad485d2fc409139c8592d071db0579461f9562b2af113dde5a46c6e543beadf6dec651a44387edd38b49e623d147fcec86f887944835592a4f888204016b2d88cf7a098aa5d6d215d11902e31cd40afc3392c8a31f12560e1c307e5366a6457f017c678060b640072fda3e9e2a19b66958d9b66f6dcc782f3f576adfb166fdb2c2bb493553f13b796ba4c2ec9efb653cc150754323b4abe26b23aa8eb486ccb6ec6eaaf892e11fd3009ef09be462e387a8d41ec3cc6dbbc192f1a8fcc36cd9b33805d1b60c1fdaf01b0c8dbef874a0f52dacf9e3f77159b275633ac99b6c161f59b61f5e76fa3b098d599493636a02eaccffb523ed5e9f277728287d98fa4e3f80f69f8a1543fa0bf41a1c74b3902ccd748325c1d42909bc91ba906c82f7846d0e9e75ae3b03200a971e6cbd970fd4fdf4d183dff1840e454cca8dffcfb1c5557a7f0aff579e6657079b5d103a7e84db07d83aebc1fdcebe6654f461c420e2cb1af4e61958ba33c1a026cda708a4341223397afe216d7b56a52bb7072a8e1249e1be4af47d58091759f4cbc0822ff98ef823047d76d52c74037f8fd938dec03a9ae950065828407a076e8727db5cb3fda81563718bde66dbd8b36c5569e0d02fc7163998c5b032d31d61afa0433c42094ee88c223b0c1528bc034904f542239026364ea611b3e6540e47fa5bbfcf06b7f809d938493a337f380e3e0c8e9c8680357df25802bc123c2877c066463454423e6a1f6f3949c00d804dd4785340faf35cfb87f3878f5c71cfd0c4bf03fdfea531c8e47e81229c7f2244863d9c918d2d23aad5323bfa4a64a0a98789b78441e9adb75f6e5d291cedef3d3ceba014cc78982087ac17d85d61dfe54c60e265edc6264b1968a2124294fb61770384ac9389f7a3a099b32ac75d6f4849411e1115a97b4e3b603d0081e7554e89a8d583a53654ae887d851679c1b0519f35656dbb4dc32f6173328e5eb56f5207abaafeb7e89f854ec8914b56eb508c355b4d9eab6edae94cdf569e688f7a531186a9ef8639cb997c732516b5fd85fc86f21806a94ac9771fef67bfc3f06ffb46090d51497adda7d33bff49aa021c5b51f22324a755c8e0e66d6403e120e0ce4ead05a75c1e8cd25225624f2bfcadc7e7be448d5879fa21e4d85f4f1e6aa28460daf661de8ea8675109fa075660c5529d7064757311b6053a9fb0adaafd20741214cfae42a935c720d9fd313896cf279b5920b6d9114609022d39848f04142abb2ca60c885d88adc8206fcad636d15f317d03d08fdef369604396ae04da41d8c8ae5daf3ef422ed7a8b53a5420080941b518b3b6c5eb5d37cf4c6c41fadff3cdd8262d2aae11c1898d5a5dff66e765bae1f26dc06744a4528ce7501a4c66fc3be266872f4a203a350c02c11d7ee740c3051ab85650cb2dbe156b8a39aa91ca39d530132c3b5040f38add573e41c2a985e1b7cd958994925268fc862652dcb1a1af50b33ab7d2bee6f3e74104683404637fdcee0389e5827f661b3f2e6bf99b94395948c897b6b870b0b5c649d45498ffc49f28fba597a7fb7b3defd3001b3846171f226e3368cc7fa066be31a47752aadb65ce6fa22cd5b35faf9bf91fdc0a0daeef33f3700900829b0e18ca0b99c9789a4b51e3ea05eb0f80e543e504c8bb71e65282856ce0dd1ad42f8f63dd6be197469453cc2e4852a7e8f9765ccc3da1bc67811f313b24e184c5e9a4be913acf7b3d13e5c6fe53707248da275e611fe88ef2c6517533486e1ea1babc358e130726f1d01c392e15bd24268b4ec9d29e46c81944dee8c8ca6affb02943822c68536b483a1c3875812b40b59ff2cff8c2145ee2e660904063ae90dedc499909c05c188f166d11eab28fddab21459c86711c4c03c1dd7dd6b5ae79f50ba9d2801f48217dec8b0859b4c664f17d61e8b0a9b3cbaa7407ac064a37c19bbedf636dc23d863e6662ce32ea79c28508df38bf31d4b90eae3c8249a6cfcb87b24a0f586022ebfaffb8b616cd3b9a8db5e4f52fda77c0d4287c43976d68dd4d63d31d725c6ef9810625823309dfd4c3ffc5b336af9598d9daeec35b2b4ae56615fcc8ded03a34017428f3e69aff6228bfdd30bbcc54b4c1671ff3df99226acf64ff4548222b444164d794c0cfd53d52d34659b3e7d0b5620a5de219aada01f8d068e19091e51a12959394744d2eed808cad3cdf9227ae7e3c23f4a9e1fa6e898024e915df3ec6fd374acb2b36ff5266063a9c7316e4a71d7f78521a6a54c12a9201cbd711cfc803e45efb65e790ff9652283b7cda8f08ddc384a5a0bc047f6c68618ccad1a769a7e6ecf68bcb8f95b897550bd1de35b2393b015a0a0fe2be5ae33b0c9d6fcbf39079efa80fef76559549b29ebf932974096943f73ae6ec3a75009e681f896a11a77fc7b619d00ec7b9eba2980c82db3dc8f82b868993ee7ee0d87c8c599a887f588a4dd5c0a45764d3d6bf565ffeb83976ec49b9ce48ba3418b7d860f43ea5f1f5d219da256dcd2a1d999ed7be24134af8b38b583227524529eb2c9caf68603c4416e2d3d85cdbdbff1924b16785d063ec3572eac00a73c1ac91bbcc6aed2e8fee8ad1b0484d1add76f8444e514497a2d68ee359d8efc71d84235e078fd5010bb9a08bfa4abf1879d525b68d1ef423e7cfe47b0a0e049f1d73a250faa1f28b1d3aea577d99d27e9cc8dbdf4fc2b841ce31760f98085f9ec12ecf7a5442be4d6730c71db8db37a3f96d3acf3b74169df8d7089350305bfce94fa7264ecc27afb1c2ba6d97d307f3fd9221f83298e67891f6b7427b5154fbee18e6e89ec4dbd350ef995f17cd2c52a85a030f10734979e00ed42d8b2bc2ed154e96f572ec6b6149ecb693b3b167bd8e8c13299c6070f301256a21d9130f03a3d6e6393e99eebf12a4ceb6b1ce9a24d52402fe80d6122754668af2e34d77c869e6c985bc864a5cd14f09840983fb2678545e8bba21a4b167b3bab8c1488a0128b04e8f7d82f2340c7b9150ab506ac970e095f387584404203f00393879de211d95d09f3488b08f64a2e167b813ad727e9c2f20d99f64c0216678695d1c4e9ca8d42a003fdbe15baa1d10685106775b1b5b659886d9a7cc58fa31975335cef750f56c1b22b0d8b18680891fb2035b90540fd5c0f81cf261ff762e62ebc14fdf3f14a513835081d8f336da29e67beb4701d80405374e74f2436bceed3c95c9d56afa63d1657fc0dfc51c3a39c5de9899da731efaade90d77cd246561fc583bfad4486c0880a453a3f338f1fe133de1c51e8693c4489d949ac59afee227d13480ce5c3c3e97a67048838b45d0afb16fb450231f272bc37c1a4abe32b23d824bdf48a0534966a14d2eb95ef66dbbcd148e7d886a1f64ec5bec027819c3f2a8cb5a4e8d31ff5132b8dda548c30defb595413f3d83ad454020ce50583b71a3ee1fd0ee093a1e0d40220299ffe3e673d761144a4a8babc6f9b32c18c45c945948eebbb391d7aaa13d6f63db730e4fad8b25708f3f2f53b5a69ad3f02dd869215b99f55040f61229f909c4242753e6f616d4d3d32abd4db26a0d440e5a866036356cfc3eadeb6ac53f71eecbceeb0cb6454ec9b0e0e6ca153187b6dccd3c0dcc59b59c4c4f5316f4bd0ac08671dd2bdcfc940ecbee1414a668bf874d8b82826eb46e8ac1a0d155aba7d7106a451d86e86cb73c1e2d59717dc1747185d85472a8fd05ce0bad52dc64f6e299b0b3f1816d384c2469b533f80fcd027e2298e205226c00e16a686e2a39438b9ee294edb086dbc55082d117426231362dfbc9da5634412cb059464be8d4b87491f4c7216db6981206d4e1c30b7c524ea7ca71f26a162a25a76cca194b8ee2312d96af9311f16932ae0af7001c7aad16ea4b8237dd9b53ae3b3208e9263eb330c91e1a4a4e7e559271fa58bbf1e33290d351980163bb25999b477ba5c2718587fce4e7c34db53e6c8ee584acb8435c9082d53af323b89ae0aa858312a4bdf0984336e02bfe395154747c8e2593dab47d1b7ebdf1fce409c6dcda0fde33cd6ab739b007c51ac1a9861e4afa1215b1a9b639454c80d5f81d4b08c1acbfd5c14f3799a9e87d6a94e0436a9997e7c7b55641c9f06264b2f909e4a685eb7fb23020b7c71625bd541f12075f1df1289ed2802b690fc746b1600abe503849674ece4e5a6cf18af74a08da37d38419d12130f62c683a6e7b0eb4c62f9ee9132aa56a28666c4ca9ec2cc01451defba53be0dfda22e2ed7dda057377c0fba6bcf57729ae8f5a10b8dcbccf0aa64c2905c4f91574572dc49053c05ce7cc624c0b3b74ee4581607c44f06b6b397bae93338dbfc09e40c73e0691bd59e8b0810a5359eac383ad01ee79101ba69ac7722faaa9a90d3b936b966af3a2cfd276bb1243a4a3e4108d3d770ffe5d7876ee36a12291efaa89cbb9974e1bc060ba900a568f542035a859270347d88b0c08d4ea40c11e528fe4c4f3a9cac408408f3cf7ab0c6693f9882d97ebab17a180b6a270b7d55a5d693831c631d1fa71aef4f26528982162e8060ab0f5b8bfacae58f4c63fe6abe5df0b2bff9cac4a2c5bae73085ea488ba047baee85cc04cf1cb8bc753a9fa5327d5d8fd31cc352fbb941975299e956f212231f6c71ff6b9e337a196c993a069b369cda4f1e84863e19d30813a48d2967c6dac0412affe703724984d548007cdc7a3adef8b8bcd765c2cb135fb0029bba21ed90249d309dfd304fed91d0b9df8b91b4d4afc0b9047337edf98a61d60d9bc0c4f0f8f3742de3518cc0c50027ff7bf957b6ff84931ed1a31581571d587c88b8023616268df2171e97ca9b632c42cc39404460195a03ea962a305eb9024b8ca0d32a57c44736ac44c5901ca130c4e4290b2b89045f636fea1c5e9dbda55b33dff5dce5a0f0d4d5d7192834e4fd6a2be509789838dc0831166adb4c06f889fdbc05fa319f020e882c0812462cabd157ba6836c5385506cf89a510b9bdc619b9350ae0114cfcaf38514b5a7a1ec2162ecbc03544dfe966cfa95cd6128d9445ed709c2293a2f9d53c1bca426ccfd02951930b7e528ec8b0bd26855640c2997ac508e87f82034d1cf7e9f1e9c586088ae83c3ab03f5b7d6801842dbbdd725d046f4e34384c757a97933402704704931f7796a02c8c2406ab32582f2eefb1ff307df47d9b3bda5d4bf197ae6bd834787b61910ee48ee1dd8a0c890ffc20eb3ce3c97a3cfe626077afa791082216a2b3d3ec4ae69722efad124c2f14f4a44a2e522325650506a018a47f62aea3ec25e78c2780e8e0e665f00edeebede4bf7ec750e8c9fe5840e2e699f21847db2c92dd1abc5ac2c524d690f04dab15c05f78387967fe5c0bd19efc42800d0cb69305a4bdf54ad5b2772024d00da809c91f14fd5bdbb1619a03cf81df252fab3950bec6271d71d06129923369596a0c1ec7f9bb6016ae4528311e07cec851297ebbdb1f5c598e3ed851b6f94e1615a8707861ce4df27297e81735047a3d7886316243f7cdd2c645bf94794f5a07ff177b78c987e12b183c851cc1473ae8bbb1ac3e288fcb109a7424eb52d9a564a1649572d66b9a7c7b0c2cb7ae5bcc38fc73021969c711545c6f97f88a162906e85c179b678c015669bfdcf180073d06b0e392341e8c1b1ea35b75806b0a2ffb784020c03d796c1538794a0d3beb6afad4a1b263abcbb085c86568758877f5e1af04017c6b76744341f36e1c67bd7feee3699ec821928320363e3781375118969d1420e71549255b7373044dc4332507c867cc31e40a0a42f1ab849746fa53e2ca0f71c1c7342dca1a1977459ee8b1018591d6fe8ea9d1e08907c4ab19a9bd0ec29f876df5c8002daab674e410b5f9e70f26e50844ea2956ea52f96f9954f6a2aa4ef5af3a39441133e408133bae2ea2f4a89241cc3379c719a8eec607c21e1de18ac9d08bb66cf41750ff94052bd2a548caeb936f8a90c43ab05bcd18412eca291de1afc334904a5e2b9e8caade7785bea4039f9d65de272e2dbbfcf64afc1b46ae6eef406dbb54b15f89e0aa4ec3c720e47660837650806660eda9c29e04ad2b74810514d850406bdb06358446d384af2c848432e33597cf797c6d96237c4406e698e6dd2f15b0048c0601f656b63cd9ced0f4aa5b8660ec4ad07d9679e56e5907ba014d59799d7beae87b37bb93a8aeedd48c694a51ea93dd9bbe5488655dd361c2320be952db8c2c12e2a4f7b44c98ee1db3cebcf3d60f50f2cefba01e618474a7b99864bb7a715784a2fd560444c2d155a917cf061a2d0ba4640b81e551ba43529deff80fcef558ed05252162071900de53f51aa78bf75c1a8aafb4eb3106edafc28ec101cbb1df873d166c2170bcd35a948b15e31b2054fa136f58f149af49b40751e09bc7e4caa8f875e72b4caaa4ceb7aa1eacb805921ea511dc310247275de6ff662d63e8e007d54e42c2d9feef119a033c0bccd92f03f169bb08331af7a1242cdfbd11743a58e2eaef4a3b920238c7ad956c5cb837699010b0ea9126951459ea46ef785203a47c6bdeaa4b42c59f09b25933ac7b48ce6cedf05dfd9b344d512b3a4aa8d62e9a74173cbfc2439525e412b226cd7426fb837c375520878656cf75f01c2b0d4ac7257643c330b34b1a14d02ef83bf5b48b70d7bf8d32ec31be367eab1aee41da85fc1196650adbca3492bc86dc96929f159d140a2a494d34575777e0ed959781ab288636f70224771d476294767f7cdd113afdbe48791497dd9d01a4fdd465bd365778a085770b846d507d5db6772f3402e5dad961f44717ab50d99570e617d24d2439106a00fb82c901b95e3a2c750aaa7db37f4b390acb554af7695186ffa336d9398bce62d230bcfc210065cea4fd03cd8fe9881004cf63f3b009e82b58e391e3a0b604a73ef82a555cb3daa9745d9de84088cdc2144d9f28558747f810168ec91074a5c1c5966026bb4e2edf429037b8f8e81d6ee6fb45a675f656081e30f80aad90f49c443a12a79b9f1a75b11d5feb10214e931dff02a5a5a28ace8d462a895312713468f86aabe83a935d15e6ff55be5e17bd494deb532f060b84739ef2db849ca5af748e9e4cb12567699632a438004786f19b95e9e21b7a6015fcec73f55def53c1b51ff2ef68bdb925c56cac5a40a520792af80985a01b86967d04c7e88a93554bb0e506e62a6069f735d0d8b231b7a52fed8162a70100e271866c44c41084f0a0a0e6a56ff4b4cfd2759db775b180f499715511aa578231f40e925cb61419fe9369bd069b7da38d3c5ff49478c094ffe3556ccefa960ba0f8407ef35510b3cbb872e49d0ffb605266bc83e19bf1a4ebc1d9bfaa026d6e1674c83e02f0ec86576e5087a1e6f1bf8fe46d5eb4d9b0cc2ad0f2a48569be574d2c51410e4e66baa9b6db1acc454d9397e3b731eb26266afe4edc24beb58e36b79bbbfa5716ca1ddf85698b6fec1b05ddb95f6e32a57277b8220743b6225ae4582cf3f5a8f63d867f9ef7d0d1918aa569570e9c9833c3d5684927ddf8186e4171c362638928b099750853bf2dd9f76848488f7d0f970a6e6579841a211318ee0eb1d1be9280505e310d1cf0968838703af2f66fa99deda31bdea801c9f60e460d75b6de37492f582c86aa3d860f5204577f35dc950e829ba770faa796eed80bd7d4cfe527d4e2ae1d0a7ce83c20bd164fc17b9111167bd58e857c32cf8d4d4eade11988082187d69e0e2e06f395d400c697633dd88ebc1954fa71bcd0e5c4f64cbe351fc5e99fa516666f59671f04061657f41c3eec82223fe3db325dfbc2c954d962a9640f546e7c4a4c096b8a93a4fc3660c50afc83183c3aa1d3ff00f2ebd9e08c2edfeb3496fa5d096e37a36651ed80b018413f0fd3925a3d0897c87928e3179c451010f4fa34fab98a32d339125a5b98d3ffde9bca8057b7e00cbb392d20396f868e1d137a491f3c3283b7dafdabfb829ad8c2a573efedf247dd4fb685c7b3b07787b1e55a87421a6471d5c89a7abb015c21c99e5b0005faa89293105b7ac9fe0a551c90013ee32e2309f11be19aa5d24d32e5dc6da88d7f3847d94e2bac621b1458faf2b49ebd6026561b41915ff4de1c228069246582963cdd8ba2682f8588e8e2caa7aef0f8e74b7412b7805c5800bbf8854ac57395e2126a2109e7b05d1d460915c98c63e70cb89efbd291c1939fda3e67a3dd546a40dc50804287867d252b0dc40a70b80a53212a69774912440f14935d1749287d51a5d2a0e3d8353b964e6e81c5b38b4fd50179090c82978a9f1b9996279b7dfef29cf69f8f76573c7c4c8073ae7a061f149992c8545a92ad626136966d1b60b7e0afe65a9717c082d3557ff538d088b157cd779d255e12d983bd5a7ba25f0e96b998bb73218ce4daf725b0329a21588c688f3b0441c76443dc50a36d1031337559914743339773f797c14a93aac37b159c3ea7147675feae542b1b4852a2b4df68a889e4f0b16675284959787e5de6cca41c6aad526011f5e5f793a19e1494e2e3e388b5bdc0091b396aeafe14148b78b57ca1568efc304315327a06dbbad835c86244e6f8fd6401a20eef9450e12b03859fe94d4bbd6a7b23ed99f12b6483e70ec4dcd19f3192b4fd917afac023e0e6fe16ef97adb9c30db31d1a1f7b76f6420400fc0acd5b4d909830432536111f8e7f06b7cb46e1be48431a92fd16040ac5bd94467bcff71bd7d39773c0af06c448427c8930ca0fe1d01512fec14c0d9fa3c0bfba0bd22b5839f7a6bded3d2a3a3b61a5fb7262c126ae921bf78b505a0e1426a6e369334328ba463c6901013d0486e436125f4d009fd6c7121ce34c1be3a996f85022c23facc60603d10161e156aa2a924202115edd09a5644e5ee83069e9d1f826132d3ed49cd478a8ce1754617f4f26647fa1e9bbebd9fe1be52d88f45c4dfd01f4c7b2c74a19874c1373bbccc8894aa07686988565e78b40a1da0e2236364b50cec6f09a2b35a3b4c0c1d2471e53e026a82bffb803f94c71209d08c636876c9fa96d5ff1137d1179d03ae3fb6988a15488e1e0e6444d9803fb95f2bd174b76f82fd64099b487b5afe71f563eaf3442ec45deb303a7cce99338327780c7aec5d45944aa77c74ec81e1783448ae02ed3b7f4805f41d9981d7b3875a1850718febd81a5751d816435130418db6c20436277ffbc297925b7ecf4ca609a1217db2c24f47e3b9bb6d47357598b19ed5de6c84eb90ed6c0cca2b7cb78889769d8130f6187de4bc73bdeb8fcb8f6d1b2765bb7173b401428c7d5c91e7bd3e0e07293a9790ddefaca2a99e6f8f934a04d6f1e90daf2c4a660e3045bd6222df68f5eada0867f0c60eced4283c8eccc8e9de5ddc4695182b08e369a2705b5e817d26534f240167451cb7d8831d2d60883439f43de2eea7c47f0139d27153d47dd500b5f9a0c9ecf914cec36426bb54a038e1d848d3f31a0a14d375b58f6aa8006be9e510e492d954a9391238cb9d0d5d17caed8a2bbb94a88b511996b298cf1e810083e937f9d42d2fcec923c2b49d292c68610321a27c44404eebc5578da8ded4e8ed1b7ad2ef6809ab40255a4f0aafb6074f987363efd149656358c030646d807ec630beeabf01ac1903670fba5512826c18678b6b48618991213835eb5c312d8b6b766156a097156b943e7b5ec96f181ece92c106bdc7edb9c4d582a37c04099a479425f545f38fe3e8f98a1d0ea287e3d92181b1b24ce965a23ebbab687e13e92c9c1b95f1ad64c1bc3e2fba81bdf2da2aab5137a570c0202f2d9102c63905de90c1ec2379d3baa6c9938abb6575d72de7038882f1314014b6be60093463225e86d9b7de3a944af6507fb79ae22a80c71f3456fb7d1d5c7a40498bd4b020a5db256b087bd889208b75413bcd58e871bbd5a9c4df2ce08864972e6196dfac36b61f166c255f5ba826a03d24e70367994badc11ce26ae67fedc18e6453457b7ae8e024a1c2952dfac12fa7e042ac223f01c8ed6e675481ac8b58e34e66d5e33f9df66964f74f5e692eda868dd80f8a79c7e67afe1ca1c57f05e74060add92eb55e579d921b41cdc1a53e65bb9ab0b9508328f782b8779dd3e5096723f2217c084655cd74ccce50f003f8299223329ea8be2978c457cc3d436a993d955ee85b0d61fd6290ad05074d43d6133ae27edd96b359e9fd3b223ae9edb9e5fd77e1476a9780769f45d1bec8cdf172187cf3381e5bfc2569c4d072ab407aecae9d61e8a9f01d6a4986329276e7d3bc3df345129cb1a591f9f07d3a6722e5e84d7be6be7dace3a9b4178b32ce435fd1c1fcd7c2800857e424b1e62097485c11eed04c5c0dd49eff4096e18e196e2763ca3815c1931a948c0b71580fb44f320c1f8c975229b3855eb95593fdcb908f82bd39c1e5c76b30139cd8b430c9f49d7e023bb4d37044bb58567292ddfaabeac2a46fc1bc857254d20424ea63f63dd7ab573be972fd87496b93f7305ceaf59e706e1c1d13fa5d27fb84cc723cb811a10a74ca382e4ff0903fd642b0f2a28e4295b0b69c0dcc68fc9c33a0552cc8905c59391efe5ea0a36484993ee00255af63729e972cdc51c6094507b1cffcff5f73309ff693e3c41bc7e1a668a026ea30892f8b12b9c3d1750e9b4cbed44472f1b5d7daaebaad59208eb59fe72f37c1d654b63cdaa26f7b592c5705a31aacd436b2f4625914c04e97a505e5d82c6edb9ec1236858fa044650e63b30db25d69eae21a20d40519fb5755c9e5425bb9208a632ed96fbabe119320809b50dd37f903076b28e4afc549c8555cdb686087954c21ae7608cee72664ed9ff1855019580fb660e48e74152dc4c5753fab9ca5c5aaf381625ccec311fc9a1ef87a3e0177fc6e2525237bc4e1d68c8879cfa8e8ba00edff17ae993c3aebebd6beb18970cf3592859bd6a454d7cbc59836e33795cb7b7ed3b9f813c8de7fc44034e4800b6000f6090698a055e52f3b8309dbc03cb8469b8b2e472d6f8d18f4739c27171b83f8cf2ffd9e30e552f75a56a331ee5328d0bcd255da9505dd3f2b651ed4a9b00de6506095be197842a1c829ea8382a6642179e9c78ad96f5bfd997aa7fca4ba3f4dddb7957cfe2cf7c80f4c6995c28a22961a44b7490e113114228b113ecca0e15d35bad4abfabfd50c4671bf9beef1a52ca4b7197eeb9b1a2e3702792b20e02f2cb353fea0ecd6039d6f87fc33e2e65cc77bc215fef9da752d46153491b48dbc2e22a2149493f7575a5f28e407497129603deb06f87a45a0aeda7f12e4bce4c69637f9345dffd748a50e338feb30c6a2148e16004833c3e4f2e9d30d72d52c8db37f57d5ba2e26641e2c1da71da021c50bb26dc5de5a0700be5776a6548dc3a453ffa9b9e610d5e8960b4586376a1106a484cdf3d6190e498d58cede2a496a0d6842b029936acc847c51a0bc1ff15b92bf66671888c5705926a5cf05d58cedfc7494fb7bb108632aef691100640f574dff360378d6f34647c9d13f6833c8aeb1ddc2dac25843c9c323f83ff47feadda442e77d6599e3539340222cf953156bf88351438cbb57325d316a5be04c13b3e49f66b024b1ccd8488a1d0d1e926b4a5427e7efa3607870913d51c811274104b14a7c0d01fc8e9e6ed0be62cb5fe30323d374127175408ad8e4dc68d1031770d8ed5088e0bc8379b5553e8c898fc40058ec69ed2d81a01bb11ed9d7b0f4bb8e07ab9498a9b4367a9db86eb6b44199833a41ce91f6bef861534990a2af72c8b3f424dfa33855914847df6198f231f8e6d6ae778d1dea91f3a2d6bdc4840b65c275ff32f70380437102158221bdd584184d5fe4cfc6e35d7284507320a50dfa268a16ddf9873d08183e984685cf346ab2b9ea96a3e40ba66b840a0c5a13f12797fe3eab85430b421043d9d8b41a95d76c2d7c986c6cc6dbd85610da59a60753fe046ff6e43c7e8d844f33ed49924742698e92330e73a06d7eb56b8b1e551d951d7a019ce3f2ce54c3b309a25a8f7cbe6a1a7bb3a3edfb76df6cc20a67596e063a661739e37c26028cb29a1111ae1172e3092e4369d7b6b03adf2b219184d6e10b232a9e46ffc8e5eefcf60d59585a75c2932dde91388f761c2bdbcd6a754f840cbdeb5b4f461dbbe306c43f6d3fd0f5db43afc8582d2a984c2c8a4f8c5a01796f0f7fda8169aeaaa915dd76fb117dfa0b58517f3126d3f41f0a2c660b1e4e26408afd9245dda45b207aa7d8f35235d5d195516acb4b95544b5e060b1a3ca9a1b94ebb71a1ebf5d5f87e4a094f6a16ab8d433b0265ce166a72bc67ccb721ba5f484dd6bf37b8c000e26772dd460614cd0ab2ea26f3ad2871de24d4c0da12c045902fc022b1881a7a9c11d01a883322fbed1d6551ae2265a27d7ce60ae867675671066ec2775dcf675f9a3fcf4f19faad4dbcac3b32db5c4e902ecefc0e60aea39f9f59a1757cca057839124482aecdb00a389ad85758a6701810f39c3c79740cc79fe12b6688b2fa84e1a43dba1e440c3ee7507cbc1618174890aebd15a259c3fef0855acb7fe81b36b5f1f9273e0ed9c7f4ec2280c9176a02a173bbec2972f3502c6b529529911e554eebf521efc5e08ed8ece449916a40581298bd275692062d0dda11947ca60de63c180e141e81742e9822b980ec70c13527c8b83505e005f27c26cfb61886bc91757f72942eafa82f9c9014d383dcdc68a1cb3ba2403bd1dd03e0a49929dd4ed7bc8628110be91142c32c24d574439e903c8f0434da2c2bcf19829f72baf18406c2d3d4132b0866ba98804121c3ef9b1ebb7eeb2869abaa42833e5f63193f0dfe6247c3517b9d4410a69d3ddee443cc24ec5c9a9f228787b6502bbc393820b8e4995c3e342bab709358a657167a7b2ceaee053186d5a34073d9d18c04142a2dffb6181dc2c08db0872b3356ed08df918d2bde7430d852fce9d795f2290276611ea2f88dbecc537693c01ea6eaddb8ea557d2ef9250f3bc58621def730e1b6524036b1d7318d38098f4d410d4e59db1f0fb514846e92003b7e6daec5f41c028da7f4c46ffda8ed34357029abf48411c6fcd7b25cfbf3e8dad80e0584eab1436c1211ba88b4547609daeb60142f82ef1d8f985c20857fe801f1afd95048eb48b18a4188f9b324aa1b4cbee1af9ff34c165f66ca99e6718b0a1097b4e4ec4d4c77f46f53cddcc40764e6d2167726594bccea1e18e8c2f09f9d8fbb5aae85cb743785f16f7fb1f449899b17dc6628792ff5b1a84e1f768d1bce37730e4a15169b8e91e95fc1dbd8cbed12b4127382157244058e1a97c56771037b31839db76b79e487914b246e78b5b95b8e01a299c6932021b7a0236451c55a2a533875fff30a0c02732076828d0cad03f4524c9a2f570c874d8db93593369301d5d92618204007117fe39470b34c759f254752674077bdb430c55f8adc9fd3702cedfa7cbe56cd8a304816faec7455bec053a2475b5f0769699fa1d0ad49df2dec23870e26dbf69f2de2b41d3a309cdaafe2b839c84e9f251efba03fd11fbf9ec147ed2d701f51e58828f5b2dd017d92ff6a4b9170d8307f80817b1def6473793b588d2417ef93c6cb9fffb2ad730ba0111fbd31ea8cb05dc0c1c56d03ac526d5d33791e1d1ad49ee6f5ed6c6e06a042b3d0f5ea894255c658e9a889aa67f607a505ec17cc03ddb2656fe2ca6bb95ecdc6461697182b85c8c780febebdaf473e30055ada75540e8b995f4e127375c473267b1fa63fc5498a24c07ad9d075c9de2f7b82fa603c9de74d9d2178b9019c4703b9429764051d8a318cf116221974a834f21bfa281547fed0ed6f95ddf4f1e71244efa1f2a6b411e57c54749143b1c6bfe86d5809ce8cd774d108094fb2f259b222f526988f06cb7112cca287fae6374d6200b59f44c6d3b3c5cdca8f9b6dde0bd20c5ac62c7db666f9397e0b5029b9b40a7b591d1beb3ec53992e5edfb76f46bb1e6cf9da1aa1bd0b3bc11deb378a3ce6550f27cf27efdb630488160c1989e472e3506173411e19e06ca71f1176b905ada00b63a0d4148d6ca34e416f389b2fcd092bb67646865514312d8dfe34d6f7e4f95f8d2ce989fbfe1d3b613472739b7fe08063e9d9416f29fe135d36f7e2ba99bd42028a7a02f4ba31c9a2dee478df6e65f037893b70d6119daebb1c76df72849f92d91af5f903fc64b0bdb92299ab03f7351b98fac66bd115579eccfddc59c182a1ba6bf547be5b72b7f95a25950851762585f85f8715bd605dc243b20d36195b86d77fb4c859b34c371146c10c0553aedb960995f1a5ed78c787fa603715a0ecf46bee7ed660f6b5192d8270352ea3d4dcfc37f0875ac434","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"ab2beec4f19cdcf7b5c909265e03bcab"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
