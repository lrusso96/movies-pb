<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"76d724d2d9e3ca5a7cd17587f1c74a8f5f06e87eb47ce0e40ca292d5aaf0e8e46f67e46fe54fa9105eef3c8386cdbc3f44039acdc76bdb5624ea800bde47dbd23857be3e17e3c1452feb45f963944ef417638ad21f379b1a769875cd42275ca8d05238a72c5d202d2bc0906f214ec4556c98280f2eaf7799c11c9dc78f95cf1cda59ab9fee71802613d1e5c262fa8f66fdbc8b1cb80ee67a11158bdbc448b7bd1d786fb7072719d5d2f3baff1667f59098e8d5b373b3f0c79887501a7499d3dd6c8bd58a4fbffaff5c0b021b64b94b06e4f26bae1cd0de066af7e89d60a0fd6df24fac540899bea2592f13398a3e1d506014da518b160cacba506b6a7ba5d3893fdee2b525e2588f061e5cd4d3ddedaa5ba7d9c20b4e29dfef11c99d17daa8e25cf5055d5d6626d262ba3009747e4b4ca92528ecbf05abfd7ae507b65db412650429b6edcdcdd4d005cd72fb877c2c0c70dbcf63edc68314cbc7ac468b591b843147e711d697d9c394e2ea6753b6b436d82fb9e3b65c9cdb6def9fb0d290e48c382bba9a083f6ce51279cb0375404a480aaeab71a9e2945a412c008531d0f3b52c9917ee9c6cbb668858d972353aa3da2eb0903d79b92373ef97872407e0fa4464aea5f53958b2dcbb0c2a98c73160427269710177925efc613ee075a51babc16e4391838555f412c6b7da5fd7977dc593caa028635ac451bbcbf89658f5f4e1b7f80de35a131d09d36877a677b75d7740f5ed6681633c5a27b4aad3ba6dc9656e44d612407bb1791e307f1df6789116eec263ce26c7c12afcef4b601aed7af9381dd083144dcca89a57aa8c93877191400a0b164df72ace97e862985d98aef96a7a08c2a4c5a924d6c5c678bd08eb49c6b32accf099d570b86e04c11437f8b8fc8bdf103c3db6998c66346b40e04564598fe277a3fda15a86322d805b2cecb31f3291c4270703238b61ef3973b8e17ed07e22ac67c35763511600ab67bb37efb757f2cc942a4abe1fb3a5223ad0f1abd67fe27d535485741d34f4f32b0dca3bd8c8edd4a18305e860ebdb2b368196bf0cd8dd70c7defb74db0d7d812b5140c7e146df63b490d97ebfbf62aa70ef73366936a5ec838abde51f145015429519c251a01465118b41cc181e82b2d255fe0262fe97afdc0eb75caceeee85038cabeaa2f2c7db4b36b17db96b0a2c8c05fbc25d1ee8a8f306941626b39cf61b3d1c4072d2b58d41a2f586e31b3458c88c5614aabc97ac708ad08bdb2c0054d8479bf3566460de00092a1edd5b4e8e0a5059a0a6310cc4b83f24066038fdb04e543fcc4d9f90036d8ffc5127bcc858e41028beba5caeaf17279dbdff52b06f28274dc1171285edd2128242ae751d730c37c293d0d112559455bedea96d0395ca31221b86bb4738138bc133e8a370df30d406955ea9b2d77f4018ec44f3314e02fd964a55cd3ef9803c340f670b4de87cdb65269230bca28a76102dc880423d915ea258d09c596b4b361c06e046c063dce062d64c85b19acf02904a9a505c41007f5f8dd224ed912582345567e63251115cc4c2c4ab3b6fec9e5f358925c945f546d753ae7398e378a02fc97e1c7fe10c4d8734825a2c6aed985e96174267b46d2df426cc9895bd0d70fd9ca57ab2a3166c65fc482dd64c10db572891d2cc0aa7961420ee6c13c438b0e433c57bf0f2fe309e2941b67d5274adfa3dcf69e916522f7205586aaab534a461c72b650a77af89a6495bdfc54f1c349486fe119e66415a5000fcd5601374137a73ade74f6630e529b8b38804693be95afc71db48f14dfd3ee3211c461bffdc6b28315e02eea44752cde66b6a88d11f954ba1ee9e8d7d464331b78b6dbb95352488ff0310e85eaf66e5a15dfa0db691dc1bb7a05b91c81e27c7a4cf7821801c9b94e93906a4041f7487dc419f29681e36584cefeb124b02a1e29d60788f4826cf96bd2ff211cfdd91f19ee52e61a7f7dc5c785b8786f7e4aceb3e410126cf55c557b334f0316192667d48afbb66f2d76b568281543813ced83296d38ddfded02db1bbdba5689fce87290d2adc990afb00eac483958be0fccf4787db25c890bfa415ac341b777ced0ec60f3a856cc672e2e546b4a0adf40afe1043ad448b721635d1b67c63e03f7a102237ff0a5aa7316d124d6cbfbb0c81e2ab820dc965e94b9713a590b735afe94e92245d6449d2e0a8bfa7431f21126a87f37f06a69efc3414f82acf66326157ee3b4a81953d975c7921061eb2d2fb3ff04bf092e4035a6fe33452360292dfaadb667a17de7199749db5248c5ac7cb1f3fcac87773dd5c1b6ea1ffff8266b87972cffa6cf748cd043f1e988ad82ecbf9f522af265075b44718287335771d0057e8319e52a0c44b5d03202d78504ddfe5f5de06d48b2614929c3fc11c7bf4d0c4e58ab399f6b0677a008f217a83b58badef14d2085b4e1db6b97070b5954faa12d5d12c8d63804e9e7260e9151c7476fa541a794135a082e0c582d91b241cda42f81e0f7e093e73e6055a6c0cfd172f6ac774e8aa79c7e9b2a8d57d4efd10ade4cf31da533bc1bfb09f0185813220055af0f746aeac740110bbd9c8a0b628445d80008a4c71729be9d8ba023558a1a1b92859810584f4884b960ced41440d4040fa1674e4168d73c25f4a69e204c95609b5999e377585041624eb7c304877c71ca65475def76c0e40b3f1db86d08c00fa311f7dc454c596f9ca91dd28bed4c29569e51d5fc3cd85f8bb5e4874d5123ae3b7baac48d189ed3666c2d498ea0d2ddfc2875c0200302e2948c0f7851a141ec9f5dc40fe36e5361b85b00201c27a16c136c88d365ffc33bce4c178c93c9cfa180ede2491fe16f625ee50a4e09ab2ea8eab67fc6224b242dbc401091a102814bf70d562ab38408958f3dc34f45902315af0dd4f60a2b4fce79af47076a3857e97263ec9ac5aa96bd3274ae5bfba0de568440b7f068ad07512d040e3184bbe83361a9334889610487fce52efaa200da20666376d497575f6728f5196bb99a4106d0f45e4f3e3167eed713ff2854d5cb4b33c83eeca400c783268ebedaa0697601f845fb5aab9a2cd738b04ebfb89f13c9f7d31e01611b78144a9e7f1abe2e1e3271e66e2844edbf17c5c78158d9afb0961243b8e81bdd89514e0ae331a15ef9f53111da37f6ca5db51eefdf151611853572f82665c1226382ff874e4ba126dd930a64f5f35941bd3c80151a0b584a12d8c54c43c125e5720a4d007924ebb9d68ab0774f0a2c9675dec2024167bf058065c0a197e5f455913c462faf83f66a3e4fd12985346f6237490763659180ac7fd9ccaf846f02f8c4cdb1724b098536a92791594d67ed627c1e7a5e10799142c562e04fdceafafe4041c1094afbf0d8321160ba744300358d94759e83c9e46024f1fbbebbadb0029b6ccc67a0df7e61bb47ddeaec2ece34eff4482338b13e7b4ac43882c197f36d874ed945f417445e38dfcb0e3ea7fd65bf4c8f118017c27885e8ca7f13425d91a4482ea7e4d9ede6eec689d0b4e98dd4671cb32730768cccf587e36f8b06761de2a951ca77495e5eb2f25bba3c7404ef20d96bd5a5cf798fc104f26627fe9859c13c87cd6fd955c5ec6c5ea5397c9d4a53f03679168205b3434c04005c4cb06cf348edda693b50003e489455bad01fd2a453424f554b60d54a5ac61aa53a55f94896ab9df3aeffe5786b6ada29c79e938d2de1d6c9aca15d4ca90ac8326e3e079d115d46110922f98b9a064e2993f58324c9818bc1199f80952fbb3a762af3d68efa3e2a078f95f4feb14c45f717f557588f9010dd83d56d7c2b8dc22184f90afed96214ebde3f06477b07881d9aee83a7941568e76a35342fc8e46fc3e5436dc8f2a3c2902d3617b60d6ed5953b7eab844be86970531972fd075a2f412a9ece6b18e9fe028c1d2b4f3348fce66ec2bbce7bdc93111b4919baf3f33f60587a221ce804f6aefacf50b2e073b3f34ab3ca1d5e9bfc63ee16e4811ddbd34a34da9a3fa02dc168247e4b7a9575718ac429028f0fc8bdb81b0f58847c4da6efdb583d069f6d82f69bcf48b804ca66d33ac89067c863ebcb527ddb2ae3a8ce8dbe45a5f292821356e8aed7d0ca957b4d9b4397e5ee982d217bdad40c5b3277282f7a0799dc11b2c98ebc9879a35fac877b6df4a719ff1dff5c80a6d3b0ae5eb5ea30fc27f9948893e3a47e2ca0489e7244a2c79b61a88b970918e302bf68667b4830eecd8fae61ce10e85dcd482214f7632929cb8b7ecf155f92299a19fca9ebafc13c6e3de637c5be687a9672710459d8ae9dfb918899cf84fcf7ccdef4f8f12137d0703e9373f72b25c1d13fbb1e006bba0db800d88d57d309d754cdd9a4f1962ba097c971e516b0b7a535607ac23626bc5aecfa33bc8036713029efe4169ffca912a5e7023adedaa3e4418b1cf215d4dccd24cfcd8e44f071fc0b6ebd17dcec08883755e4779a26bfb030bc137aef54a34b9293c5fd5c7ccd2aaa411915723ce0eeb2c02964c32483e3b6269004e107ba535b0370403eedf450019cf6b4617c626fa6344e8321f993cf50b4c2629bd5ca688897dd5f5fa50362b75360f9d497b7cb883f777cb2729b632b6fe4e371c7a41e22ff4a644e73b3279db51ecd65a1261b1a63d491eacd376daca007f6ed48641a294c1e15ac0f1a6040f6454960e80bae2ca4075b5eff1b98b374dc998617a87670b8c95eeea28b9d5289a8985ba564b9e16f09e14bb534cbb279fae6a61a5c3ea3cd4b980e68aa5ff697112e127a6bdabc9116cc51f43b28ebbb4f3c623f7a1c02feb5912ec3cddb13a602d5e2b11f20748ca50426ad4bdced7e855154c30d31ddf784a11406b917314c26eed2e37a1531a1e52d2549ff16f508658cefe0ce1e81cfd7e50b916e730e9a525f4f615e6068603c751ad45ab79d89c6f4e4dd00503ff386321254125f6b22c03734102152184bc41a54cd44bb5ae4fb9dc8794ac2274f18888392d8679cfdf036f3b29760ad4ba0c33942a4c8f840137cd2b8be3f4607e2d81c4e6358645389c5971b7921efc12e4164ce0b9a2816ef765404a9c8e5cc9cedf8b2bf6fbac0a568c0997ef40edfe963fa9979765049228ddb5a89d134e96f75860da220c233be21b1ccf7424b8e2a2db8a9915eb9e83e49a3e3a6d6029ff9c2c2200378067191ad41576af88f56b45a56bb1c9e9d652f614a50bae223e318ce7362b4602f4b09d24e275c32e70d93aff59da35c01063515dd59c5fc829a933675ed72fa3c45741d6551c4edd5de289d530369d7016465ed7c93c4820d5dfd5787b543e797660ad22cd8eb603c11769aa36376fe02f7052e4d0a9310c4bbd6ed2a3172aefb3ba2825c10e9c3f2227513eeb71b208343ec79dbdb8b26491ea5cbc93336db748ec413cde20261a1382bcac8d4f660f309c7d285c8accf964439bf531b6c77f12a8bb2b22664cdc3643de8d7bebd7edb9fc7fbd38e404ec238b95bb3562c54e2ea16fd57d2d337faa3c7318b50b174a9154f8c297d3fb97d4b313dba9eeefbbce468191f68590e17e5897dbb7e1f679d5659dd0497606c97300e2a698767ba6c14660cb6a3fa5e6469f7f8bead1bdb72d252861a20c1cc05ed8da3e9b971184d6590ad6df57ce752193cf06a79ad4cb4e12bd083e20664e5e867de7b8f070497b5441e52a93fe7434b0f55d58363510d215ab07242fe36163118ebf3493dcdc67848d5a49b5273fc3bf1811c84f0dd9a7704ea5880fc594926c7c7166c8496eb1f5a0af7d0db5d335c87ceec764770de771233c91b5d8ccf8e90e24432bd438f6f1e2f4b9c65eaf4627d83a3001985721802d222f6926c17c584b4e925d4f367881d044f4553270f828268861d262df82a1d019770cfa20912178cc37e83eddbd21024c6b1470d01470b83258d26061389853704b642314e64bf02adb6dfee9484e575867c935980d7ae3f13ed1581179760bfcc6fbae52904188d31a03e42cfa8d09e09e526052e6389d1a2dc3d1f98483fa4f10f2fc64bb308e93ea3c5ce59c9dbc7239174074c4b4375b4a862698bd4c697b3aee3133b3e13990a68e0f48dc5ac59944ed9a372dcd1e08c4d4e153fd654f5002235a52da543a69fadec3a02f2af1098c8414882510682126f8b2f8a27fe51344f475f17d1c79046046afb9991cf0ebd73f9ece16693564a6e3a887d59fcd0e7bfe70ab7d58328f6730e1bdf930cdb3731800a1f44565858796ebe28093714c15f42b9d7f5278f9bf32af2de0b95b70ffbbf10b4c010620ead4fa5080e3138bdcd21a52f806c13097ea418a7d3236c48c6d44e2bb34494db340b4dbe597558a8a84d6db68977ca1945bd9fa726ea51fb1067b0e400f864caf58c979ccb2f3796fa5aa001e4040ce99e6765ff4ccd63cd1b89bc8eec9bfd37fbac2de1250c8f70387bae60022287df0baffb48e951da71b6217ef8febceeaafde81736e23593b84dab7b54776ade49815b1ff80e187de3fa874fb7ff1abf54ff12ef2500c879d07284013bc7c2079a03ab14c499df017b12cac898d9ddb572c037fad5c37119c6c459697ccd1ea7cad02c1564db4fd65f85471d2d5457ead7041f434001e3016c4b938883889be6bf326015810a834144fe7d7275d4d09efff1d3a68c76dbffbe425f97eabb2ea980c55a5ded5ce15e291ad6608a783d98c4962b322400fc6dba353d5a493404b35fbd00c93df6e51679bafa483753fdeb8b30aef92dc8cbaaa80e65ae2603f0b15558eb767450a6256574d8ff96de2bcb5cf05f87433a7f0dd5153d7a775e8073cfa27e3c3b16091753238b945b95e4cf20f9dabf7f1e62315937bba02ba25f1011b54ddaa3e693ae698dce0fa8b41dde43c405f38ad201836c7c5de305bcc54499080e945bb0756cfe7c7f033ed2f8fa04da425ab78f04466760ec84d8e07da31bff1a75d8aab452248178c0e76e63684dd05f188b33d43b036bc8e121646341e0998f27cae9951cfbccce495bc99a567d1daddb7629aa98785af6fa636f6953f81121b7a195ebb7547ee0d77ecce0ca40b5f50401f95f027198883d1b0f85b2ba154e04ea81825a28a39bab11288f31a789ff7643f88f76000161011344d3ce05c83b78f0b5670a29d00456dae995e467af3605060b40581ddb8beb6ac50e0f6219f47b3bb43dbac155ba0484544f2b4790fa5591d921c22f339e30a998238795431e700a2a1a690cd75a2beef46db28f156ffe4296a032ddfc5985f24322c99f85877403d35f10e407e2b7ea3b36fb1db045c4beda92bd2781b5b2d131e62e86e0e943e6beb4cfa02fd7b5c5024a88bd396178f80a2bbd672fad0ce4fa39870a6863d70197e91428921bd0dc5abb2eaec352f488159a42c79345e6dde3f350a885661c792164987dd23f4a543a13a94833678538865cacd9ff359bb66cafe5876a771e4544d1098158e896026b9b09405508f72b9afadc80e25faf0711ab0a750a753c6b8bfd31dbad875b846e8903a471b73879a7540e72e4407110ee98b0f7cecaf573896a5389e455eb9ee70ade7efbb03d8c13ef5c577f108b8065bdc7f85a991c540cbded8dde38fe58e09b23bb377bee3b6bc1417eccf453665532ff825e7c052f5f269f7014acefa2e637bed28e071b5da4a9e70234a693f9014a8ec65ce14cd679f34f6067e002c38a68f7671ecba101bc7bf568ef2fe8ad3ab26c94ebf178eb14bbe3ef1a54316bb2bce761e6240e32e82fa68119f5a5114a4996582cb90a2ccae64ac0d38daa20d2c9a967deef59a2cbcdbb1d1ab30c2aa3ca240da5e7b47d33e8a3673d80b4e0edd4ce2db59fb4c245cd62560021142468c496abce39711cf20b60f2940e49a478f7da816b8bd3dfa1d2672285f0dc886fefb6323a6d9f22c238c9cfd023481a706d8f1c5708c9371eeba6f0760fed0e1ffebca8ad51227f7d0a0555ac30a79e69b4ed69d033277acbe9b3e0709935e3319676f92ddd65b560fb2bad9a37e2a2ffa02d0a4ab1df916fd5f9d5093d6f5f7f257ffeecac148be4744f10723b18d5bf19b4893e489f643a99d2495f4318fc941036739a8999b4b3aa81552d21be92fc7bcddd64c428f3832398c0c504778d4c387dd0e34c6275fc909c2a7d22bf291f5d107ad41478a27ca28e8e5b4bfcd6e25184526ec53b05bd3fe579faf36e4401e96d70e45b9fe90c5c99b5060c774b10bf8b7524f11e2ff9e3e4469647d69f55aeaa90cd4059ab9ecac7a117cee854a54b31b940621d194cb1040e8df5703da57b73fa7cab24102bcc9f5bee44cafb4ceda3c4d93fe7bda7d33816838ad93ce615088a4601516b58697c7de3a6aed00773004cb2c5d4846b69b5792fa3c0d05f6441d3700e4a1cd60c1a4072dbf56a51b08743030369f95471b87f795fdb8f37394b551c032f5ab0549fd11e6c244cf5fa640fdb0a7e71e3c3595067716bec7047a7d0206722490f001967ea6d7f0bbbb4d20622a9036ca06c8931833f7139ea890c80f814be692207c3ddcb81f43629ce9f4aee5471840794d0afc8e3871f4cef5473a3ed3867ed34c9f0d1bcd48ba419f2a7f43042159a03efdbf378dd1c90d38e7ff9ac2495bb007f151ec2529a2ab8006d32de8d93765b1165409f6583cf599bb288ea2fc9a208a157fd17903188bcff5435b192f00243a198ec6350d3a4ca64bad5ccbaac1f5c658f4750813c72d83013cfe3dfc60b16778312dd1ae44d58afaf98a4e25df1162b9306b0bfdeab8c3c97efd9cfa83f7eca989a1a1b7914e3012b48a8d3ced99bc13b1f020f12071fa121eb60dbbfeab6529908883539a639b2f39e2ae138dfaaf4aad8b4006229480a91d819e2ba8ae2c889d306a78ebfa51bc2f65bb8f13cb76f6d316de2303a9223609329e3f7d59183076107b430f9fb1ffc7de43b503efd350d3fa02d22be390b623d713c6efa05c02a65a1138426266964bbd0bca8584992809af28ca94dcd171f0d70b29dc74db7fdd5ece23fd12e8538fca689ae57c21a4911f79998f0c18fc6ffc4ea9d1d383756ea432d70379d9388e98b721818ead4f7c94656ec3197e2519abd3f875660c39b0372c4c462ec5c170c15a115ca221c5ff5f9732d68d1ae5ea13256dc6ec7d24eb27352fad444a9c64ea1cee7a1a731558f7c338fbd2300f783b0f1bb20fb46aeccdc4f826e02d941fa4cfddea644ee3183f8741c969178f6f85b813938bf405004a934b18d1786c42f86fccf2a715daf441010138d0288652d7ba491a0d357d1d7a0a550889df593ae1ed25397bda2e7d1485e6f30a3e1d1356b85ece184c647fbf9811bf06d36865b714cbaa7f1958020ca3c5b40261b663ab2099f558c615dd16bf593c8f62de7cc27e2744a373c84cc3c685a9dd9d1781f640c18c4d1386fa94e3dda5d3d8ae94914ed7c40c357e155b4789b5df3bcf138927c1045a768e6343f91dcc02a66f27eab7a6c1b4a3140c8aa50a1642f4d405b89cd5b1db2435f005980ac5f18c9ae17d261e62b0fcde5766d2708810379cf49b0133a93bdc21f32ccff94210d3354875105dd328ee3c252bc38af2906da0bb9c0e91c43da8ff361d8434ee94685fe6b0b29447955ede4004fc8aa8b620afe70d3a213d2b035591f84e7685452089754e71952847d3f4637692f9a85425c721f7b24fb6985dddc0dcdcc5c6f1b02cff15c45e0c0837b17ef0ab4a2beafb14e012a710e0a34ed562c4bd0305da8ae5e42124270423ec86ba1ed47f0452dcc1940ca1857f008e4043ccdc89ac423a372116d9f448a34319b5a0858d2ec53cde4135370f01c23b95df09df2886936f5ebb2ee9037f13e8f5782026f44f45c9a2f533ab8d059b7132e87899c6d00c9121a5b8309341ea9829ae266c578b98092a900da83ccd28d4a4c8b09c64c1c49406186a13524093db1d582be812aad965e6ac2de24bda975364fb17828e4151e946a9ab25a4eae2e92bba0284bf0ebdfbfc9e424a2e6ea54c8a55be58003d6923770c2bd8bdfccb83723aba19bd49f039a90c181a55f460f3ce5bdb84228394b353f88e6d86e1eed370b0a52b446da2dfeb39aa9269311f601a006919590a5ff2afa1e3e1d1f510e840b2cc865a1935888a18506ab5786eb719896f80f029af07b9ee289a674c5e587e1f655d21eb9ba1f1e00ef739dc30b64dea77d98b67efca80f39a251dfbb8f4199111a9700417e5808cb5413295b725538d38fe7fb9427da05c00ea0e3ab868acc06dbebc40404ff7ba5532762d3e4737e196cdec9aaffdb401d6ed4bbddb2c5d290c59622c812e56b1cff25001134df22b74e2c8c40588962fb96c481ff80c070ec19f916a922fac756ad105fec403111a8880ba4d242d120d3982d3871f9ef271aa75d315ab678bbc6a186c678999e3fcbd0f68f49482c2fea56da6f409d0e0b07c2464df9145757f17653b78b1103d0a89dda265221ecd8394bcaf51114a7d21ddab80b676082f1b3469a7f4acbed4cbbafee5b29024f6c6d14a2fca8067be2fff4dd59872b43d6ba19c5abd4e9318fa8dff0a77491d789c4e8a4676a67563b106423e4676e85d6fd37ffd05199f1b8314ad12fe9eb8812e447360618cb00183e4d757a40260c80d7cab92bb715e7e08de672e1bc3df19cf515ce111d215964bb83bd344155cf1154ac9865d4c941a8d70a6b615c5652a8b967364b7974998ab2c7114acb4af60dd4034e911e5b2e28a1573451d99db2b41e79855c5511825a36fda11dd1ae18416b583ec0033425eb1d8e56a5a112a88a9bacd13549302881eb9bfe9d095a57a80c59df9418a59cd007b345a05842e21df3e5db7771901919999b59ebdaa23e21afcc18663e130277e851e3b2eca91262bcd3dc525d1a49e12af44e67c56618b7fb047a9a0fa5ebc49732c25b85bf6c2c6e3dcebc4afbb8d9d8e82ff22cb13dc015bf953334e10ca48adadb4ce8a66e86097d4bd9ff63dc2f22e5296c48679733cb933b8c0503b5c2b34115c71d16653417f5757618e4d047df5e73da0431f2fffb6bc739723961e2ff646253a0da2e83bf36d2e8b3686a7e871ef546d6775c26804e6b16a97b5e126ff71f2ea65f8257c3b9819eb4ff2bc4ccda56e9d837f6ac909f76095e6b3c3113de54a2072a03402e7c7969f82d3272540543ca8adcbd56f9833466c2a0edf43fc4e45dfe67de7720b79fb1d79a39335c314e7ea0c398d9fbeee61b4f980af6601543a2c90aac0f55544ebfeba71b61f84d82de0af2e3b9d9bf64725e94810e36cfd485891221efc964d10d3392cd5aaf10f1c880668c2654a438bbda845eacef45fdb3ea7d23963ad34108f1b1c35606a72cd949b39288a3226f5fcdc3cdb0542d013683bdd524ca938bd89e9878505ca00a23f9f938553c148a76585c75b4c106b310739f9e4667352361469183debb9f2ac4bc589d8e7cc7478e8907624cb66cd2464d70c285e7a8e8993d22cb3f402db2ae4f447281025dfac57a28faa66b0b66ad1a22a92ff23e196210911cd55158ce732bb5abac20a9f5d0483241cbc6a22c1f350b583cab1c7deb3a5488f248699ce1cca8de28b783d18eb387cd64dbb38815f1802d9a96d747039481d1dcb8497f9556d2892f0abf0f76b25faf4fc7c91e1ab19ecd03d3cd86bdf5e09d4a5eef273f46e76ae9e61255154d6a1926915a8bd72a390a967bad304614d3344d12c186f2650f51f60f4e5df9742756874b9520f0d2f7f4d0c2f63c6af2ef18814af3f3555b827e6c485310c3146e243c5c83f12e54a4a5ee6cf87ba29a52fc226294dc3af46a0c0bfe0bb6b66104d17469f7a04fd6ce10f3ff7791799a28af4b48b6a80d8c9b3920b0ce0cbb99155181a6c28ba7c2f8eb95e655b87874ff38c9268b3d66fd5a72a4be40f8c916aaa81d1d941200bd5358ce860f4c561d6f5b9c07e1da042b1939068368f2d6cca5625f5d598a75486b5f4c57d182a740db5f1e6275ed1677a224e8225834756b3a13aef5cd308f2441ec1c1a68189b5c7ec45e2e7fead0866042ed7837a0ffee1075ebb50289befb3c25e8374fddfa5004b8833e58b454e794525af5464f35421730139ccb1b53efca4d78720c7d58f84eafdcbe39ff0eb9419bd670d61bd15c43b2126cf91477fb5d7ff2e045aa5119f33f52bc07b25094fd343d70fc50e56c9133328b076d19530048d92f738094a584a35f6b1c92b6d5ae16e4980b14e854a6cc01fad8bf93cf72c90eb7e3948d6114da99212e3757e05ac1220af73956aa72ba18846a5e2c6da32c09d1e6fc0b7e32bda6a2a762e8ae823d2c654ec7c2e36edf62eaf8ccb7150c48c090927b811ecad601af344c561a9ed8666cf50e2db327478fa206e07d1ab9d2da43228cbea8783d568511c8dcb403d581915623397ec0a97e2bbe86ff60859117d4e6769b33a6fecf72ed46ce53d679c3e121dea6a89870feba40aec50ea93be95394e05b9d4d93d1b3ab506a6eff4085b1dc4af6a73326ff3e1ffd31de2ea541860e25f8b9badf2f382712cd756211e2916a5f9f639d8be754b0c32206a15d6e1a3d930b23a635fcb23a4eae2d70b574357e3dc2f6ce23e2753582d3842fb362506981b0eadb7f1a22aec0fe048ed0a83540faba676f775dbd7f72ee3877c5626add17ed2c42fc61341b4c679e7d2f6148e702c7f86f41e11e29f7b7e500c27150bef7d9a34bac87cb41f0a5f0e08d141ebfae5e100205ffd201abcfbd78efe679a96b5b3d425d07dfb3ae582e9db17f9c672f89cd62e7dbe57c1b5ead121410d3c62436356d030b2997ac1fda2223e75f5ea11fb21a33584ac40c38eaa55598eb7c05c033f300f48c94ae4b3d79771e9ed3cffc238ed9c06e7339eb7bb5a8a98868961fcb76699848248919cf02a42864b2ef3938f1eebb496e528269792b0febdc9d8cdbd98fef2f14b5cd564285fbd0fe41f5e6943f1df3a1e2af260aa73cd21977abb4f02d7e93dc337b5e69b7c41dc5ff70846184d26efc6eafbfd38b95da7c4123c9735cb1e056ff29dac981543df0e88030ee991845abe3335eebf845c7be781055d8925f0ff0851c7ccde866da45f570ac906ca047463b1431c12e5528a2c18c5c966012c9fdcdbba1aa67540c68a566f87e8e146e686f64805ea1c60492a1e40f0d70c154f0e07e6a2595f32dbece1635285961b65b64b3b82348a089405d16e6b7a087d2ecb928959b9f2fab211e22df563ce","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"ab2beec4f19cdcf7b5c909265e03bcab"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
