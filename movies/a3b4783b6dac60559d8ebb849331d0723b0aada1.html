<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"0a5a88b1bedbd6e5357d3fdce755bd349906e90d9cd02155c53a96802821197799f43e226ae336d728a0c1ebd64f6b850e54a2a37a8a81755881c100768c6bc0259e63004150d188580946d106864bd46d7bcb346a8acc58469d47893f976f41ae4c0a3a3cb9735d90dd2187262dedd412e007ffe86c750f27948373ee6fd0f4f72060cb5e0990a90eddcd759e6b3c3868033ff26a8e3f601362b02aebad3ab98dddc81167ee004330eeafaec37121fc62c43b41fa6472b52f211164b1272e6360eee2253d4d0751cd97fccaf8b058cb79c90f7961b8b073b1bc3f90b16d1f0f6bc9f5e675788a21748663b7c7b3a0b26f5d3db27e75b732acee629c440b03a0754b05ae2b88ff2bff48fe02095074a9fdf32aea2d1aa02f36da093960680fdb5d4b6c7f9261a43458b9d3e829b27ca8d7a91d6ab24567eca89e6b1e2161315e6a24ac869f12c69de0c01e5f750397ad6df2404e44803236f918f12fc3db0bc0a806145c42ad8e04b91b875e0bcbc391439ab47facb5f451a91b709bd1ba28793ba0cccb7e4ff65f2e3a4fc21fcbf3324c7d50ddd40dadc9c5e19b153d7d44e590db0376f201843478fa369645b60d3aa85f3b81b521423cbc92975468c55b83c893237944a9ca8c53c0e786eee4214425f49307b0b9fd6a7fd0bc66dd69e731e604b51c5d97f405e982ef0318a3b6ecd58bcb05becbfe278e3dcda6c9b7930d59cfe67083f62d0d46841a525fca5d6ad557527cd71c438fae0649a5d2acbf2eb20c1e7341d47d90350d08d65b86a88869a386b7bf5edd03e7f76b76880fe3d35d6e27796eb3097649f9e29ec12e178ae31a4ede4ed41f1a8c9aba6aa3a4ebecb5ba4f10b4de8e9b354bc89f719c49ea7120f5a808399f774e921e086842e5b7fd639befd52c6b3d6a6e5ee0ac58cdcabde09d67a07f4c174840770bc46b4fd356ff858bc73ef7db133a9ca2002aa5b744d09ef8ab475a189aa171d5120faf05e9d0144a1d02f20fb19a7be4679c272086e84a75e4df66e4f3b4a7a545bd5e8d013aa3b90c29db271bb95564de2ca744174f6011f88f5f6894f2fc33f744f90a2d980a708de22f9abed41c55f0bc652d13d6f4d7ef989e1347227416b7ee271b4b8012937d25ef7dec634006a24f3b1c97dfd0b94335fdd126402898802f7a71dfb39a1b38e07b13ab1601b61f92df73310af69cab8bb015bd494a463204dbf3f735415bc03b3906a057abf93a61050d8d43509edc365d66eaf617a511f8add98adaf239125f1403a1563b957469736241943e196f026af7c84fcfcc20680fdbb328c28d7dc3d5ca878b286332346770c8203bd62f7af805d14c57421886d5b913a2b74447203c63929a83f079189739a1f258fe9167e381618d3a7a1322177462c30407dd52bda418fe01d5bc46a3fe4fb5b98f1de4588237952af4f305dc7094bfd26987e11c30571baa5eb8aaedb026dc0fe3e3782dd430594890b98c0eb463a2084195f791b472eec6092f6167596a9bce5054f139c9ed1857ea20c87182dcb5cc36fe9ffb6dea2c5ae9853063f2222d5f57d0d2037362177ece62781d3236a341c8aa4761015fc7bda9a133dd35222d133a4d9bb3544cc402d0c575fe572d0d10788c911753b15735ab26725a8fabcb52a7531bd12ba4cfed86e57f503aea5ef35fb1ecc3fc7852bf88d6b311a2200b00ad1837a6bc8848e5dc28f6daf893f00e5e600d40e94737003c243c8085cd090289d304e1aa037b6d1754b8ab3e9470855a2d9f2b9c2c091037949462171152f43a68a0b88604e3ae979785828a3648e7f4c6134bea20bc6ce41acc54634541ee7032fd111d399a61600b98d6a722f9b5276ceb0fc7d98f8c33db2bac438a0c14f35f0ec58be2b0d5a2fb956704d57181e0c44e3a8ce8646e176b0c3b0e9e78d9f18895c4f5bc60f0b7c4889e53d0765a690056bd423e74ee97b399e2956bfe1bf39f1b7017ab3596863b511c9ad0b2f9c2593761c53d8ccbade91dcfee23edf40f2c7f22e786eea720e868d519670bc8a261f3da54b79bc95dea2cb6b96eba2ace8de5d8bfcd08b5f5d69c50c61e5ad7a4b8dd43a4e86d07a6e4bdd0bd07c4b04139b21a174dd990cf22f4b7ae4cc00a394384f5bdf398b0e25ec9fb9d90d53a339754d23fcd6d6dce12cd1d193ca8deb89a3ed6308836c5b3190060e6b84e7e2110ab21b9da0e6902852f958e7f7d70f9fcd5967572c557ca2220cb6f56d6d32a0d3c039352dbaf0a3a71f63d2314eb840b723da429d98ef9c9f1826e35397a994d7d8e7250342db9293608746624662ef0d874f23c8dd47d1c7529ce5620bc6517250b41886efa9a00dbbfe42eb0f0ad4719f282da69ad0d9d150b3e15827000171117aef4658c7474a1c1cd6f59bb442d6398daef94fe1a5ab1b07b3a257e07c375d987ec77efe1f71dd1c482c6807ba3c5204f5a28ff421469602ddfe7821b79082ce77e7f6c791d5ddf11e6818a9fb7d56d279f2a8e05e961ffa2984d2dce15f4a0dace654036e23f80ffe3187afb4ad6c398b021f41d18a04a506f75df31db9361f26db8f6928a3ce562220b3693430c5af7c660da8062976937fe65658e92d844a866c0c1e5b3da246528bdc3e39bb1d4f5fccffdf3add6d230bfa51bb7aeb170b940dee8b589b58ff33eb86354c9b24420d24ed26d6ca3b92306f76f09faa4b418a170f9509319803cbbe3c123e6bd89d8079825d6970fcea6c4de093090dd79e75a1384df252adc10d67da51d1aaf9157428b39d9167376bc02d0ebaf3e80d62a635048da58d4d44878ff339cbb02b8a88e3a8eaba644e14de0ff80ca173fd26a7508e8018e5b77da36367c345b241a464a795590bc8b8163a52f9e4d69a9edd497531c0ae5e1557ad5bf29a61db56f5237a41fd4dafaa1033ee358de6be707744cbaec40450d4f903c5e5bbcbb43788c9f5bfcdb4d496bf2861e4a0ac2bcb3051b4e71f159d7677addb1ac062e9d1844f87849e6d228b39791fae0edaba138436d56e15d1032511549cce671c4f907fc8728e113dcf0ac6f811c967df8fe95a8e798df19dbbb9dc73e2bddbd6144536ca30808407c977ccaff0f2e7925fe377b30a3a38c9b9858ac2d41b831258bc74c23820b87ef2fd66b6d0358ca594bcd667f0a5a849c84700e1f51673ca0be0a46bfe7109c4d65e6ea39a53a39af7074cac1da56b63e4aa6296e7c72d6902702b5c8b45900e8f628d54ccce0160f11fe3ad293c6a182108c892611ea275346ad044de3eab299507484b5a07a5a8dd376219bab2349f121f5a75e58ff77e7ef68d0196b6aed1c955533bb95c60e971eda50f8bd0d0a21b66957a8f6684599c66aa604ea51dc25ba8bd2cbf8b434404b63d0838b0c9b71b958c2d36749da0cfd868156db46705c0a039f7d59d3a3a5cf5fd8b81e658c319438e96d78faf607199431f12da88660e17cb2f77cdcb2708de928e8f9ab504d585972ca247e80d18ccde005fd426c2ef3863a0d79c2cff63ed7a88fd8905b348b9c494db51b14cf53d3824a5d149654affc75e1099ae9fbc2cf4171a84cbcb430faa941c5bf549b4d9972b0e336ed13add9d52d6888f41962cd403caaa016371aefdc8793124ee058d3d729e3285d50c5ab9ee1d06a34f9e41684f6bfb24709a7c7c8a8b835f97f4be7d52ce48cc1e7d1e79148c6b144dd0795a78f328112332e970ea40f3206e88da076bd34592abca8e238548b47042ccd4cb31fff7d5b90897e341c9f4d847a185133e5483211231f86c22b3b9dec286c772d57d70a113adea9c30778752679393121648c3d1a8d0e784f1ebb848eda56073ea89de1d36fbcf20abb5ab9abd87e1b08bcbec253e948bef2cc35d84df7d36c665fc32abffef05d7e18b3630b74e9aecb47a21183a7a5a7a175ace3921e6e6dc1033098e620018c5c2dd4bd4a581a17e7a7d8ad0ac9b4c96f9c5fdb22f5cec5473af3ee7ccc491c5864248eb6882f3ddb8d69d6aed6cbe859c6d18ecd0a053829b6e088fd6ca3f7986c6f844ae378cd9140e06da3c92c5e25bb4bde9d4ae52f5ea7c10d60847cda632d27aee62950eac01aecfefa2dec4f3150a20b7773098d8002970d9ff696700e53005bca6a677a4771d8ab6a30418fd076006b8c8b550a9820e5d28ec331de9c57bdb1d10d46cb4d97b778b15baff5d05f42c4266a0e939a51ec7f4a06fca5d89aee1cf0c2ed85cde70241e3dfbd2e307ad3660004eac86c82041f03238c7db4001f4dfc95999b4fe8bfe7c81e332b2958203af5316a1af389b18b99eb1576e0df8c4a01c6d7113b66ee3c34f970c87ebd64a1e77703be788c71c89cc3b4b78c7107583dbf66bfe46f91621ddd124b4152a7b9988ee588cc02081391fa18f77742982c20a15024bb6df22f76f5e497e7bbcb602ef9be4ac463bbbde03eaf234f548c5999fcd581fd527a2ae354ace34d6ea084006909c096055bfced43a3ec5c1be4e0e4a5c88d186c64034d22ebcc5ee5ffb29e0ec14f94920dcd3ee3a936087aa289e19339dcc0b07733be16e5753a1a9ff03bede9ad07fb59ce3df622d470c47a7f9a0755fc3ad996721eb3b7bd15afadae58f43592cff0b9636f86b4f626e89420c0f547901daba6aafe3c79ad25cc7de5b9d6eae219a01a61fdc8876d490e46926f03faec460ca05340686e213ce9582f760771270fcd02731a46572d0da547bd5498e15bf66965146a5fef3158483be18b03d179491b5b19d73d3a23cc0b33bf2ea8730fb9b00aac71a617f7f1d7dc20350abca278f7d75feca5a425f7153f91c88d43df06a6dd9652856e1acfcf5f9104b34b5a2dd2c666c2a58e51a32ca937cdf730760203cfd188b418cda06988553ce881d88e6336801517f60a86d01369000f69ed0e00d7c1318753973dcdec3c610f8ca7a3ed187f4ce38757a0a9aab88a58d845830d13a2d483e32b5b2f6cdb7f1d4035fca8e9d2c93fac33cc6a6d0786128f1ce4f37a73e3f7b042fcf499fd4d1f8549e11562f1bcb3e35a1a073e0423d1a721a85ad8b7f63bf1fe53d68eff01d1393ac93320d80c8893a03997b4e08ba5b1562d1a9aba9392aa9d0010b7c0e2867817a838cebe620c8a48e2332cd00eeaf06dfc709230813c55d3195563cacce8eac2a5f6adb0377d2b54f6840a2f411d06af2274915cd1b0d022477a37e44167de067d60211324066df57ba85e4f52c71213c5a65323a6b7510d7ff6526b015f1982effcad1d4f6b3c34ddd0deb4bbbdb40a4af66f74a3c6d5608c8a8a2c06c330ec4b529c4b68f64a97d0e5890bf91b749d90c635a5cdba8eb041e23b874405929d3b5df68f4896ebe7847348eea0343230969154e581539ef2ff76c27dd1689fb1f887cbcb5ad3a7e4fa15e9c4bafa72c429eab93223e9dccbd88a8c81f39de92198044c0044ee89614ac48b278ee3fd33a94c0335fb1eae7b132427c5bdb05d832d042cbf85c48b64b41e96c3710b0cb3c23ac204ab7266a6443aa2ef50e3fe5df9bb69bcaaa797db65293d2601d2a94318555a6585f71874caee6ec630bab4e2255db40eae9f5abbe58ac8b2731cf7045bb4fa8689b645b7263b371420858e410b748df2b5739c38a80a04ed4af33587845eef6fa402dc9e97486829f0b3233fc050e1e836832ab87b338fc2ada57a86a9c05beb59f4da581f4ae0747b2821b4cbc34a91b31be8d8e30d96a16ae794980e906d0c0b4cca6ca6c5dc5861ab6ecddecd71ac7061b251b7a9920050f549f42d74fb651d5ad6c0c9b3b00f0ac1a8e10c682f0e802fd5cab8a7b11d39f7f1e09e01620943d4a31e44726cc415551b6ada5f406abc018ad4a3c638e3124a83da866dc8c68cd99a85c963899e58811e8508cfd2bc5adf8f59451d762ea484a3bdda5b80493687c1a94f20f39d217ca5d6da67fc3f73ad6a9808dcdb52847c4b8c7c9ccc31d19eb8a88a4f33699a89ce13bd4d22ba1b57005eb67a3048ea3a53e0cf666c784382c2468bfcdbfd86ba74d0ec08d26b10716d1c738f56dc0d54f8232c8a7a7dd32d672acb3a36345c283c0fd3ce5635b9015569b224e18caab2613c3ad4b229856df26bbc35e39fd9084c6a26d9dbeaefbc601d970da3ec375d89fee81363478c1b38f5c2201927bf6e2f56b49182577f263a7a420eef07ea9b5b562baf507f91e863b98b25dded1cb9e71697349b30d113e17d0c1e9dd091652c27cb6d8d8b683f695d74d8b8708a00ac7fa37aca8796a9df79c905d13d58115cf06b03c83a27f225d3811ed8c525ff800b93b53fe1aebbbd2ecd84a476d78ff06835cb8fdceb9ede2a169c4540e023b91cee039eb444200e8f496d3b363cd6825fbd8940d88da7f2127b6e1a52f1608dbd7c8d8ae54c509b8368800f113a1d75375bb81de4436e6fb1ce4e9e6fe9a251c682f61445ce60aa77a6738f24a526d5dfc7216f3f539440405cdcc614bcd0b25ac84ae80a9cfe53066ec1240278e220b2eebde7c01a6df426f29b3ec14e5886ed83c265432c4e559dfd3433b26bc8388c409c18014602e632a26c411c5a559c8e2bf0eb3aa1e27b76c00e601998f823b8c8a5fdb0180f7497b5abd83e97abccaae81d987cb66e39a87cb0a7ee30f2eedcabccba3848583433d63e34ab54158965a42ca04fc128b61d9c852be5570e64c5d6855a385cc76e7e8158eef202ffba6121738f8c4088ebf01fcadd844669fdd354c3969d185aaf354016f8411a867d7fea16883d8ca0cf1f22e1735e8a69d90eef80e12614f8ae66a20074c1d716f404756620799850ce09734993dc83595238dd3f5cd9210b5951611a2ba68a7a9a2ec43f533d3f620d52849281c24a8a11aa6067637699327352119ca5bf2eb498d18fe7b5d007df73c7bf077da32360fa661c8caee850050845f9054c11e4fdad28566206ab74e2b9a938b95d49ca675f695b1564e4571c7160d81d2b6bb0b8f11c5ea6e798668883e8dd46641f4bc2c458ea61785cb3af160cd41b1ca13327f96d12c664ce24f86d691692b2d82ed9f0102bbfb86be7e3942b5c54e588b61761e2827e0aaa59f9c6efcffcdba8942f81a5fb3627eed7ccb7c0ab1919ef438bc9a92e0736a3cca575682f6c4ecc16b7190f746d38d4c3f70e434ad60f44ad9cbef00f38dd7c6b084db4dd0ed2953ebf3713e38216dedd1ee27fc2b7ad7ec38d41ee12bf70d0ba783441b993113a4ba570e87466581871d3039278e9da7cc261f38acae3ed47201a569806d0f07c57875aafb8b08b6c80221b3f71422f6728b0d30bcef04a42b5a1be0d596ce3b41875fa1ed63151ef1ba70e8ac1bf24e5f5725cebcde56beff1526a7c6847e57d128238f776c82a14f0e216833ea7383a4f6b7b8c03563e4ec53fa98fd1582f6aadcccfc65c2458f572b4348a62aa2de4b865785222234cf4fa40555965fbf1dfd00f2740b9898a72f5cd9990baa3f2176ca8fe7ff51dfa934cff880c6f5afa673facafb93fe3d356c8ab108d70f5b5a21742e23def71431555138506f29bf824f1de0e6f392223d9c8f2f8633f44e455596b92dc4524b1fc2216025bfe2abba3c0e63dd16d58236b97b007b786f1d55647b7c1fe1fe6480b008a484ebfc7058f551106ca31c4bc058db67a50252a766b68cefbef3ec2d057a8f8149a60b3acb5f0524ab9d99c6b6c76a60c1a2bfd50b7d0ff053de31899aaff3b3cb7aad176737ec08ff332a9dfd7d706fc4398094f0a2a1ef0d2b9b4de0c82fed7869e19731f8fe8e9bda571ecdc2f998048bf54592a6f6c35eb7090f8f8e050d03ea889937ae5d9d709f84a36751e47a9c3a8d2b3e3d7afa1f0465de7116be7cf2a12b33413bc3d383deb0e2d1aa60e6fc5373592c38b53000da30d0371efaafd0fd0e936695cbff7aee5bbecf29c1b6791a222d64dae6c25594ea241a2f87a9e8d4456c1f24c224b24b037a7672567d47024c764f6bbc762d33d54be346d863e16ac4b463201b00161fbb3dee251fa04cf1bf66f087d498e0d9432c172ef345a63ba004be93c1c3ddadebfa59f7f6faab5973777c9f8d95df3edaa0428ae45d6fe725770cf5d21a7c0134e89a63ddb60210416ed45e62b7ee20248827454db14008f8e40a17bf441c90517f1d70bc90c469c78a65a34d3605f08d134c461ef13b55c7a62beb92e4c521047a37ff6adbaa91d7e5d1835e671e96be85d8ef7843a2867ed30d8881e25467cb8cc30b51555ded65002772aa125a93145dec00c603d25ebaa1964e1b093660ecb7834c27f0ec9674a1f88c7f6cebabd011a3a121d1a1a12f411a7e4d1f6d5383e216dc15431429f5b157a78a2ebb5ce914bb2d4f9fde89677cd312ec1451d879a83e6062c68afde65270b6e5624e10c46febd4cc692c3b8eba78a2de555b10286a9f2e02e7bb649c9c6060c804d1b9d7242ee313f1a8ad0114f43427fcfba5e982c5c727f38cdd3a0f7d4f1167ce7fb80e0287cf8a55963c057b425a641cdabd4c2c2d77e0ce6abf73ae629c4873456b8f3d58c6f34ed4bae73665d0102b724cb014c267e55624e88153249d48460031809bc4c9d6694382ddad7bd13182ffa91e570a37d2149d906f02867c429c73e56dc19bc935ea79290a990181c866f5dc40a8b71250db453cc4de8d1e9884ecfeb2ddcffbe1ec47898e6ba084a503cb4f44814a11737f3543994ef63e83d49f600f9dd2aae41d65e005d8fe2f3a95e85a833be42eb4510a461e1225f67a24b226f0b06dec22f47e512765d8f79b0f659c691a764548376b8f2f165970436ab36161c0bbf2f58247e5f879334f5c8b603e9eba8228e689891bdbb5ca70b4ef4abf61885dcb5b207547f0af596ccf06cb40e225f297450c3fab7903aaf6d9587dbc75aa41404a27ef53d7be754caf7f99fe67a6f50c67e80db5cc13b785754054f5c0a9f999bcef7fefa048ab6a5bdc4b0e14d24eb24a25dad22ec0e3fd3d53e09dadc2e7214d50dd96aaa0b187afb52e71e32fd30679e8a00d9a4ca5ccd3a1c11002b2d87e035acf2c185c1b56b9ff61cbd793c2dbe6815004041c21862676eb50ca987ff741935bd0e1294ca9bca5c4bed4a464236bfd6025deb5260692dd2cae496fc6d8f49ce379183468e32fee4a6200faac97e210bbe9118df51e8b330f1ee6bc8889c98ff9bed0a1773ee723171fd1810b9d0766a91d39acaadcd8f6490065b6064293f3035a2721cff222ab8e115fbb0c7efb49b643f8769897ae20c18f1b01b8995a2b82818a5b4629c66fcfd933db6a397726e1bd5170ae97a67aed0c5db51e455bbe0774ae888bb69bf06e594ffb63101b02bd5c7154955bef17c8e567fb61beaa0b7a72d2a48790d24d5e0e17c9bdc65d196fb401f1d8c7e2446f339f737b1f0281a7b1caa344a1300c89c814d239283a14a6cfcab1e0968401911ec45aee50fb3e45315c1307ce1587e46871aa0a05329860d457af8f3535eceaed9481560ab074de5b4e09dd3962e4d1248209db9456a3aa4d999a4d935cc2a4647b8e480d487f146fa1bcff54b4f9a3379338e595195063b0a0c51e0a25bb5dc6f328513a2e39c26c0b1c97363d697031d17a6aca67416f0d7e948fdee7e55ad75ec97d3ccb3bd4dfbdfa1279f0d73f3baa824149256c6a7ecfeeb032278d8d1cfc85e08469edee70b86ecd52ad3431c600d9843102f6bae3281eea24a139dd121631302e264a5a4fac585f5a70b8997b3624a7edd1331d1dc16c2cd89e52840b0076b7cbd0e8c8caedfa9ec728e331badf0f270792f5ae25e70c099ba3a4969eb4fe1b3f5b72719dd79343eed712c8095c42356f305e2e2095e85c83000fe17bba532e9db8f49c591ad8dacb9700993d95291eb08c4281230aaa537ef529d8c79edb25e5ced8f6c4ef76fbb90a332a691dc14897536a2de27b2bf527544f579c65a5ac1ea3485d18c2b75f4d8b6d61e8b3bf77e4779ee605104ca26a272b5ce0f71624d0481aff8018e10728a0a48ab419b2e76da3fc2df313568816d0b6a2abbb1aa0bcf973378a686a31094edda778ee44b5217930d8d3b3d8450bb5ea635120e09f3519235ca96a27094c2e4fbaece6e01ac5f1e0e0e7826b594b117b07cfe3007176324edaa0aa4eabcf21f3eca9b02de529060463d20a9783278f2bb9dbd9f0414116984c58bd6146c6ebb8afc196d0bdce92b900990751b626b884ddf3db3a3345ce93982bd7f4ab81adf5109fb09d44660b2b71bb9e18700ccdf2b8059fcf79c9a91deeb53074854f4d067e98e696ce17ce3bbf0a706ad3f1ebbb6a9f08ed2c5caf62aeda87788b7588d3603e1edd63ac89fcd55d254b3fcfd22b9e9314051fc3b04861695b4750a06ada7524d73e91db52e5448903afbb824ba7b663bbf2f7d742531081af41849f6c5d280ad8de5821ad42f0384019793ac6379f66f48a98888b082718e0652efdfcbdf204dbbba450da1c530c288db49363a7ae08b78ee7e672be0d453198bca8feea704201c7179d70ff075eb6dd0f10e457b25326b1cbeb3516883db9f731aa05807f2f0d67c7d906b3da1d6c43a19e74d6b39b01177eabaf8be39e7483255f886963b6f2bfd190a4308010465acc92255b11cd821f93c8427211e3840f6adfa07e99b0d4b632259072236e9baa3260240a456960fa6a6278ebc07cb847fddefc915fc0f4acce4ef87587a2c2143c5feff4756bdaacd77a4e3341a1451d8c3f9e8b04287a9216988fd64e97484273bbaa5e87fa82061b37b79afaef7bc64ea19fb42f045263f3e641af3a513e1087505c96f1e71f01517318483f48deed414e30628bf30226bb50042f148275ce90320c8974a0c2294f029e5c07d204f905c30b4fa73f1fb5cc4d0701fb57234c139e430996e4c9e52b2bbc2ef606a79fdda0555e7e2d85057d47bd051ba9ef2fed700e4a18a1ca383e6e206887986b038c247619e960fade85663dc7fc534333082cde07f9ea3013df6e203636bc8aa499aee6c3a692e516858001c897970cf7a748ae93af2480f2e906af4cfc6eb71b2de8165dcb69e7743ccbc1cddd6417ace64fa48d26f266f44a073dee2f07d8f34b319a645ad7799525273e3e55b01880f895f7e8cd8c132263380225067ec957fcced728f26b88c8f9fb7adb9d78b548d9bad17da61d30ecd3a6ead3cf5df4f710b071670e4fcbdc68e65df561950d1b8a38b5707792c190ab2a303d6f8fefbd9844f30105bc2e68c7f3f245f705816e23f9f075435441620a566b705e3b9dae204561ae521eb69ee7e409247e8fcd2635f4cb23633583cb95f6e272c8d0b42023bf3a5fce2a581953709ea5f55c6b51e242f753c4ee46dfd36a5852819d150c3a99499425b21c3b939031e8e935478ed034eaefdaaac6ecfe24d8f276a8631b8985b2f394d3255f5fb2a8130f9bf7946fa53827d720960524886357326582ece6ab4ea5f2500940b7c76dbf37969897a8685fb3e077538e28635b34e256dad739731e689ee0deb5a76f2a092a344cc504b6234376bff88ffbe846b0c684025348670d97662173522b3f2a53af0de434f26e4c8594304ec6684cf57b6d2353c32112fcc6a22b8fab39047eb0ed0593fcb1e37141202e09c07eb658643e5da44c73f9d004622c0c4712a466a966a7e78d58e6a2c39a33f131233d80b4d19e7ba6f2017589911b75e0b2297caf39e4b47142b6c7b89842e01c0d7b7ca7c29fe4ab032be309c2361123b8e1e6849e5e2e34df5552d20f3d782887a5a7b20b8781363b0caf9d201e099cfe46812e51f310a637ce9f41c3dc7b45a5aae21d8717f57f64d3eebb7745eedafb92f4ddcad8e134e1f5285c811f0c6580ecd9051f787cb0d3df6b31a6a902a6e5ae7a4a96666dd8ac35b8e3eab9bb64b8728894cd1d469203b0eba473c92ef15f7ce4e0df7e169eb6c5a404c69ae03cf11ff182109e593913469a3df0f591e6fa086e96a0580341d391fdd33a381ca78e42a2cd5bbaa301e8e72a27a83b1ed93cd52d9f5b9d25bdf25d278d0fecd9c1201fa23bb691599b341d35170b72b37b124ef745d4517cb8375a2c784895da1d50d4efa3a541854e5b6481653beff9c9339aabe9e4bb225594285d428ce4b7f24317c3c50dca7e6b01930d9be48c81eb867520cfcefce3ddbeb842c773f60ceb031ea9203b4a794eabc53a6d80bc4727a39000905ae7407c27facfcddd9973808973240f9806faea6ebcc525a354cd65278e35bd6a8c6f40cf724afeb34fab253e855d4e2b5e8f6df2f3d4429e90d85df92aa8ba3739ff94820742ef99037a6880845c25b973adf4a420cdbf03304c5315dcc03e0919281c01a8a9b7e7185da02b0b98d9086fdc29f0c7d2721fa6d061a59be9e400b3800f9c9ed463a2e54807ea3b80c0327804ac71356b79cd199ad6f0048be7c91095966274b3a9207774663534cb294d0a51afa7433edc33702b3e25423b30ed61ff8ec1a204cf0c83483248c3259084c854e7d48f9ae8daf25c5fbfb5c964dda6fd2df07278e536296990c540c6423a81000fd055e134d8c78221bc4523b737b082c21ed803057ac07c26bdf835232a61dee93e68c8bacedf558c6aae7c9ca3c7430dd952d13f9674c3f3734991cc59eb6874bec03055d39b6e8169a161116f8c53cd2d828ba516eb70f50028fbfd82911721cf47874e84e3ce29de9c4c4488617184672b431ec82855bef50326d5756b7fcf71af0a45605cfca86fa447f67f0454bee2f59057c7420b376bf0a0a2552af83baa89b1ab97769b441c24c4838a75630a0c61490f0274c396b8f8fdd6b446c73e120c6f904305cc21c7f98d936e7b68057587f4a6dfc9f87dc91ce55a21fd4f7cccad413dd2feb824fcd34d2779aa5b52ee506d7b49b240b1f57ddf5d3d2f46ed7620a7f32adb61c306d347fafbc689cc1a49137afe1282f6dbd58fea72a5c19ac5cc342b4edf6e7f3da9da14d575099106f1272039eee512a0fd29401cc952095e0a6f196563699ae60acb646d71ae0259ff11ae7c79763eb6f5394acdf4d5d18a221220eb3c58b5ead48d2d98395e463a8ae752e1e74a42c515288e38d9c445f853bd946287b943e818efeff540658731f62d89f08a9b514f4287204c346d6dfe110f8d98fb66aa5a8535a2dab9526e1f249183a09f466a1160b79cfffca01554709c556ca2553f669c856f51f657dfd034c3ba11c57847624659d848c517d3f8c5a3fb3127e32fc7b3958e274","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"ab2beec4f19cdcf7b5c909265e03bcab"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
