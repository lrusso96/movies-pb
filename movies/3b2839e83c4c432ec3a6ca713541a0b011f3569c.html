<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"34c8dcc9ac43787b9c7c4a962703321d38f0035fbf92e1bdda186620c0065b819bec09cc8faf3923e2cf8571ab54e25f745a3257b636c222193ad97f81a4bb2a558446a49a87bf3860e23a232c1a07f336d1ad0340e2054ebb0ec857492d0e8cff23afb09091a6c5bcd507b8e8058ce1e5bbce0e88ccc7f4e1fa672fcf8199e4309a64e80cc2e16154fd935078fe90902a7ab031d2c58924acb83346ab11a14fb7bf83c6d08096497ed2150efcc9f77711ab557fd94cf1f68fdb35bf9829a0d83fcb4ae8d4a46b0b1a6aee9bf081721b0fa809c21d6a8a78d903779d603416f275f44107298d6019deff6a50606778a816edbfc97636b4bfe070af22dcc05cc7fec1bdfc5d0f76366063860744834ae2f723c5240050d9aef8b37490bfe7d7820b907a1c2f0d2998fc962d6b050590c703f8721e2797359089660e1c8610cece7ffc5cd56d0311b9fe4dac38ce79c19779c432b54442e8fb3dfa405270aaa842b413ee9d31ce46dc0dfbbdce600eb6be56f2e04bf0288a15294814f47dfc96d47c4b1d4cdd61b1e3b47b5bc3acdde4e4ae82885903f67746d7688307eb2eecdfb2835bd468ecd5edbfc239d284be8f8bba0b5b68a6320a798dc722e0d498af3d2b180490bdf18d3ada1a192a6a693a0526826c61a9c6b3f9118921fc49de591cf816c7a9709bd016fd3a177d450429e0fa817992f7dcca3b4b1ccca04ec7f70e094da63de429a96831197c98e72c9171cbe544da268ec214b2ecc7414f42245f5a279d61214a7752bdaa6aa80a210ce4727b305de45ae685b6f75cfe081444c11b0a4b6eefc0387dd7d29d0fd986d640d7dfe42bd2fc85c0c8451b6dd2451b3bd4749142e0402479ddaffb919d97302a9bcd65c03cd001a1e598fbdaa5de4ec90c93ee4d1b018c0a833844601c8bbbff62137f6d27e5b854d4ef93337d67c71cfd488ab4643312b84d8100c84dceb125d6d7f4a450a43c671bbc2faa8cfbab49389324c2d3eed1ebf26b932c2a114269daf0b01830929457a62b01e0b5ca70aae16c6167ddca26dc2e07fe5d803752a81e0699194538b04cca353340e599647e275d691dfd09db727514c04779249d6389b211bbbb1af1e120b775ea2d1b036bca7cb0607e2dbc579411f0b0c8566b5ffd7e1f1aa58863bffd5c63f0449ba9edb9e8c29cdb1a67d7e2c458f5d4b586a541ed02fd2a9c5a0ea51c851127511447e6d4a73d86ac6f32e7fd2b470dc33888aa88f017d31550bd61b084c6406818d7f5977f8753c98fd991facc0cca1f487406ed4c267a19980ec9b25c0180e221dc3208fb9db1781a9c5a5d4a288f2b660696fd95ca072cac7983b153d56771768cea6115395cea025bace6fd2471810be3412ae583cb331957ee54a7d89529d978c374a2ec0c23df9915e7ca2d4f9d209431e176bfddc6a3c2e8e6aa54f1209861540fb026a9f2e21e69374d7481aa3e8b4a85c86e1733fe87ba73f4b5f69dc699b0bc03358dbda3191e0dc0e10cf525f03164ac58fee8ecce56be0cd0bede7baca4a391b1565a67f171664d4e866518ece157a1662173165316e55cd30dd0daedf49fb0037a9a51c6ede37790655a266a13dcb0959ba9bc9487f90fdd9aa05388f3b86c5caa75fa44f1a26520a430399b95760c43fcb9ac9b1ab6a8807f788dbfb885dbab2579eaf7849c46e9c1dc42f4d42ae899f58ee8ef690ea567694ef2baf257d0b68747cf62be1aba51f4ec6449491350fb8ba9c5b20e8bef37ecf6027fd49841c6730ad8a532355f62c5d4234164391540059383d38c4f8fc3d0d7f24572a74e100009ec041f7ef0f8ab3a32ee211bf18b08c74b88275c1490b13a97867cfcfcf9517660e583006aa06ea6f6b515493e918a26d7e177f7215d52a1116a84e2697191e43c81b33613b34b703b684cc99fa6cf834639ca9b2ccf7a8bfd28270b0dc75622d67e50e8e296fa08320023317c6cb847f32185c0b4061e235dceb4cf1b3698e9639c14af59c4aa1142961bef9e759229d54adf822df02bcc5bf8c52bec998c2c374e59f2ab4216d6748b7d14403a99b96f4ad815b57bd9063cbf514410992e47915525adf4747b794e9dbb16362a4b6efd98a711459898de5fceeb8a0a1391a08cce293232ff0a4372ee4d297ed7d03453cca84a7f08d5d75463a740d07ebbecbf202281af14b8e1c87f75ceea5b03362901c310cb9347f9c19d90402c8234b567aa9e019a493dead642147e8c392065ac93ecb9cef5baf478a1d73a190c52fe278ee5df442d2a0c3358ff88b998699e63da9e5b4ed520991dfb80ea3f1e5dbca4a1ee4ef04fe4d9574f14bb7349268aa5a99635ef108afefb01a2161a40248b4f75b783ebc1bdb46a6ed2990fbaf2a0f3741de41fa28151211ed2d9d9235abb98da160d2a9477906e76ce0ac045108ff4f272bc079c095305504396fdce509dc764c966d30333b9ebb6d32945e8302db104ed4b7fcb9358d7a85465a12bf05ece1db34d8e492bf37eddeb466f9d3ce88889687d82557dc60d273431fb86ccb509646a3d6445bee612ad2611cde18d6debdd9bb8bede5ec5a26e6f2be54bdb72c3351760d40ceee984898b914a15cfac9606e4d08c8c75e7d823d959a3bca9dad7821482ec52a3ad935c6643fff2c4c97e75a35f071b3ef6faac2a7e4b2f329ea0666503aa9b9104a87bcf16429650a254f7bf0a31d95c762d9af75f82978c41a1d282dad9e1a33f11bf5ee65850ca1a7c1b914e039a713933973252441154d91bb08e9deff2abbd687b2e03bf0a6fe08bc0967a74e7093dfe1f9d1f367bdc30c426bb1424142e9dd7d70273fdac881d519de94c508588efd58c9b398246bd1988c555b9b7282ea6ecec9cd74d68cdaa1eada39f14d7ff9a61dc79af735ace27a345cdadc20561fa62a307dd7f2fc306801a3556c87951bbc871a3022b69e7df218dd6747058368ced80ce58aa4ad74bacc428e666b17de13a64e853a72fcf24532283ad198adec2afdf706bb94a45a97b45177b8af2b1cd19d8a4a38e20475c11521cdb48c34a9c64a5eb0e536322588b5532e842197525220e41bb4522b0106e0f39771c5b308da76b93c25d956d6839dcdfa7da07a3f1e7b7dc0b650a127176f0fe515c39b235d6e0f2feb86be9849f418fc2a3d7f9d73c15ebb44982f0bed78abdc61e25b70a61c015848f814830b3c1cae268ce2e327ffef1155c02999fb4db53e25f8b4734d79be1a32c151927797949f6a7a02aa1fbb192c31cba23a06b891b5a97da8d9f016024ed316c297ff6f16ff87b3497bf50279c2b02291dc2a9d521d785879813271250e2eda570a79d3d6ee8435d3b03d28c0debf14f497e429df2b71aaa809e8c2a91cf3fb145c260cedbca5d38c82fc489c0d4bb636a3ff0bc10c08de235e2aa89708efc7821fea2a6b5b4e90f3a97e7b97b604748e9dc9efb53ff4d0d11fde2754f239287c80894bc162459344bfebd0fb9bd3b116a3233653e6970c7e74ef9f12d638eb8d4e03b71208cff2762892b2a01f60ada480486fe64b87a4da73f8ca17c4da5359ed236238584c9e007f92d8acbca77e14c12e72ab963f13382b44662e3bf496da7a81080490765d1510399797969fd2e73acfcda69821202310aaf215eb9ad063d82cdc2495b74605ff5436c47688b09e5f91f933d5e1886076a3c1aee5a322d62f03de5df796ae514c9c2c0526ddc091d826dc8a4dec886c811d0b2d5644dc36e2ac3d1eb530f4de884b005a522369e9aa24653bc2b7cf7819859c23046cbd55e8d33ecfe80bac8d6d941327d8fe4f267990623edaea23261e1e053428b03f28c0f9635f9ea35cd094989c49f7ede1d365ab471a19dc3faf75d9d3680b63ea306467c7d5f40cb5a069499dc3601735814c5657628dc5327fe84351a25e22c92acad2452611783ca9aa0dc594b52774e7265d89fd6f3cc91767e7f86dafa3f9714a97554132afa7e79ea3acfb774448f226501869f1b3e4f372ce5605f07260b17a562526670f4d8fdf62f16f367cf67e0eb333cb87191005903f85a98445eb799edb2253e8f7c9f45629d250cf3a3196d74ea1ceae3d1f667dc1de37169ad620482216e2764811349e6fde43bbef00d9eaeeb9a1d16bd05b70cf51cad9b4ab463b7c44f879eee61b61dc75210538005512bf04522c6db7cc225fca3a1cfed16e317be8a068c8de6dc57352837634bfbe13a4500bb9cf81c3e0220439d65f7fb25db6d670a36ea894758f2d148e0958068d4e0bdca777b0f240a87e56133d73807a8cee024c993be380e12e70db229a2f226e5eacee33737db63c7a97179f57d4d61466490fd996ffab5938189ebd18a5440d8d08badc95bc62b86784e218ec3b0f96b4e227aba05e6aee64d5a9c15d01e3170f2d4d6fa5bdbdc172683651bb2160bbfc3f03b75722c69aad450c25c9e3df38850630fcfb56bc11325194703d34044f02bb4d4f23564d6d4d22331d51ad9f5cf17ce78064c44a3e7ca3270c8ebf29bbe2cd84597690163d2fa5fe330189142e5325620f76d5e4a5ad3933783354cf5254199d8b6dd02d3e2f271d1df4fa956f9ee0efef6c277786f526b2974582a97509efa57d6a48c8bb7e8a202ebdcbd054c69f9ec0aca735e81bfaa15e6cde14e571a29e3242fd88ebc2612d23696b16fd2ae5e6fb8b3731354128a740f0e23384ace65531c093b2dac307185f575b435ece0cfdf43e77d27e68df53781448378372dd0d64ac4d8d0cd3473814c4f1a76e6469b44340f479ba2e63341f3e29782efe4988ed75cd917bf04981ad8bfdbd3e738a5c4e149bc263e398365400bf0215d9e8f300510f86a7569ced7e6f855f1293175d1af6989d10591e87418fd901277a3cc02c7b9fa666fc0a18768070ad4f13cf6bfa203d8eeccfc85aadfe75ea0b257c01cb4b21214681b6fc2df99a138180f9e4bb7939501a049a290f8a30f5beb216c19c2a6101bfa4400d2d871f6547b6b9716b5fc59a1cc4d28ff1f1bd54e093a226e5d6ebe2a89ee144e61642ac2832caf0256f0adf6c554b18f14c2bbba97f07d85827c8b0f553c341dacb26be87124002043ce59877810f14ba43c3ee70e9d6ebcc0734ccf98d6f2535e5f4b24371e40dff5583ec9f64ddfa64df17ffa0b50692b195d0d749b9f5b9c19fba8894b191b2d73bb21f2142505da066cdf951bcd7c37eb7c503f384594dcd06ffeddf8fb3165d3e839da739a8a3bdf5f5af0b90fdfc669fbe07cbed11626a3c5cf0ed05c7790bf5bd0c09e21cc8dd6255000b75dbfe02fe6d4b128cf3c25c8b5531118c44ad8d73e0cc8e66b281f4a7ad9eb2a1ad50c0798d77d3d2fc40759595a7b0908c301d691d70e27603bd60048b35f333b5805430a2b0701fa05ddb017f34d0e9532d132544b65aeb12ca650967becba29cccd4825f7eb40ac8e649f294e9aec2501b6b44853ac9875eaa1d3acccce4fa87055fe32012c55717d800f4126084a41caa91b14e4dbeced1efa4653922221a0de1fbd10dec7b21a64ebf3e0b5627d9114d0e42b66325e0955671acb04bf4b0e715c50fe61adefa7b0cba892d6d9bac1fae1f49725f135949bce50da123fe955cd2377db6379e91dabd5c083c1d18f22dec4cea6a73fe09a29df286733dc3fb4be1238cc3b9bbbdfd9d22308c58c21cae3eead408597601dfe023ed6a6e245d5d43a6da8b53a58cdaf7b344384076c7920d5a6513c3559919fadd7c220adec145dd77434a47016ebc16fd8205f95f72a27d8b124d5f95487c44f8f69d1c45aa7bf6c78c45de3f443e3ce05fe039fecf2363642038482316e0cf30adc8f0b7ff863fd9fba8901182ae8db3ea2e9ae77800323f5b942b764f00f0a252190611ae6c515acd217d4a8ea14809be144d2a03442ba080d80f864c8ff6bb3b2f38251c19035da7111dde1f218fb0787965d0409fa950f8d2880dd009939f91276e6630c12a18628c0b4a3b385711f8793a13f24800744e5454052752c02ea3372e3f9e6376bf3355c9fa67af2405e2df643feb292d510f1bd78d8a44bb08d1cd8b36f991e8718dbf6a5925a1aac4dbc0fd1eeb71a14a75a8e75f4dbf26be8c5607cbd1fe39e1ca4c7e43887e42f34fcb7e957dfb87b17ed260253b16cdb505adfa652cfd193b316dd2dd6a8b3211cb29f9891249cb092d02535addcacb896c6ef105a798c7c027b468018df48638a8e6e926b89bd21f33da17a668a90ac31407b24c2fe6343ada2aac2d2d097a5416f1450fb1a6da29468e3cde0a6187dba8aedfdac1234ff0942db422a7f2cb715593b845f742d4e95b182752b7a0dfcea8e4a7e7cc3cbbceea74dc87ed0313b055cd2b8bdd1d70afa8fd9383d4bd5dd43f680bf5bf9436f9092c0cbd1d9dc2b63b84a1329a72721d2cdbf4e9518b4d03cea4aff56149c843ed706aeeceed30d76157a73d0bfb0053d95c1382de2d690c7373e17d46e1a74adca121bf7a98b8ba47b17fdde09e3fe2bc8a290628f8d06681397a35d8f90ac31ff4296366d8bb4bf767dccb620dfd8ec5286c9cb8c5d87f954ede43b7741ef77b3a0ed20b5125314d8062d525fef2208db99c218b8598886ad458a4a73527941c97b30642a36c8598b5dfb05b3e7d0abde18946caf21dc84328c1bde27afec9c264f037f5d6e6b8600700746d1dd056040978dab55aa374566e4d182bf01a28f8015a1fcaddff8c4cde2df0a4f0a676f06e66e19524f9394c0e3fbcc68822c47d34f717ace206f273443043e62edb1e42a9a59ac748e664ae144e6a10b2f21ed081c9984eae3e668a72bdd4d7eabc2f12f591c312b56b154b59439960e98fab1829d798c063a9972339f0e141b1a85ae02c27ad0cf8e4c5d42c97139d394b175420089b082ce528eae7f98b27e6fe966fa25e57454c9a787d74bd12a091dddb507042653751f2c7ba927b46195f54776af5be9f196dd05c971460c8ea53f1a83e7a84ac5c525edb8c889f138f687d7ff702bfd658a94667acdde61c38cab471dfe9818beb46b084677675eb75b908088f1a502ad261e498308015f3fb26cc6f3bff5c057d9e771aaeaa33b6cc62ef955775b7d2f83efafdbfc0eab2379c1b29cc5bf0c0bc56495ec93d1106833eec5043aa151747216d17cc796ae4b3adb1a33394e2a37f3f0a9824e4c86c0a197dc8eca28268ecc5f245f435f85e83dcc73a140e8344011d5f791e00c4b49d37e6881e517026217ea654fa02bdb756457744ed3ba2de1002e8c3877a737d00de3bd621fee203c5355222fce0366f7f3051edbcd36bbe8401e88f6adf980613909d2b782d15c97aa2e1c15a6e2e12eb4bdec6d79dba83b51528d38c3f48283214afb7fbfb95acd7df56318f4f9303295052df4f29b941ad5269ab74a70c6592207b5bb20997e0f7127481a0b1e5c4962bca98187c9b17013aa8d7e76b292327855ef72acf8a7f60930365fa44a4dca8b0126bcfd0c6fffa8b436d9b248e2158919fdbb334255ec66553af8aaaaf3567efc2d53a7533795db985add01ed67e5686841bf5a8f361f486e58b9baaf6e9641f91188b9453c4e31610d96b381c5c3ea7af4d45aef62f5d77c1e09cad2ebeb1639f68b01fde484a38f320c48b0f9b0fce140bf69b624bb8c791b282a162cf030609c6314baa87fd3fae2ca1db8a17b994beee64aae1e9f0433f251fb3a0fab53271c28eac770d284b93d7042baa729740971fd6faff5f48256ec5fee9c19ea86347486d0cbce2a81e188ce21971cfb129fc39e99062f995a4dace09710b6912af36bb001668b045a7890f9dcc5eb024afebba962a6a7c30f6a238271868e1ed6e593a461662fc6a3ae30836ba5b18c2ef5fabe5b63fbca5687c96f18ade5903b0698e950d54582e3d1b05aa9fcef989f572ea5b5999357fd777e0ed25c5f87f9e60d3411738c0468033b8b2264ee058910c183dcbffe8651854ce509a9243d71b851c36e151ea11814cf98f0b9348b8974a97aa4e7e6c68dface6675bce88e96cbf5570c318e243c14dad5ae6dc5156b237a4e3faccfdda30aaebe9f8d3af4957eeadd57178db94147ad1057d9b58322bfe479d77682ee0b4bb34a80259b80a5e80a25255894ea983db7d922a15598cc189133e3ecd99072f0f1768c9018d46bb52b9dbb539fda510ba715dafc744923f30dbf109ff2d789405f63f084ac399a6813fbcbe5f8b9218298ace7c94cb4c97ace6de75091b390ecea5ac9df1df74e0503fc4b76c8dabad59086166b4ad0f2318b2a01b1205a2e8a0081d5c86aac2a3d9a97820589930a4c5f92acadbb5322fb713f8c98e6c9c2a6eced2bdd8d1e8ee04d423874e132a553a87c21ad89d7203fa3f9d476c86c32d5b6e817f05e9de579d73b37a7012cb9309e70f1b3df1dc8d0329847299fec1e99a1844c0f85d8f14f2e502c75d7928da5736779241a8b56d03c3ae97b1bbbe74775d034b398da5f86c4df5b50509c0a367f42d895841a717c11ab29b2c6d8f1a3bebfefdfdc05bc68a8df462a21389110fb4a57d364bbf71885ebbf81a04d22802ce0811f3ad6e50a75a27a1ab42801a8f4efac23cd37bf96ca19797007016271fcb3f88f1522b339fe58ea408bfd88f4c494ad766600f2bbb3ee529e1c4f5fd87e51a4e705433c627846dd7171a23697544d6c43a15ac79b1643510d1977f7d9c5e72b0a83351efacd6cae6dbd36d16161b309359375772ee9eddc638690f1d3eee001630cd35f93c466310f50938254b50bd5d6b45eccd8c79e7afcadebc0cfe8a33551ce5d6a96dd8a76ba888d76332742fa338d1f393a615f4328a6c84fea5264baafbef3d340f8ca73a9d12871ceb23f84d032375170b2966ed34c155195872addf2f5210795bb84721b853bbe1b333d08ac3e802a29bde00ad4da9ffd07e847ab6e7e67e6f78c83606e1f105a903e30711c010e2ff837b47927f994e304d3eddf0b2da3ce7688464633c1d808d48b750bbf1ce6f4a1f170a37df9ebe70c95547a949c270e857b43446bc717db0efdb23b1ff53f5319b48ce4c858804e684310b6272c1a67fc4c6fc4c6d7c0126fe53a179a0b54a64dc74ee5e2022a725d4f5d503578dd0b1eb1644c6046a504968c2807cd1b2e4e1f9f4b32c5fbef71671acd2e8ffd4bfc14442714ae7daeeb0cfdad5e736dea233a5e4616d38e135eb254784228e5ef2d981c20eaaa6556039bd15c503e13036cff64fce3b06be189ce6e23a7b17a25cdab9456b927d2d550076606ef23d033f16fcf7f90d07b95167093587d5acf2a89af378ce6db3c020e637d45f32254e11d513117f54a49cbe77788fdb40f0397bc825b66a2e6e738c0b34f88ecacb853afdaadb5b160df16ea78006fa787028a737044c85f60a7fed54260c103027bf47e9679d087110d1e2643cdf02961738ad15d53a22e0d6b24f09a32afcd2ed6327d8a2237bde2fb2cc4e9dadb5d9d98cea755b3784cf7bccba42cab1c987cac28abc3f51aef9d69c2c0df03e1237d82c7df7318f99a57da13ecb5ba2e1a74d7d5b28b15fff4ecaca3a812b77d157a5338f1f50f87da798cd859b2acf00935a44242cda1a772cd413228e5846d1e159888e7074043dcd9302fe4584daaa8dbb78e52a642cb33d54afbabe87db01a6cc7ac002363da3acbf5043014507ea9c105afeac283cd85f5fe1d8cb3fb39a3c31d31390b648514c3384d114bd56b9f3fca2ea621ac54ce2630d2849e89abdb853eca3b95c268844268dfd61c4d9d6b6f97a42df3ac72a7289b1ad8cac6ed7209c5591fbada3bebb3f4ef960a51b361761d7af747be36365d4e9aca643493990c4698b80e0909205b95fb62e8e6f5793f77391a5751fdbf2dfdbd9955b392e323f645d18bd0d6f4f2b151025d3c0366331e213f9a88b350afb179c71fc7114ede5970adffe2e5f7b673703c92e40fce15fe54ec217d47a34a71759819db078ab354d364341fc067189f76f3c13e875cdf26854cb82bb882c3be283ddbd9dfcf94418a918512657f5a08fcc630aa5ed1a10bf9fa852a097d31abf6a31dc39126527b6c41d16d8e02ee36734f69a990d70fcf83b02cff9d2448acc1d8e05f3c6b8c6c10dc896871cb38ed35edf78cd3c3ce55a60ec8118938b54093157da13520edee03c749e154e120036c8dd6b5bf52c0908730f8228f516b089de3e23b7bd8d28ee6323f768d736c494d6044e4688ecf760530d78b90597cfe23d114dc1885ff718b15f81b1842dcfbd6493d8d53b1c7faffad0d28e4a9c775f16adc03a60b00406dae08702431acc9e7faa867b7966655ef21f29339108a5af5b9cae8570e5d2245856e4b3f77d38e42d5c3b94067664a755193e100c11389a7114accb44afa032755271ace8788be4881ea2268bbc47c52837c148d8f5b7df09f772567b3d589fd7d0678c29a263b97682df94b3b480cdbb1e18b8bcffe117220fe02c0a1b374c83e4475a54ed5b87dbf576a7848c25202961cb96eb5f158e0af3e919ca13ab624bcd6a64e7a1fcf0281bd916c430ae82e3c5039c8775e9aa6a80fe9babf3b257f431a71bca29ed9f222ebc505932142fd23362c568e89ef7d93783d99e70e9b6c07829979b0b5346d92f29df151fffaaff5edf3cf8283c263b1aa2323d1e172dcbca43b16c0d64e097ea1a5724d20fa5fe39d5a337e518a985efd481a78f244939018b14e908c68dfeb9d6844fcd8e0a73c725012cfc0988a301ad2fd88fba13aa29b9f1f0a887eb9e75caed53266ba88d0618a49ca441d85662a76277f5516dba619308c5d59fc94843e4701702c7b9ea241b0bc07d5e9fc6ced77ff21f5024254f3c38546797cba26aa2ff4c180059b7f389bfbc2ee5f9d39c1803203a0cb7636d34643fe2e077a6fc5f2990e5c6c834282d6190837e80dcfbf317614b3f85531cca1cebd74eef4601a2bd4d62962c87a2c945c898a93a37ef9407ff76fe7812f8aa0c30970b4ca146c301174c6fb2e5688f1fe949ca05821ce37653af6af22634d231d8262205ae7a3ad70915f7f0520dceab6583c03bd5a8914bae408bff9d19b0d2dfd377f8a62ad26c740114e27bf7099fb0344c13de8597b1529c76bc999fb63f9146fb2e36465620290591161a9e393a6c64ffb9a9097054eade280362d3cb3422547d960556a7651cfd1d38fe5897d7f4c30b184c9fa386ffddc137121c1075e35dc0a33fb91137cc825e1a0fb56e1b7bebaf3cfcf50f339c02fb83c519a9f1dbbef65d58791851f3e0e99e5d1a88d1b8387f68e6414b352d997196c18c854b3c476ee1d4db803944b995cfac7db186fe7bcdaf3384fd2a90e236666ec3d848ff7287352b6b4eab97a75dcb91458ded1433d8d746c3106ff0fcc60c3881f73a15c7baaeb23892cd56faeb5be18da6f175dce987431406a607fb91b5ab716fc8e361b4cd18c90e712c1b776b59b3aef722ace42beebbe4d03e13151dc067cd0ea6118225624b7d14b1f3a34efea48b487dafdf9352e9f1fcfbab270d9671a20ec8b6b2e6639704f45155bb9b47e2ed07270618ad434c877d65cd5c3a5386af97e4fe28bdba3fe7ef372f5fe7235bfeca7c33bd1244a259df0b0fdf344608c6622bc3e57c2493fcfa1b93467e4c4fe037669c94a3a29776b3a0aef1c18a7289542b8b094f9715256273947a63ffba19b31df275ad2a05d81d12a396d82198a906e6b9d7074b778f0d5fca40fe338efaaf120628e70e9eb9f40c04879892df7ea55ba3f185084fe2951571e8dfa64c633090914ace51f03ee1c845da9364f5598c79465f52ccf506582047ed1cbcfb0f2ede0f8dfc1dab7d2c7738be08042608d07e6d499895dbbfbb2f925d476198d6a10b7c641aaa3913d250ead1eadd71128157075977dbb24007c65caa293f519fe68bb9f5279adb627b4a5e51f7377ed67f87598c4381394ee1f396498ea4d5c3592995e46beaa1e6150c6be0f5c72fa15651f71fc8dc69eb535b8250a1a1055a42e31191a925f734ade8b7350231f91d1fb14be79e8cb54308ca126889ec3edc6927f2ebc3894cbd505c6dcf86f1512b8210b7af5bb647fc319a9aacf9faa429494bfdb3bd9395f82c0fdb6001a6c5b0fad7a0f998269cb140de37bec401d56cc6d53264b056cce4ca79b79716a9be29cbb6b87872d5ab0e9a51edc71c3fe721460ab0262ee8deda4e5c6a9c26d146255ab15fb0e7f814fe0da3b267d21e882ae63dda68d95c461328566b5ab21359eb59cf9f6af6547b941268a360102f4c95bca911fdd4456bd23daf513fce9883dbec2620ec0b1509f124addb04c25bb5b06b1164134f9e7713bba491e6699b9e6a45e5cfa4ffaf8acabc525c22723f367a60d3e022389d56f5c8ff7e4246d930f0d96395f1330a438cc8dc918ca06045b6d1abcfea31a5b9b039723057b4a8f23b6b8b35a7600e9dd1d77721d67314198bb56a97575b3046902df10c9a5204acd9faad56d7d0ff24531082f5f4c8ec89137579e4fd62238c64ed3ed36fa10cb63abd88ab2089ddf83fb2bf103d5883947bef537d0d303a4e00ef63ca8b07fe8f8ebef784b1fac56a8a976c70bf577f17c1f20da1829e295d36fda64ece426a543fa521efd20d9358c3531c46723bf6179f5aa873a1417f3d4af7d83758b30ae1d74069b492614f010d457b03b6c3d9c744df50a2946cc9eb1ac97b746c862f290f3404e4768722aef6f8ff3b2c8403d5b1350a5075fc6c17673a889335cab1ce523574b144957f697d3c4f7b5b9712a5498f3bc4c81ecc6b767c6bc4e935f03c05f7d839740822c5b23a9ede4a419e56b1e4bb4937e16c4426867511357c3f519a30786e835cca7b53250b05e4a05289626c7827d06ce5ebd204bda730d045299c3b40b9871a0b1e54bb4c2d9a8b0bdb67ae9ae68bdb8df28e0b7c169b502a56b098e19a64c8ce7574c4ec7fbb688bc9f9a654de30bdaec7bd64752989186e89cf19fa09ab833082354b5365130c6b9287f7a3d36f8ff0e9a53f6676a05757a6fa11c614cb8ee89cde2aac65b029b091a68140bd6d1eabb14b7bcc4fd33d6171045b7d84691792c7be73ed5f80e46e82110fb9705efca59df5c77a4b7dd92f69243a3a3ad190b085d1a507b552b6abc9935f2cf94ef8043ce9ab13db608724471e74aedb5e670ddfeff9ae636e749df4bccbf57baaa9d50ed75aa0e647bbce4bccfde0f2a8545ec5c09c7b46d76368b1dd12743b776a553","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"ab2beec4f19cdcf7b5c909265e03bcab"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
