<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"2f904cf2928a389d50f14a6a06382131246de49fbd520efa459423fac1d8190112b2e1e84e5a1353f54a57df7b13a966cc38e173d2037a63dbd24b324a1de04d2ec1002ae340722f4a45074e54c5491e95424466ea5df7ee13bab353d404741dd51d0837c5f7d1c795c32e8334bce94881c36d193b14388af9ad69ec87599a1ddc3c549bfbc4bae9a29c0617e7a24ec4cf712f12a885f203e40ab3497d5162e1f8a4ddf9beacaf4eb1b2992376f8eb0f73e47d5588bd247257c930b57a72813edf0708a46e4c56d9aa0b072a0369c47b5eb8e97f5d4370e37192061ac9746fd44eda7b2607ca1dd5d81825c2d95b5dd0c61ed3f59ef4cece328393bb38956bf945a9df55ab23527fcf585c8917df1f8abfd1a468478562d07bbac0b30d7cc4e6bcbf60380d6b178d557f9c40cecb63fbddc1c3817e0191842128c0333addbd6da2a21620dd61f9cf3aeb76b6aac88739663fb8248f360c0769bbe9ffba7b4931cf40736121639ca13bd387cf84f0936c6a74c0d797e6dfc5d5f372bf43d9fe680ec72464c0cd3dbd0483cfca94e852f19737097fff4f71f9ec9447fb29d108d7dc41387acdc53700b025cb6deefaa8e0fb4e4f430006977e9bb2bef0826c393f19cad93fac9eb22ed1817b89788c653f7041d10a429218bb8607c8f9e32c5845494b88a0aa0ee258d596e3c215d80dff64ba51c6946c2353147fc607e15a19e739db7463cebe33b5f0cf14008e85812a1a7cb3886d3b5ec111d4f321bd9aa1d11f1c16763878e2dacdc3bfaa2639af56fd7b85a36cf7e3497681b18903d4c8d3e7833876d1fb2d347c68e1ddf336dc6043ab1fb927d3ba8401f16d9e7494e2689e953052b8c239a9cfc1e8e23d7cd071ce13a14615393bb82dbe7d31d86c8710d7716eedd4e46cf6c71e55e9649605adcdfb64348b9f9d2c0d4ff70b4428488f4ae3777cf24b4f027a1363eef3a5880a1a0fbe951953a1fe53016ee609457a8e84e4d5ff8b5c5b98184fc4dcb9e3039dd18459765b37e412ca2f72439c9f5c6f68375287549aaf258fbc7520b539f1a29704aadb1f42b95a84a5418e43b23c34ece5c39b01243eb8b0888f187a72985cd41d9e24a6792cb1953cc739858cd5c1ddf8b60eb1faf247b361fe1997d0df938bf54cbe6795b41f619885696d5d8dd5f20ece70b24c57064bc9d3066c578a5b8cf60ba544559103e4dda1ea2ed7e0fde0e966d2bc78a8d3dfb1923100bfa8889c0d08ca01fb9b56544b55f5968456b0b8a68db3e04efbf535ba18e76a4e264d2d1996361d27f124a4dffb8f7c6a9711238dac03ebd96700df21b2cfc7db50c75017f486ad981de110367ecf740a8ad3bf69567a24444d447d0513131b88d35317ffd5a9b3d3a2412fc9b1180d4e68fd5721af6096f5e5fb44f35b247df5fde1ce1c6a2be9aa3a46d6ed5773f83a2dc06e4b9a75a452a623d76366ece2933ce072125f8e0dceb3da84f66acc9d7c496290c02bac5348697b35820d2179de11b4a4d46cfca134794da7a058fb82f069b7ae403affa4aaed361acb22e219337e3b8e9db86df993a8d6cdd1302a3fcc2a697e12cf95addb6f909754b036bf5143a4ebc6ad52796876fd9ebebe88ac82071eb40c3c827f29eb0d69a322fba93e7979fdd4f0e9106dbcbdfa375605f489f1bafd7c309db72139d5c5913f0ee35aedc49eb760df1c1b34e3f965a56250d1f6969a751db6baf4941f7fca0ef97b15fed2c9325464643bb3da3d780a6b9c8fb039cd793397732ea6085af0731fc864a018df37776b64d9d165202fb47e68548178fe4a1f1ad78349d6da7b521cf1b93da9dc2ef56d6397746b7636107d6fd77eeac817ddcca41ca292b93b3b3dd6da12cb6956c7eef3ef337c9dbf93bdfc92bfb6af1f0e099c467a8a39cc0851f011527eaea45ae27656238acbf71af3f5fdb1209f88c1ef5dad425aaafb3ec0d268f2d99495620078e0e46982ed8f0128fded65cc099c4e240012dca355c97fb414f6ffc58ee4c2791101a6aea732884eda7225c56633c968ce968bf589bbe19f06facb2a02bbeb034020bce6aa8c8dd09e42d041f17c17d7a9568c91fe1922ff966d9f0dd52b8be2c376146970d5775da6fc1ee686151689745301ddcefa0f3381b2a2bec2847d9b4cb944b7cd1c4146ea12299aee9c11c21e76653c48ef6d92bb0ee6e8355fd6911defa68722cef5afb1f44991282e0bdcbfe540cb20897d14b79fe898796c90e1677e85ec4c11faed49d2d1b142231d048380319803c2e8598a6c6c1b45907c925f1dd165e40a9ae511b09ea9314046a01c69267bc6de33605eb8cdba1c8c6c9c7ad74688725d5e18263b02db10b3ea94f492a07e8df912e0fd73eb919ca9115835b3349cd81cea88ed0b151aa83ea082dec255abc3a9434a423437311e4fd39b3e39fdcc6c3a23beb3d09fcb9ce7608977b7edf6bf18f1ffd5c62a4e6171b959218ec06c2b9dd4fab9dc83fc14905a5af776feee8405ce98276d92c14b9dfbdef5c7f7d523e6fda2c23b6971ee817c17090fc1b4dcd06c07a47be72f686ffbeec9c2a25f9607ce0e5d0f9f7f5585086c951171ffe830ff369c4c1ec343ac1e71dd261bbb5f543884d9e5874f789a71e5135e2754825bd8b3954f8ee87d0ed444c784d1e9d73ee6bf098c80a07391826350f0e3cce3f5fa950c54d9318f294e45d7848d8ad7bbd1f7a9dfe858820c6542efa8c530bd1cec29e2c49cade54b8b6463c91274c0e61a0f7c4bb49e0db24d34c0f58751b06bc8737f84beb8922bdf261bc9797216cbdd143b6bebfdb34fe77041a964b8ea7befca15e3981d8c439c8a67e628032df56e996f79e3897063238daf0dbcd43c3dfdea95cfa60e300273c0faeadaaaa982a0f773b26b85980b1281f4f1576b8e29f2aeff3712ee2f366618931f0bd788c9226451daa977901c36f59692125bf2e490610567138bba868aec13b801b662175c8da697246f79fb34835dd9aaaf7627d2d319717fa198a71b6183be68b864518a2133479fa68b5d430609ddc0ebaa61ac6031b975c4c580cfaca49982b6e5bdb2d4e137bb8b482a0bf25fbbd00641f582249ec7b1f09cb6efafbb413397af21ce5f86e2be46051d3a36ad191d7f21aca4293a7a2db67d417793f1319faf7764322b80ab3713ac0e7151014c4d253682344c29ea9cd5ea02378c6558a0bde9233cfd07c404f9df00eff9d9cc967fee1d0f9625e7f46c998c8704aa5d1aee5fc5dd3dc2d14c9654f09d7d623c27644537b4156bbe13f1f87ceba0a1e8bf67772752e2ec10d1f24c99dc2ec2ec696ae25fba1da379e403053c65876da14a7231ef3d0a0c5fb975e30b59178fe76f4409b15e7a406e53154d579e6f115ada807ac387f6e437676f3075c44c5b36b859aaaecfb1dbefee12f8a349e789ffed44e8e29e85703c0fc057681063506a387587298a5b228d26781c31ff3585606b26e728ead7b400356c0bf765acfcb7104353451bf4862ba4b5e30a286bc22cbee87f27646c3a8318367c43fac02baea88383162daab6eeee6202409b66d45af3a9ef2ac326259727cde5af077877e967d7347e696357f5de500df83fe910f259f55d7490889155b574536bfe2b1972a191ec06e439584b208e9b8701250d8712ccb1be96b548b714a1a03fcef1f99d5a51c9c22443531526102ef3ce6fee387551a531314360a603d18fa3f60301747150df0840d969b2c5b096518b39486103981661e798b536418dc09dec60cc206ac2a6f2e43aabab8bdc6c9bbb82c24e317ffd7f8c094cbac23b7268b77bb0c44c898b99ac359f9f5313c2dd0b3e0b87bd69c1f7d93afe814d95d3c14086f170b09dbbc46b66b0d50893dbc0f8e5e91ad853c619c96224c1ae5f3d73811baa44e16aad7f7ba449aeb77c8ce8bbf3c71b9b4cc28c9a6c8e339d67585b7a3560c229a59d009f1b8cfa73c904dc8166179392627555491ac90ea534e51b8147300f6daef8becbc5cbd788b0ba4344b04f68d4e673e79f360cba6f3c08bc7553265a381f9539dc9a808a1392dd273c9669efc03983203e07bb8790828db5292cdd5d7c48a3a3324a2e4037f13b803629db89e444e7f87a47be7c6473885bd5306e7343801461f2972a465d3e5fba9fc27734a99148ea51da2eb9d1263e4303f5a1654c2b3d2e7492395efc2e6557cbb1d0b4843b16462654ebe489d94a61595c8d42a7ea494e067fcb5444352d3b62d4e54fb34f39f26cee2836c17e80717263fdd7f66b93a62b4e2eb68b26bb559464ffea3d899d6a6e8ae2ff805e4dde1e373b3e88a271905c25a90642e47428ef46796fa04c01e57bfe26bafbe4b43f8aeca7ada2d7a6bf1b72b9541c8e60af35b64d66c30a417515373e4ae40b6b2cdea510ab2ffbdb56c112b994fb46e1917ff309725b7fb6a618aaf0818652cb9bf084344741435e38dd898b3a0b660040c7f4537f85d9590d1a8967a9f46fe9599aaa4268f5677374ea31c2088a3d363fb03e44422cbc742bebad61da0b2a7b536ecd3524bad69aef00b7afdcd58db2efea55f3d0ade9f4843b9f653ba1c52c4f84fb6ba359b4e92a86a5d74257da29c23f066b36e6ba3a2b31ed09c6bc3155354a780928438fc4e50f6cacb22bf46416b817f2d8bf1a7888449b5802f8600cc598c612e174d9b62a04d4e56cfe252526421ad9b8defec5f94d6061255b1ad404c825bfbff642cbc06040244db3dee7407cee26a3a2979d138cfaa9e5e9d9856823c3318a7704f79be5d1a616a53b6c7e833534d74ac5f755e77e4b72ed2c11e1f3ec516985397f47c12b4f56b17acdd3c7b6e3e497bdf3c5cd843e867c80d6f450274c1571525a6e1ff76ef4d812922d25d15d10e4a63beeb6a9c4b60cc3142dccd7b550208a946f74e67177ce026ccd081958ce21f30a60d340fcf9aacd47c86b01bf64ffe1c2d20a626c8f0cf3fe50a1136174ba3a23aa1c9bf7908f27200a4545cc5b364f235b8afe6ea641d759a20ad38a1035980a8e86a4d0a04b0d94d59c58c0540f64c3418aeb2781f31596df3bde9d9b3279fa845d8589a6e5a6e188dc09db2cfca4a6be9957e61ad84300c6297f958bba137f53f6cbf2084147e4f41086ab3dbc5ef6af22d3a33e85f5d17484fcb33b572b8941ae35c97542f9cf0a50895b758b3723a10b3b4c357a901b7a855a972d59542e99811ea3d342ee93d9184fbe56f9b670d6145c4d6638cd870599e3cec4de180cb1ad7c59ef271524eacada80f0c8663546b434295abf600511273db69e6eaaba89894a6dfb69f7218e3380d0d56f1dc345962970e51fca24ef30491b4745452e22786fea47e058586921d4dd59e1a7b36bfa70dd5d340672f471b785c408a368fef6ec22f9bf6f280fd24532478bc00829c04403865475f8805100a33d9f602b84a89b2722cf17afa70a70059d275d79641901f32094d0383e9f63b807363eabc1ac5ff0359d456645e1a611e5d78dc02683143fe4e3d6aa854b81aa7aa34a1b19610cfbdb3d103279b644132f806ad498d3264c039c1fefadce2e7bc455ed4848ba907913e472807544837a60882fea6536f99d37d2b1cf7ddb2555fde7f1f6ba6cc71de7b1f21b2b100010dd9aa6e00d8d5e948c60625d8d68c967b019f0ac347b2460424667139620e22cca923dadef53bf6c5aa9a9e8b785484d88a5bea695d911d937cf8519deda5b721659e21a6cd6abc1b1b473e902ec7bf8e01db62047ef13a8561ae6d328c7349b4430d2f6d739201b629435f81044e2f63a5b753b6a5e09c41a039ce45cd9b8448e32a15b5b9a3007c858000a6994ee5223a96369d410b8790b8edaf6a1bddbce70f3fdd29ac559b1bec14474727b8079d3ad2cebb10fec57462a0aae5801ab75c642d4b343ada442cee4390068858c20d1511738095c9f7732b214737526d5f8ad79fa1ff77f407a1d5be2a2d7e695726f539474972e205b91c55fb09fa8fab0625ae0978489c305ddc0a041a91b9104d4905aea83aee5aeaa5128a9e807e46fba61ab03636da3b2364df80db06b52d9e2f98cead8fcd6b019284b8f3d30148cc7ba6d1071c19976943ccf906fcb5afab3f8548452b57fb6af305196ccc6dceafd1e14a92c6de18ad583b74e1b3b189d6c10d36e330dc4a03a46ec89c2c1599514271a9f84c142688021be22f785cb5aef31a1c55012866036b2fb89fc870ee7076ca8d3e4e11689da63f247c6f23e3ab2dab46e59e6d6515721cbe8bbb51d17241b6f331dc362b8eedd5ace2ade5c22f3f39b97481d4757c1c52b4c4d457c4fbf937daca41d7d2ab3f8d570f1d134161778e56f28387eea63edc879cf95a56e059ffcb4d051a0f58119c3339ed60e9099402e040096ea52d7b5a62b4581394526cf3af145c6423078b446e9136cade3418cb0bbe043fad86cdc9ecbcfb0761235c87787bc892ce95f0fb31a634d8750f7d5381dd1e37517ad293f1ae6312a953879db8700a93c25ffba4b5edf311e79ab32fb87706c85c0041c70a6cb12174db29817182ccacb7c8f0aaa4d40794561e27b288d918c4a3fe2eb148d1be8de0843e1298120d8b9e2adf68c3a6f8e02c6a177f12000d11897f74910b4e4beb9944e988ca0a9482c7a08e77c634bb36e2c47a7ca5681970d122cd326685bb9d66593fcd55c968bdbaad5286f1f85cac7375c11303f30309c5a6ed910bd2248cfc1b9de89bdf1879350ebec04d64e2d3bdbfad28999da511ab3d520eb3a04b92d4729d51c598d1db7467ea618fa40068eb1f9b7f0dbe568f27fe0066b1699dc2c8f2b3932917ea1cb6dce2fa0d0001a920a4baa02df0b97f5d3d433ffa19c9e6891b6a183c99477ed779868b790b31986256c2053fe76127bc7238a36d911d285387301343b828b3cb457bbeb16f10c3cb4387dc912ee9e8feb2c476a97dd22ee07866ec4bfd082a58a2b5d3bedcadceb63ae259ab8ec855d89707585085a2a8052f6275d4d291482b768b3717b7bb6186edd9518ab527aa0c2615f803a0ee8411a86415c67b9b635457dd354136a54c60a53b21ed7b2fae1b0174c055b0c9adc2ebdfe93b0f9563a86ed32e4984693291e02542490143c136c33521f21844eff95916c0d94a2759ada62889c11603a3143e7676b52d87b0d8a0e096e63b6ca9ed0ee48e4b76dd701ddb992201b468bcde9ef3a0b994a6b868cfd93de4b3f4d670b20ea6daebd78fe2159d197c9c5a27e53f96871fb6e0142c782956fae615b19bba5a133cc0067a5ab44130be0a42bb9f7643a1eeeed6f0564fc65da542dc515acc2448821c2b879c1d335ea3e497fcd39e2cfe263e1a0de007ddd841b83efe094ee010c2435e67c394d45f3a4ecb5fb5b2ca1dfef0ab11c13657dd089cc4ecc8476e19308fb949adf4dc3d8c5f1b8b96f4d84db3aa7c9af3469e1be1f97cbfb93e52bb89b0cd8a3811eddd924336d10f9fd92de8cae887ca9041da80caed78dd7b1e8b17f2b8c3556ec7e4cfee18c47ec5ef08131241cf7541b387040755f02f07ed1181b60556c01cac6d364327e55395a803633b8f10f9a83c33cd9c9b406d29450ffba45471674e6832d40e87bf663b001e42bffa30313bf81b757c00f759d6c17c9693b07487758ab02661a6dd3d8b45c28ce32e053f54760805c4fae65a42b0d24016516180e8dfb03b5e6d759c4d619ef2ea0ab72f208929fc33f9f1a7371b363f2e38fa2da586dd936b9934d19295b5a919e69d5ab3a1afaeb5d7d4122e40c16d1dd75e965070554566dc1c5ea5614579107351f92871b7c6a788610ab14b1977ead556338e9f77b1de6a51b5e70749d4c7d08630d32a3d3f4c850df17a80362cdb8bb377e5e35f43c3f7d4ee21cf79047f711f59a4597e4b767d0bc55ec2129ecd6a7cdc29486fd5fc8755c357e4b76f923ba42c06d0a152ece2e53dd55748625cd905c77c07a387be2edd72dd13205f9c6deb9b89ca7f4950d6a93ca35cee516b312812f54590a9a2c57d664bc611836b37ecebc556f292c434a6ce9e464fed0e47ec519660c3ea3668bdf7cee0b13e6608680d74b6557cac0c7a3a0191eae0c9a74b9d420e5b76cb4558f7169c9c2ab3d0a6d8dbcebb7db5f1dbd1c37b18736e34e402ac8931946ccac1c0b512057aa7f78615a69da0a94c0d128fa0d3d5a816643071a0be25bc49c9bdbfc6b013efbd9d1dab7812d9296964c4f1b25e47664ebb2267f6d571c3daeef0cae22f6b76617ce16ff98d21a11732871b09debdf9eb51c3dc2f4622c33f0cbbb9c73542f056da60261ec93a6cb50dbc55983d0166c6e4544b112546a1ba880b10c1a6a4a72d3046c7bc3119a58e311eddfd4f39e5edcfaa711e66cd57a68adb882aeebf6fd99323d8a26a68ceacc25dcbd66a2c251d11ee01e3e8f9c8f24b4d9f8ab0badff70e0fb0ed987a92fbe98079ff5806925cc9d01fe6603a546b74d64046b7696f8165e81e7a6f468b3c85c7fbb2c2244d2b17cd78ea2166e6608b787186b6bee6e060fab59022029e99ef324c0e670e97581e46459867cbb0fd8a9b7d6d42a1aa169623032aa328c66950325a8e1d36614f925a9ebb2957374fa88c0034f472462823999a906c492e3a9a0dc893ca71a672f701293b3ab56bbccc59138b7afcb384198d65759df955b9c7a37a72f874cdd8ae8a5ee445b8d540534119d2056ce09affae7a718929b47f45658a3c6e5a4c5e5b2d0d92ee234e4c697cd8dbbfd7911fc4564d5d7bb29a104fc98f9e9ce8f00191d9f9ad01ffd94654a119dd491a3c0d57406abf4b5fdd2b0622f9a01cb6b2e8ef44d35c2eed4ef0467b598f2c3eb1c24d850caacdbaaf5c259f7ac1bdbea39ca2547f01b6636703aad748e10921e3d7150d2eec055d853ed535fc8559033f77e5b1a36b2404f0f6879aa2c3f14ae92b0dfab77e41d508c967cf48ac5f07d987baf1e31736dc89a9eb7d68487e19ddf691e54bb16a90d95ec70e931696eef6d5f26db06f182acd202dba712d14eac1086b0d042ea7d045191a5ad673ee46bfc07d68dca6d65dd5011ac5f11a79d33c8e6524ea7c505721b95e735a8982e1361a547dcc17e65729a525084d5b0cdad222317cf73f4bb032f4c17aebaf2f6ea937add17914c61358f879cffa59e7857cbbeceb316de1d1e471802264e506d986efd8b3600d2b0ad9bc5d2d6ecee5a83c109bc2b0c0219abe8e233d8f027588919c23f0eb12f0480d894bf05e073bae1e4175083655192266954ce07290aef43cc4ae2ff632157c31ba89e41b3f35b2bcf8e9b19f245bd272437177fb5aef3ae60ef150d1506ee39bb935780e9bc0618c48caaba4750db486f32b0bc4ee9dc73440b8425c906ec7af0e6c49b87b9b6df17794e35e6c07d92b411e3b11da0e3cde70b713db010a962eb550e641e60c5b134615e23860257032e1f1944b7928b611a8d936eadf19110e372dfc807dba76d6795b283dc75f9985d769780e20027a83b0c6326e2916cbfc960b96cefea14e6f030635ead2e49a9b82bb7b59ac21240b4951935c1d82bb9dfa2fe5c1297f1a58060f5c7441e653f35cedb9418942590fc447e59f2bc929f48ef8bcd52b9dbd93ca1c1aa2be92fb69f7af7d040db596c20d6d756ca0b987fcb100d917b87ad673a071268ecb4adf1dbdd8e46a720e4ffb77e0693e98f2c346f12c02ba539bda657a4cbfc3d0f2cdee5e378aa0c41218f7bea0010fce7d5abd805182b754d128bff93d4f19e59a7fa8216acb8dfd0af7a8fcb5fbd414d3e6786393283035dc9d6ba21dfed1d43a5b147410b88e3867e07e356ad3ebede06ccf30cca144221af5392604e764c15dcd13f3ca3f63e7de798799d152b0bc51a63c58dca2a0b84a0546394bb9b6cda1871324868759153972d97a0d067c8268bdfa979db2588765b15ae707aa300919fdd31651e1bbab96bad6d5044ebb080865ee2b371aaea52772a5c0572e2864dfe06aef875ceaaaa0e6c3503aedc1ea979a984e7fe498c1ae7fb40a353e01ffb26cfd2bc3ea630533c73a07e35accc19bc97454f0d607daa339a349b69a4f39de25f8cd52cf4481128854a00569b1a4a471f424c40b2d682ff0cd0eada5d7e82cfff478d71cec3cc64838fdc6d1d1541986ee703bed9fa22b7c1d6a32c026640549e08a293f2e084c88f3b7116e16a10fe71017c35da886f77c6580443838a43401656627b204e9b10b438defae865138079285d1b68525d332983b731ba6d1c67c8a9b56014dca28cd0fffc487824938c14c82329df049cd57ca4b3499c9b24410faa6835bc018c6d39524c7bcaff6e8c4b61824e9da164beddf3ae16ec3a5d2806fa65e1ec198b60ead23eadb8bf20ad27cd85de64e2fb36047657576d0107582ba55e72e7e78d1d116c19fca3ed774fad18057fb9a19b525ba8708fb06ce41bb6c6274961a14ce128256d45a47b963af6e939e6e03015a9922de252a01b87a8d8cdc63550e59ffa0fccbbd86cbff3efa27779fcfba79b9c8cb81e6642167fc2a4e8618c5d0f2d3079b9c5cbfd63f3cfc606d26e15197ebb7d8541dd031cdb5c8921fcbe65883f880f47c121632da4eb1e9152fe171e83e491294eafd54974899272f136d5cdbb1dd8e9fcda96f0c618b68ea8f29a187d0bad2eca5ec9c005a862579c675794dfea5996c811a42f4c46f91533f7a2da4e2c861d9128fd18ddf925822ee988ef1ab1f57a526a2d76b4699771165d4606d5c6c308b68a2f2cd6b3f2452dedb91bfbe5d52bc1cbd1d17337b654e92a2d0617e64a31434dadd5bbc9b98e025541b44026dfdbf762cf04f7a7d0de63da7e5993a28247f167b50064b0a74ec0b75f8dfcdac2a725ce6c03c0f03afc77919f1025d7aa405d4d1df484e607da0bf73836d038c2b52fc11d03f27d89bc861664dfc5cc44173e23a0b287b9192400112f5f6b3cb4a11161a6d551d4ff2d30203576662072225c05906aa3ffc104f257e38647301beb73e5a9352a215327cdf05d1f360ad4cb79221bd4685b08fbbf30ab036fe1d86f35bee8352dfcacfe5a4780e877242ccb6e9e7d2de272918b744c333db0ef9ccf43ed9004a844797261a81520be095d4fc21bbf3b2a9b891b6e3cd257e14fe9a51e3c0390197526d313be2d378f4798f90e54f9976c3a02328a8a91ffd117f7703b199f36e8a09c439828a7b9f907e3fc6b2a5fc5ffc181ba5d496682e8d5f943a39da06391d9005b242e5f9d21abea3403eef1a070e65d52cfab183e9a892716a1ffcaef7f4b16664cb4b9feff868d81bd9ef01df854d78df7b25d7f4e4d84be7c3b87cfaeb328c822d7834bdf004f6a518be35afc971c21064625e81f6479b2f9d0112b11576d4dd60484a2e6cd8f3253f2982b880e6c0b0e53dfd3918af5bcb52ab19bc1bd8d5a7af87a7b7b67cec1ed4ea2ed754b4e78134bac3f3dbc16baf431cf96bd3ddd5d6b8ebbc1b8dc0319e93dd29ad099db9232b1c06e9371ad7d5ff8bdb013f576527cf3c463a309b7e3d43148d481d6bdb92df10cb75392d25b01c7f73509153c4f3180760089550c6256d83d212f5687aeadc08cd4b3840112643ef861256c93cce4dc30dfe922084525ff02483c4d7d3b640f48b32e6c3f5fce8c047c9941aa9af733b780d65eb232839169915882dae74a77cd921e5a36ff038dde0377f5f5816de169da66488d424e432ec95913246b58be0be83e1aee6b628cf598ddc131365553c3c1fd88870e8b7847089f4fc9bcf033c9c3489d0970fcb8d2bf1482ec561f9f4d7f1c5445c5762f2728a37569fa3287a7413c8fa0f8580d13a000f66d9d9a93b6a0996e0fe9edf5f02233ba75151ef398b0d7dc9f9e18018046240f96e584113b14998e793374c9b0540a4b0c4e8c10155f0d64efa06dd7623f304ec4088a14670e5512cab9a381aee2fd227b09e4c88260f6fcddf5bfce11f36f48b1e24577ebec5285b36761309a09ee06cc27ae11090c5b4b167d0fcf437863649e4e447e18d35ec395d3d9e34798889b29e4bb822601b1bfff305b38f96eeac552b5189b11b8b3ebe11c45a9a662fb6a5b8e7e14c38154cd145a87685db3ee16fe6b9c178b45352cdc8b71b9c7911fffe7fc438b4866371fec50c23e94b5324637eead73c428023f3da286178d8c8bebd9d3456f55e1637f73a96fe8991e038c1280ba37ede087095ead9d01d2c4e5272cbc16c0a9856c9adda906b7ca6e3fc6ee074c5cac09c85883fcc1c7cbcedd14dec8e2dc97e381373e76a93f93097c4381b168eb2f62a2a2fa25b0398fc2ef0334f15d4e858277bb0b976d0823980f77f131a5fc2995d1931fc134783b0e66aeb0ab9b772c7816807d3401e0f21ee89aaf331877b202ef38634ef66ca3a776458a4db0fdfdd3e7c5660c1e5c21d3fc7354d25cfe0e5756c159e77159c437558ea3330eb90f9a0077bb41d7446e530e40f2af9aa43ed62f83594a3ea53615fab5949a83c69eaece76b8d79c13cc950bfc5e7bcf989a003c72a840ac2329ac26f2e8d0bc95570dbb7ad210ca5f16c4c97767a147b433f634c131541b1a4a2c1b36aaa47caf7d083a4f5ccebdda96d2c3ab9a910e150dd60325d0d03ec9b222211fd17e604215eee7e6e05b3d56560ec3de9170740ea3b7d80cb423e82445071e398e788b311ea99e4af7dbb3c3dede98c390f9522beb02f621275fbcb38bde2b68282724ee6d62e869938be5f6e69a42367618e95d30a889b5045789827bf83a5db7b65209986b43b53c08505c661e6c8a99c71b9d8874b735d1937612ab4b42bfd9e1f58043d820890df3916bea66493d0d7e836f0691f964f87f217e172bf65bd0966a62bf525bf5d3fb9e0fce16e2fe518d24dfece0af6f638afdb9f4c0def1a740a4cfcf04caef3ad09a7354949b1e7e3d5d24516c0a4c93b4ff4ccd4e832e661b146cf062f98d27cbeaf461f7df4086564373b006807e12c28abece327093ecaf08e6419557b0f6aff6eab938ff53c301ec5dbf4a9e11d431967a99ebdb13521d5596c8a185deb718df1792913a1fcd846732e6834a08c7c18bff1f729502973ae443d0eaaaaf8a3d9521e131210b3d89184298038d4fc23f0098e896baf4e8fd6693de8de7e3719b197fb31441a854da1202895f5d033889b7b89365fb284418da4f1c3dafb19ad2cb887b5a10fbd91245044f09a0cd4cea7fe32609e72d36f6cbe6d6cfb18c6972587e830d4513","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"ab2beec4f19cdcf7b5c909265e03bcab"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
