<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"a6cfa28c8d3509f070d60b40a2c9812fb89c497e08a12a6b8b16295187cc5819fb4a04e98c1d9ec93a28ebd9e1b0bc95361ee1a91dd436729832f0ec8749da829107d3e2ee6c32399b13045bae83c9ed7f3cd16db7fd37b49f9329b114a40495c1f40581702376cc54b9a5f6210e5ba5c29de2f3a10519ac44c71efc5761393c6cfa0ea1899946d1102a4a8268f40b8cd228ee07c4b1a6c60b4f67c93d0bfc6aa86d1ef49ab6ca1a05f7970957f95039945649725e0d7129cca28440d622525581fa60f716865831e70ff5b3ec9bbb1aacfda1d552cb78b052f25c40ab1de6d703e2ec1237ffdb2ac595d95a4d94b7da6cf1d4c29f739f102245e2c8838c2679d9f1f4952b13fd5bf58c12c31c60ff230e378aac2fb48ff3af3c563ec0c0226d9f7340aa918585cec25f2651fdd72ec98e10a149dfaac1b96c1cae3fb8a15cdb39d5fce9f4da3a0ef127a47427bbdf77e530ca59599da9f45698039133ff83284976771664ebe70657e2ce151583171c200006e7d3c6ac5e956c9a6673f528e2195c2e60215c10da0a6fd8c6d9e668d4167d31ffc549d08fe33100c97fa64819f7f2a78d32b127e98c137a8a8b44ddb05d36d58b2724e9754e5d6bf7029b111991bfdb617c93b3e181a00359f14c86e0f6e0734baf8f2a76c763b3afb7d4275004ebf6442bbfe5392a53406c3e18267ce3f2a4253beac1d39c04ef300d6da5ebb4b20170524e8c1f142a8bfd43a96408f440bdc68e0e3a50a7abf55dd5973947a39421110831b51d5e4dd79a4b6ddb4c633e6321bbcbb345d9d4801efc46ac6760c3f0eb616bb0957b02bf5bc07a04d7191d04aaf6f03c39758ac8ec1998940000e0d95f1557be552dcbfd5fa20446967e3c0dec945f1f0d5d0773638a382b6ee919ae3c632a20a23035bb86f7aeaaa4419122ae0bb80a0d5b4935009380d1d43073f03c3b4580b95ab1f5d46b00c67266938268a36d5911165c0e1f6cf127ccf609296a30be6fe7409cc3d915a5c9017934c48f7da50a4e2813429ff94ef8d83b3e6e2b33991839653b1023404a3c7364dae2261de53805daed2ca1efcfc3f01991f9295cfbb90a1f53a4233778af6c02f34d8bee3bb97076ad8b013d39406a6ba3a48ea092222ff40b40255ed255dd1110377f740477ef2acd753eaf1de8d2cec839749b430320cce2a5582b534c46d0ccfeb3b5eb4f553d24a7e847eedd316b5f8cdf35cc3d00f2adada1a27257a1576d6b29b7ce9292ac61bdbb195cfece6376dd43904165a353ed3c11786a41558c6b1cb518c451a3edfc179344502c8077ef3e4f79d64b85678c1bea4d366500d87034cbb30b674ec22256f212555d51090d1bfc74f25fe9c0ba9807fd5b34715a427bb6bb8713d1bca40762327231ced689898df378c7501a5b0a86964f28405d299aa7597cf45fc3c6ae94630ceae660050f9801524b54a7c7d52d35500b46009796c362cacbdc77a0bf9fdee08ee21a9bfd36d6c045006e3f54eeb76e43a0ade6dfc57f971b74ed39393a2c63b101b0f60ca18069ed64a7d306be53aca48d96a105a9554d790e655a5c497ec00c74dedfc03ddc33d6bd60651b74f5f3bef585a2d04e7f17d043f8804206c6921ca4611c755c3a04e4f1a17b2b9c82877fa914be8b02cf252bc57ddf58cbadd9f405f0cca2e0f09d642542f53c85c262121cb477dcd3668eb69bb20cda9a9f4970795bdb6b51d6e39dffa66c0ab0dde0bc03c1c604e519488b49c50c6cceb6858ddccde9a2b628a105025d9842c3dd0b9f89d4216c2a695e3a50b439e129031f35674d83fc49d2d6d6cfa5896817083678672367b8afd20ed4db894c2b003e95d753c876d55b2e08c7bdd6ec06bc0c3e95c6c4786a06265a3afe73edc9dea6bf6d93fdd57978d54fc2da38779210f9a3839e80464c29249e9f9dcf66e4e2f63387f4b4a0b87fd45a8b22f97a562c1683d8abfc45606855c677b057988a17bc032908e8f049568680e18ad718b43d474414b9eeb8ad71ae2d2a3e1e542bcfc0a31cc5dde42f296060a631c6beae93888e164277e5f77e43ab2a989e753994a30263547636fe2e1c10a8bde3862c6dbe95c7fd0550f2256b8251bf0b678ede8d2467b8bca8bb11a9c38b33765e26471381b2bf03340760aae96f4d3da47918ca6a4dc9cbb9a73de42ccd3dd283c1ddd881f542e8485b945794f81ec29bed8a3897636eb544f012175d27c5e42947131d53ef8dcc04204c16442967f1f54a89e199939a419ec640f23ffd26a9ba3a093283f6035c443329bed4319d796b6652b8e32663554c19d4c1b82cbe306095063903942229a5ae254a2b91cf6cd23f56ee8cec7228bfe0adf4ebff2c6bdd2a255c9dfa518173b4257aaf64fbc82a91c1c03e3452128cbe4f56f28740b326f755834b3be6e079b7fb975fc96916dedefbfcd448fabd3429872734a225b424fea5f0453fcc9a7101978b733dd7efd77c5e29b78c974d1b0c8d5cb070ddbc68fcc20db53fca54172716459c9b726cba9317490b7ce57abd24734636d73c236fedf6926697f6c53a42ee419f26d798c7c5bfa4949086a91b14a1e37a9be2fbe7ed544925005d4b6fdb8c08411fcead312150563b7d1b3165cfed700b8c27ca4d64640dcb2d58736f0a61c3c87570a40389fd7f659797ec5b422da1681bb162f968c14994fb1f71987f9ddffb7992d8ebbea16982cc992558b5ca3ad626da110481c832e03116009b25149019acbdfccb8340d8230ea52d054d17d8cf0b8a65d9f31cf68d636dd824658b6e26ed2dced1a57ef7ed1eb7408d3f3d618bf763539f519d50e8e53fc5a041ff5695568964a54f8305f6687f1696c8b297f8c2f8ea7bcf1f377d554b6f1435cb2a7f0bf94a12c23cfdfa1523d24c8a8fca60ff21a25c9e8ac5613a962db42ec88743e207ca4dffe0a7ed0d4928ec22dce8b43a793d757966af5e05e22dbb677d9eccc44fd610930d2eff6cda8f873eae28c47c4aafb81e6ea45b811b9a3f0eee8cf4b9a83d9d119e62d384423ade2a5a7edb613743d0a7392a524e3eaa1f51b4871307e521906caa80ab063fc7404c189a064d9a95c3b5b62c08c734ec9dda3ac7c6a940dd42e21213e551dbee7f38c6df86d161fd74aacb00e1bf6492d6bff37798ba19bbbc37c76f5207c3badea09cecdd19a5b782aba3934a3e72538b30a5580580097f5a3e32584e09391d3b1cb82520d28e837c7f454a3dbbdc75ea6fdbafea966e611849f48c5c890a154f598c03f632944cb8af6fb21a8e8281dc54d51eae3066122b67e066d5ab9ec6115dd6b0ce87382919a74492a8bb97926e44e2a778f312187d2f6a3bae3bad33ef0ad43595b4bfa772d97fdfb3539592aad270ef4b1752bee75ec5addc0a3fa91d80e5c9a8112984a98a130d677f65f03d48b3a52346d2575188d7295d04b153e329954dbd55813f74f89f123adc5815474e2399df52429b31c52eadfccdbf1e7fc82437acc88f57db21dccf62fdc0b9378b32142fb672bceb833f5d6f607ef3b937473a14daf98bea72d7701b83e80c07fc01f43bc9849bda391ac18677961db36ee7a25088d487630a41234d98b01381abd731606869acbf5e5a6fe492d3b4c3e53ba24e0a394a1a62c1fb23607b61b81f20288ff34b66d1038e94aed6828e58ad1715ec460bcbfd0670db517f7cf1389a558869e1b97a72ffc45d86a51f6293b95922ff4f2e9eaf3b8f03e2ac8e8e0f21ce964095365fbde63754734fd08dcac8375c7f9b64c2f61028a93c1a65721c2ce1150fa5d4d182b38041e1a3ad32e5e2b5713d66ee317799cb0045fc50a110d4e3838944de784abf95f4b1418d980e8962859c091703d08c48c984abe9109aeecc188277e4d4e20ecbf176b064255bcb595713788f46c9e70073cb6e4075f4ccb82b30274169d9c56c18b62fcccc08d3ffdb89214b42215c19f1b7e43bd2eba6cb732361a9cb824bca2b8f74d2013391907090261cdba12ffb36fba516de5a7296410d2fe382cfa7cb71ce2013927b20437b2aa1945f21aca32427b7b3a833cefb3c538a05c9a765f9848731ab06b5ca02d299bbca021c6a303e38727c2857aa698445f5d2e4287d3b683339b25fcbad31384b8785fe6a0b3d5ebb8dfad71abcf8a535107578ad66228d0c38bf67e2181a2483a540f795cda9c0fdc4f2b7bba370328467fc94260448f3c4c4f93fc13f017aaf8d7fc0fa1cebb753d19ceacae74a43824d9fdb7872111a623ff49d60ecbfdbc76a0621fe40e220409efb0fb89f060feeb2b3d0feacf4dddd0d3af219a4bcafdaeac60266ff843050b210720440b6d53df20febb0542e28afd61b53faaa2b74d454aa36ce1dd1f3cbc4c650e0b2c6938435da8c76647d1ffb19a9053b9967bb2e78e19baab693f4a4badd4aab1185ce81a54787cdcfe9fac6cdb1b8e5dd06d05d2e1a0915e2c8c985f4d3c9e4641ff772b97b5d00124bfa545bb991bdca625b2c326a17887aa840c8280a03ed832badf52e5ad0cacbb03c1ffb497db7b10db5e1997778ee78f289fa9fb8a2d1b96008fa45073ce59cd154b68dc53c4a84ec4724cb3b55ee28db246deb7e26f4f7cc64a34c75b18590244c1bce4f497fa81d2cb61cb2a1968ad662479baf1a8af90e468d304907ecf6a93610f74393f4ed765a53bccb137373684a13bec1c461424f21002ae984491a93817cb442d34b1a5f21403a7506afb5d22dbf7a1dc704b6be1db47694215f8c6b7a573faa0c7eca91f87ee05896b793ed1c50a4526c8bfcbabb8e21cebfbca5de1418dc8ca99342340734b5ad3bf204713567a1eeb0adc91a66e7dce2756b731e77dfe45346ec9f23b70691d8580edef51427c79d01891dd32cffb7d04fc2e1ce6372301888c4f6db85639bf4b34ebf5b5d3dfe9922e87b8dddb6d82ff4ace68c9f5236996fc161b633989f56056b90c096dafa26ffd6b6fa833b38c699574599e0731dd5ea8f30502bc8bffcb1957f4eecc5b76841c8acdc9991959eeea43604a37aa3df089e3ecae9a98622a534c730bc2d94c98d59a8d48874ccc7044a19f77a945e155a75ed0d5741b62940a59f6ead8192f419c4bcf536c8f27b5003a4e7f99e35a7cb69204a9d4b73a29ae08261d78fcbf63a63732b61c0fd15c707a62c840837a52d085e7c875feb85a0248cff2ad7e09fa7d02859d01e5e571ce53fc186db06ff891cf2b2aa697a84967b759df8c3d090b2d867fcef99de584b3bf552e63630eb705cb7e451724e46de622878aff638735d33a4d3571be6d89e76e28600cc5e374b0642d7a8aad639d7f4dd6449905e35931bb7f1cf4dd231f516e88ba72a55625ad5b63ee3ce155eb1b942242363984f63b7b6203f92d67e52c57b7f4ae3923b3031c7359d6b309db4d8d3d764a84430edafd37f9f5c17d495609e9c2f2874781d878a824bf05c95ea6219f1831336c8c683dcbe6f32bd6a51d1b9d1148f479a07bfc8821687a6e283c85091005f0c165ca4c4bbe196a1e8b10bd6fafdd68253dd7d74f434fa1b1f13ff95485dbb2776859635934b941b79b5512f6639069eace49a7ac6d96fad01cdd79b398820ada064c92af8216cdd3fb31288cdad36b2112100445490450ff6d1fdea8311023515391cb19fc0d0338772953f1fcbbf0b2e7c32d7897fd593edf8461025d8a1bbe445055e4ebcc0655ea9e1d7d184ab2d3de1d0b8a2584c3171903f59d49035c0f480e51c9c0a02ec94a210bb12c79715732d242a0ac3df17a815dadade151f73b884a672600390d3e7256fdd32b064f8c23f63f322e38756f449897931dad812b3148c4311949b29ffae647778f0541db51bda516dd6aa504d5ed3437b819bca498febed4048173baac15ad67f0a1be971ba12136a6dd68c8c712441df1975d3318dc7ff737cabda0649821189e9514cca3dec662f411bc7d530646424bf98ff5ac6de65522f1c368573520ef6ef3e89211bf1321b19e8fd409429ed0123d03ff76edcc80005823777e3432a1602ddce9a6606706ff9f72ad2ad02f7bdcfc140b43faf91ffdf82e16b9241ae7e5dadbe4304afe5b5e918b32de2a015f62c331b2d8f8db3d78ff3a64a5c62bcf441b10d868f8b322947ff807334223f2c924f045dbed122e88dd8a3a93147bdf5a6479f4c346e5491b638902f48a23ad304911857f76aad78aa8b7466a63dd65f7694aa0b20db5309a9682eb654160e0be3bc414aa7272c1504ee3e42fabbd4d27e6da2e7ba8f56ca83e19f48ef704d32cac8cd73018d14008bda15a1eabebf1bb29f099279d7d25e1d80ac9bb10a11725958464fd5d7f545e4cc76ccab29187eaef31d14952f8ac85a88d9c6d1695b802e6a3e75002ae7ad46753b070749fb831b6eb483924d0c3bf7ae14734ac7986ed30a26687cbdf85240381cc14f880be514ae417a00545bb6ec28b4832fcdf0295b4c9850092b745036d8b1e358bd6cd5cb3bef7e43bdb770909e5df4ac29bc75f7b15c12c6525a4afd34b544e549f4fb671509a420f023a41597e4526bc614d26e04ce0b85ec08c014d43162c483e0f7a1eb1be15cdddd6a14c94d3f841ef9b88b24e044dd054c40b64e4e17daf960992cc2007594bbd90381c2f01b1cac43d3fd156a9dfdfb75b878128417639bea8e77a8eecf2c1065f162dc1d5af41e65c503746db09f1b224e1cf9f6f6ed91a503e33884cb6a92fa83dc7ba131de52db1b0b816d4b623d81a1df7802cc6502b32e337851aed0cda24819732bb52644ca8e042f34808aa08f8676ca726a114c6952276b23fdf8cebd12bdd8c5775aa2c5163bf883b8660d0589889afc4e2758d6b85ae93eceaee1bf4009740f466986852f24520e5babb074af2b8e8c26de201151ae7259f0c2e91b385c0f2e0f7e7d2ad109f2e14f8099f43b33d3187402d41ec7d460fd90abceab4fd3f2cc04f3fa84afb84894107f2b77c8996bfcfa3a934298498a9ab80ec3527539e3ca31d6376904cbab3584fa70a69d3d844e05974479d2ebc6aab35c571a481dc7fa5160f5c8c0afc1f0976d35c600c4f484fed89347c2c27ef6acf7bbfed54af3344a5b383d9f671a1a104cbb6cefec501f2fd72c396e9733ab043fb6d27ef6d45cd8898c0c80f2c16d3496b6a64a3294098c83680e0d7ff2f7918dd7a9844d7a9783fec666bb7b9ced9366fc51d96239759cf22e111755c055db7644c56f637af7010588a6576c0ceac0974f39e8f490867612a18a37c365834ee678e58dedc32e6d5ae6a25fb4423e6a411a9d9ed30323f43249589927815f4f5ce17b4802b37822449b8a52c3304815dc54be0af5f20b592e147b1f374210846185fc6b05eb6c712f09aa6203a243b6d610e84a7f4b58a52fa77e0c5a7450d21a083f9427be6ccab228f178977e68b77ed1e8b5aa7a166fa399cf1a453a7cc0a6681fbd608cc723192c41dc86e79a48f4631f901c876346401c99731a3f4b3b8d205e1b1fd55f58b10e1a16e613ddd5eebe55483098990b20e5e40efe262b6b28a5ca1e0e38acfc1706ff1639525b10648ad720f7ba9f8a2f23f270065085348478addb3a694613726f7e3085f29544013fb83466b9e4eaf80c7b5390a25cee7fc99bef7cdaf5bb38c381b35c893559235dd3b2de8b1de9980b52b718a1cdbc44e68d83d4f7357188603ec7ec807e1d72b03f57efc0664c9170e2c8927d561952891bc07864a5d19cd2f3a0d48c34fd1b1b42d217f9a9538eda1b125e4c677c1bd57f8264eecd04ae74d316b3def577e1de6df1d96d3ffa3595d62729ceeb879d77c7607adc649205e3e7115215d02d949f72ce5099fe126b697b837e80636b2177e483f54794d8c151d0cf3d188e54f9b4c0b69028471b10a007890a9b18e17fcc80ad8028d67234009b3284f4d871af96f98fb3b59866d8fc43b50659db6e9667366cbe6f334f1806d8d0ef4d43c8d2720221a58c26b8b8bf6353ef9b8775976760942e202bae2a3d10889a99ccce7f0249cfd3417451f6bcc0f57265afa2d6c38a711d459a16fb126440da7e153ffd56834ee3ac43de0056ddf6b7414e2807164258c5a47633cf1b0c05c3d47cf778157b6aaf2a0c0d5c065536e6ccee2c747881a6bd1557b61d3233229463f62199fa31fea186abcbb3c53150123287f5f11cf315125330adc69f3f51c752c46444079c44df1afc7297e3b55e9d7550e010492c88f0bfee322c21998c25e5576ed787f9e4fc8b1a8294ca54325b086b60eb7b82838b2c2ccb0a00d4f34e4645372c885000c904b6b102d6d0bad829792b5f95f12e5ddba49d774f5c821130b4c8657eb25b17c9620d3689dc464aebe1d2246c3604240c52220a5a5caca45e945bf81cdb7128ae6f7930542c576fa17f5ae9ddd11c29d42f711ad6ee79cdf632f96c5051c519019212af0e407b1785cd0c78fb1ce227860d6623e709c0c2422fd1ebd1824cbe136004bbcda8cd98c9f15f5f7c43c6cb62a37db4e016a4d51bb377a20f9ee75bca07ffcd3274335314e870707377eb2b65ecb2e09458771e646e161bf82f773ac59c12129fbe1c5b543843f7ef1c3263ac6e20cfe43ac5d15caf6a516f1a04ca3b08b02dc62cc1d6e906f5703a66142e8b140c25ef92bd14f5972dd9d81059fcd590590961c1006903df5102bd4674e2da0748493db4ca25bf506f766fe8d76b5d098c40dae50458418ca60e6137d2a6d1238d494707591aea31d7fda6ba3b9b68b68548b9a1198e5d11a074a54ca20afd6b1e0e475626d21f23c1d067b9656a9318e560b770868906fea8e906dd2450faf99489f65a248df30175a2750bc5e9adcc56185c42d4892cc8edef0b3b7135d201bacacdf96d740a0d04552791cea836d80154a2daed8be113ca1f05aea65d99054fbdce066caa05bbdc4e90e52aee37925e9e18706ed427256c927221af8904045a16a7a2d3f9d7f82fb1e08818586d0608780048a3f0e610c4abfd276fcf31e09df98873bcce49501c8f91dc3cf87d39537c75dea260215f15e3d1601654103d7b52c75df19dbfac4e72978a3a6c1815e12f5b8dae6f3149a783488f468e9aca40596bec8b87dc28411dc15410d3c2db0a253aad035e5ad214a6e02747a3cbf1051271493cc3198f16b62640413bb45a91884aa4720f9cf82426c63715a3fc3f4ac66ca07a86a31e1e41faf760e0f2ea711ce7b5544cf2949235de8f9ac05805a8f88edd641cf4f76529bce09c49e1640c11f84c44e69ae9b732c394dbd01356eb1fe589e31a8235889fc3c5c44f689baedfc3cd8f4b334e5d6a395b330056a97d271fd9f4fd2b49f7a416e3b0a465d246925c73723bfe4f1de9a41247fd73b60bdce2771f512d043393078ac429eb2978168c76fed6bfee28144ae6b23571e6a06cd49830650ae61d144a14bd2fc50fa77b9f8bd82d25225542747b8591ddbb6d705b319a0699c79ae8184f119cd0f217e89495021970825ca98e12a58b343395e41b781971360a9cd264e98a1c50eb504e02ef071ee789544ce88c7a0b3f29e600a5bdc6c109bd7f9436605eba3814e810ea95283c3cefb5112479030c551f900f0b28c47d50bf397a8c8c02cf3d808ce83bc4b55348ef0bc26eb66eede391cb7073676b1b02a9aae81a5e9830cfe6031ff2f03ee793cfba7a6307307bec50deaa28b94548c9a6ad248b9a640ad76187980bbcf327853b3316275e78772964f8b3b465eaa0cb90b083fc2cc16c7dc8f2f1ff6595aa7f76784e8f898f3340d2680bcb308b028a329e7ed5c6739974867525be27787df9c77bc3fe6f420ac3516a54a57069f9e1560958900b3297327db400110f2f288e7d6ad4033c6b9e2e16eedf608e178c36f969f2fb1139777d9e2868ab50e46086ad03992a318442be68aa307ff07493ffeca06da7ba72eb4110273bfe55419b172e7862e63173fbacd835719c4b4eff692c92c1777bb6569e22dd21b6876f769cbc02ab3ee5e98c6773bcd63ed4a8dabe1300346eee6b44c8e3e81d6b03210ea89c95e72ed20ee8724c5056dca9c34b60881d99cd55e5e6f2a033558d27fd5a29048ee0bff28beb5955eb07911dbcf68919b8d0c32264dfb15434517fd117bb5908d4b9a5c64bf280fce2b2fb337781d00d26c2fd78e60d892905c668727b3b68a876f44c07937cdfda3b25f05a352e0101aa42d6bcb0e608505c2c01fad4e2b9e0ee77c87bb3c661c1f6300de4eb0e8b5ba5759afbcd0ae828385f452ad74665099e5f3ca65187541ad19e6937a76af6d3da997e777414de94d14def19853f4b4a9d58264aa5181cefe4a9365870716b6a0f2435ef804a965a2e1f5ad9401fafe80f068a1b4b1286e1dd36150636dc7d396e7d142b0aa2b4ef9f91f80de2b80950ddea40ed50a3b40895aa64e44c60713e9c5b934f26404732e4f9f4eb719ac412eacdaaf731238d93ba54d70e9d98acdbaa7f1a94c793f28c5e4f37d42913556263d3c4f39149a8c1c9280c548c97dde63dbe547fbb14533482c40a985cac4278cde05d56ca602111c133afa31fb33f404fbc707acce58ba307c2edfdcc63eadd548379a0f358a9c10d999540682f8b329c29182bfda04181e50f566c425f8407d403e5f2566ebd943df7d3f9d0b86b44a471b6d0975a065b4230ebc87229fe956bf5fac3de31fcfa7ed956e645767ce75d508c6eb95bb992f55b494d4a450f0676f6b34f90c4bf6bd837e2b9ed265b8da6e984927ec44112e3997170ed7f884364d02f8cdf05a29b4ce5dcc4a9d5a9f770ddf43ce9135ee1cb317a37a9509fa612df8c62f081422471c68000195e0adfa2d26b08c419a388b06aab33324e0a6986eb785ba63f64d7ea96633e4c124b8d73ee132876c7b55f1adfddd7155609ff75fa691c7a35cb5d0c053218337ea2557bf54f869e172c2e445bad210fbb42fecb928139008fc6f055747710d9b48dd128e244da7408e764d685ae9bf31a32e1b586d873ff0e5a2bcb0cb163c1d611857dfb494af41444f05e8e07c083d2e229ca68f655c981a0296989f2107b7a62c284083e08c67fc24108f0e8b07a60670cc58a41b2c0dcac12fa6c68df34bec3e3cef9b21030852a6d5d07eeea8869a9212ff63aacb0a528cff3c9459d68b70f9f44f4fdc09242adb79cbefd8a61816617aa5a4858aaab09da2cb652b1b32f6ee055be0f9d1b2391b9651359ec34e4836f1cc5e05cae56b6001c71d706e1a74d4af78e1e0b80728b3a34280e982bc6ede53d65d38f20622b7a7eff3af315d597c16145d0f2441582c04870b70aebb606343d663a5513b909956529672b0124c3890187411cdb1dd4ae4d7144df5fbe1238a3e92c3e50681803605938632b83af28a73c3a2d075d6c19b37d867459a89d25cd929875e7b78acdd7b5a3b846a1128a9ba3dc2ea5bb941079a3d30cd849e4c76e967b72184c09349f0e880029b030446195b3ddb8f9041d88c30a375fa2e21a0646099962e22327d7d815f9251f047ba4137c8a43391482fabfe63eb8d8ea352419a02d9f33a557b9162cd966180536a9a80af4aa1b9fb2494a9d29dd9acd3d27b1d5266ee152ee063ac01434c812688adc6236029b7f3584dc8e980c256fc3c2fb26de023291a4506a9972abba39f66dbb16e363668ebe213cf5d0d4a3017f7c22f962b093c2b675bca438e0efcc317491624d2e9c9afc5af6d55649ab2926c29d6ef39f81f14ea49763a6acb1734ad35dfc1538e5569fc6eada14b538b656c84c982f9bd19f36c728548ea85231b7bbc0174d13fa91b7901723d72f718ad54c5e282c4456bee5875cfeb5548ed7f4e160c43e2cd4d0ba2739acbdffada0b311eeca8102867e67f191d28002d999212f53ec9f91304578d725a8b901ffed8a04a31eaf0cda2ff5a1a750a92160add7a1614dc9f6239738fa5c63b319f103b37a65797d83d1b325625c5598637928103052ed6671efd77b7c2f187673f93ccd6bae513db86c5a5ec3aa5b9781cf58c7b92b66e5e4a9040ddecbbb9f401cf217246a3938595edbeaf8d1e36ab6bd6f55a25986504adc2832d4e524e40b7b8f0902f198fe9129770957f25589839c25790f942b3e5a28609f5da9ab0db357997f4f9b6964728895730fd993811bb59b71e3d34ae66f59cba041a2e72db78a72d8cbeea8609b981a5ee230b2b11a12e9b861b695fc87eda755a75c975446dd0a56b8023da3e326c6820e2b9c309d623b5652aac002345974c978512474522d0ca20a1848e954cae97b8a8a785660a9adfa53f0fa2720ce25740abf2e6d89c975d4f5e4cd74494ca43421f2673601be09114980b2427fee11bfa14e434237b71eaa065566f1a5286facd86b6416e1d017e48beb01fb8d7f7273995081dc8405f2516bb431f9b802496e763d0f8a8a1aea6262a1aab2dc62d2e006ec791835daaffffb24a73d7e3c3abaae009a7d8595d6796f18a568af9bbcf63b440992815c4471ad71079c33f58088ab7e70b39532dad00397bf522f961786c81b2aa314bde60e2243e9b6d4f2822b54e6a42b11e20048a7a74ac3832401208d1e5f210e3bbe4acfabccabd570af3199502135465741b2c3f0f8ae2736374de116425e93855338d877f729cf789d9cd9d4fa5bed89ebd947296451b3d87c2fb0d046ae8809d56c1cdd20895979a45d19bfa5b7384f151a915b90e99f3a6caa6c746fba71cbf05c0063c29581a16df09a51e88686c244840efe5e8853357abca59917236b0abff7c3e8fa54bc6ce642e6f017f87be9a74418bbe4d29fa819c56fca38242641976e1e3bce0a84426436979a404f0202f728e51e3360b01372c248dbf675e5bb37292c73c572d29055a90be040705b74712490dca1422f036aabb8d1af5592c7bedafbe82be93820eead4b55d5b823d887b4cbbbc79e5fd7e99a2d1d710de04c0316e9ba9f820ad0232e8cbd4d8c27ef3e7d1a6b182f88e7cebf9f7251a909502c3977a1beffefc45e18dd46e2a0791dab586748f52c521657a0445ca7ea0f25e541cab7da6964cfaea9bcb7c308f292ab1aa766bb2f47bb0b2d248f723907b0e07c922b5d77b6cb15c55d206b15afbc75426e31b0b40fd534bd92684639f203d7d5878b5736be277a62cdd006b07524b1df0ffe7282e3597dadfafdd3ba4aabfbf281b6b2122952a278129f27588291bc50ed19102032fbf59b32d335a66d6999be6267d6d33c022f120569a2feb36789801e","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"ab2beec4f19cdcf7b5c909265e03bcab"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
